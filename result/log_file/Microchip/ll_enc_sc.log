------------------------------
test_layer:test_all_pkts
------------------------------
Advertiser Address:  9c:95:6e:40:0f:bb
config_file:  /home/yangting/Documents/Ble_Test/srcs/Config_File/Microchip/unpairing.ini
Master Address:  9e:9f:24:33:85:2f
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
['ll_base', 'sm_sc', 'll_enc_req_pkt', 'll_enc_rsp_pkt', 'll_start_enc_req_pkt', 'll_start_enc_rsp_pkt', 'll_pause_enc_req_pkt', 'll_pause_enc_rsp_pkt', 'att_read_req_pkt']
-----------------Pre Start-----------------
Master Address:  84:78:dd:ad:ef:18
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x47e6ead2
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
###[ BT4LE ]### 
  access_addr= 0x47e6ead2
  crc       = 0x521331
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_FEATURE_RSP
###[ LL_FEATURE_RSP ]### 
           feature_set= le_encryption+conn_par_req_proc+ext_reject_ind+slave_init_feat_exch+le_ping+le_data_len_ext+ll_privacy+ext_scan_filter+le_2m_phy+le_coded_phy+le_ext_adv+le_periodic_adv+ch_sel_alg+le_pwr_class+?+?+?+?

09fff901000e000000
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_FEATURE_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
###[ BT4LE ]### 
  access_addr= 0x47e6ead2
  crc       = 0x3a2c77
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_REQ
###[  LL_LENGTH_REQ ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

14fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x47e6ead2
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
###[ BT4LE ]### 
  access_addr= 0x47e6ead2
  crc       = 0xcb7cfc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 6
###[ BTLE_CTRL ]### 
        opcode    = LL_VERSION_IND
###[ LL_VERSION_IND ]### 
           version   = 5.2
           company   = 205
           subversion= 0xb804

0c0bcd00b804
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_VERSION_IND
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f6:33:3d:07:0c:16
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x3c86fea5
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x3c86fea5
  crc       = 0x885f9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 9
              max_key_size= 16
              initiator_key_distribution= 2
              responder_key_distribution= 2

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
c3b0a817918a59f428d13f333683eb117b1aca83dc91cbc2829554a994047f31
c75734660cd874bc64bb2950548c4552e39a6f33682badb02d77d3c6f8b73e4f
620b5e3977845661adc49aab307940cfd4fb799b57c3452f36e763b46171e492
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Public_Key
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
device_public_key_x c209972ad3970d14c4cbc45a183c46f73489a47f4cd0d54eacdd6ecb38fdf3a7
device_public_key_y ab9a0ba6e6262789b427c2e515186ad2d9c5fad325bfc85afd22244f9b057ad9
###[ BT4LE ]### 
  access_addr= 0x3c86fea5
  crc       = 0xa228d8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 69
###[ L2CAP header ]### 
        len       = 65
        cid       = 6
###[ SM header ]### 
           sm_command= 12
###[ Public Key ]### 
              key_x     = '\\xc2\t\\x97*ӗ\r\x14\\xc4\\xcb\\xc4Z\x18<F\\xf74\\x89\\xa4\x7fL\\xd0\\xd5N\\xac\\xddn\\xcb8\\xfd\\xf3\\xa7'
              key_y     = '\\xab\\x9a\x0b\\xa6\\xe6&\'\\x89\\xb4\'\\xc2\\xe5\x15\x18j\\xd2\\xd9\\xc5\\xfa\\xd3%\\xbf\\xc8Z\\xfd"$O\\x9b\x05z\\xd9'

###[ BT4LE ]### 
  access_addr= 0x3c86fea5
  crc       = 0x26bc3d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa9:\\xca:Wb\\\\x86Uhg}x\\xa9\\xdb\x13'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr|SM_Public_Key
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
mrnd 28863e10691a1a9c673763726585c2e2
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 46cc272c764cc9af774c3832b4ed0195
dhkey_check b05f2731095e51bcd1466b7a1fa145fa
calculate_DHKey
###[ BT4LE ]### 
  access_addr= 0x3c86fea5
  crc       = 0xaf3cd1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = "F\\xcc',vLɯwL82\\xb4\\xed\x01\\x95"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
###[ BT4LE ]### 
  access_addr= 0x3c86fea5
  crc       = 0x699e70
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 13
###[ DHKey Check ]### 
              dhkey_check= 'X\\xe3.\\x89+^\\x8b\\x82\x1d\\x90\\x9a\\xb2\\xfc*M\\xe0'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_DHKey_Check|SM_Hdr
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c2:4e:89:6e:2c:b6
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xc28b53a8
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
ltk 00000000000000000000000000000000
skd a476b2cd44e5e7db5815e3aae7838488
sk 590611a9eeca204d1594626aabe9378b
###[ BT4LE ]### 
  access_addr= 0xc28b53a8
  crc       = 0xf52cd7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x888483e7aae31558
           ivs       = 0x45c996a3

045815e3aae7838488a396c945
###[ BT4LE ]### 
  access_addr= 0xc28b53a8
  crc       = 0x172696
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x3
           error_code= 0x6

110306
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_ENC_RSP|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  7b:94:12:8f:0b:e8
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x1269ef5f
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_ENC_RSP
ltk 00000000000000000000000000000000
skd 0000000000000000614c33c8a2ee501b
sk ae56c6eed909ffe83300b45c612555e1
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
###[ BT4LE ]### 
  access_addr= 0x1269ef5f
  crc       = 0xa0a7a1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x4

0704
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  90:2a:6e:0c:af:4c
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xf4dd6415
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf4dd6415
  crc       = 0x208aa2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x5

###[ BT4LE ]### 
  access_addr= 0xf4dd6415
  crc       = 0x208aa2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x5

0705
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf4dd6415
  crc       = 0x6216a0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x76

###[ BT4LE ]### 
  access_addr= 0xf4dd6415
  crc       = 0x6216a0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x76

0776
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf4dd6415
  crc       = 0x5a2062
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa8

###[ BT4LE ]### 
  access_addr= 0xf4dd6415
  crc       = 0x5a2062
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa8

07a8
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf4dd6415
  crc       = 0x3295a3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7b

###[ BT4LE ]### 
  access_addr= 0xf4dd6415
  crc       = 0x3295a3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7b

077b
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  ce:bd:79:35:a2:42
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x73505662
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt d3
dec_pkt 06
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x73505662
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

###[ BT4LE ]### 
  access_addr= 0x73505662
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

06
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_RSP
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 7f72
dec_pkt 0776
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x73505662
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x76

###[ BT4LE ]### 
  access_addr= 0x73505662
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x76

0776
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt b654
dec_pkt 07a8
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x73505662
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa8

###[ BT4LE ]### 
  access_addr= 0x73505662
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa8

07a8
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 6764
dec_pkt 077b
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x73505662
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7b

###[ BT4LE ]### 
  access_addr= 0x73505662
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7b

077b
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f6:59:db:09:61:35
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xd9b4a82d
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  e6:32:c6:cc:38:9e
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x55354866
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  99:a2:3f:ae:41:13
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xc355095e
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|ATT_Hdr|ATT_Read_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Read_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Error_Response
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 0500040001
dec_pkt d078f60d01
MIC Wrong
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
----------------step int find_cex----------------
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  fd:57:7a:dc:3c:7a
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|ATT_Hdr|ATT_Read_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Read_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Error_Response
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 0500040001
dec_pkt d078f60d01
MIC Wrong
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0xc8d5e8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 9
              max_key_size= 16
              initiator_key_distribution= 2
              responder_key_distribution= 2

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
93eaa2e3bef2b6bce56f86d45ed9a753153a84ebf791de0e5f19f11019230664
6a2fc5099a399daa4d7d3b2e243607e7f96e934e9fa92080c568b25725fc6ad4
55181e03e24a1940e55a78b252360cd82dfc52091ab5e1373e70927c9a761d8b
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Public_Key
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
device_public_key_x e5f03002821c7b7c153a4da9661bea2301100336c239508298ff5e839ac5d704
device_public_key_y 7e100d22c3c8f297c92ab6951053a9c70440167d6fdec361dff27501f3c1161e
###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x696cad
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 69
###[ L2CAP header ]### 
        len       = 65
        cid       = 6
###[ SM header ]### 
           sm_command= 12
###[ Public Key ]### 
              key_x     = '\\xe5\\xf00\x02\\x82\x1c{|\x15:M\\xa9f\x1b\\xea#\x01\x10\x036\\xc29P\\x82\\x98\\xff^\\x83\\x9a\\xc5\\xd7\x04'
              key_y     = '~\x10\r"\\xc3\\xc8\\xf2\\x97\\xc9*\\xb6\\x95\x10S\\xa9\\xc7\x04@\x16}o\\xde\\xc3a\\xdf\\xf2u\x01\\xf3\\xc1\x16\x1e'

###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x1e4a5e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xed\\x9d\\xf8\\xad\\xc1\\xafL`\\xef\\x9d-\x1a\\xef\\xa8\x11\\xe3'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr|SM_Public_Key
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
mrnd 233f4e18d1d8b158338441e03989667d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 9d81ba2b6c4214d405ae6448ba7c72ef
dhkey_check 0eae6ebd64a064a26f66e8afefeb73b5
calculate_DHKey
###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0xe0faa5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x9d\\x81\\xba+lB\x14\\xd4\x05\\xaedH\\xba|r\\xef'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x225601
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 13
###[ DHKey Check ]### 
              dhkey_check= 'H\\xf66\\\\x82Aת\\xfdt\\xe0\\xc2_i.\x0f'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_DHKey_Check|SM_Hdr
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk ead6dda4506731f3e9c3d7d705766e4f
raw_pkt d3
dec_pkt 06
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

06
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk ead6dda4506731f3e9c3d7d705766e4f
raw_pkt 7f75
dec_pkt 0771
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

0771
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk ead6dda4506731f3e9c3d7d705766e4f
raw_pkt b6e3
dec_pkt 071f
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x1f

###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x1f

071f
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk ead6dda4506731f3e9c3d7d705766e4f
raw_pkt 67e5
dec_pkt 07fa
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xfa

###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xfa

07fa
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PING_RSP / Raw / LL_PING_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk ead6dda4506731f3e9c3d7d705766e4f
raw_pkt c55e
dec_pkt 0713
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x13

###[ BT4LE ]### 
  access_addr= 0xa290596c
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x13

0713
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  26:c0:16:df:b4:13
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|ATT_Hdr|ATT_Read_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Read_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Error_Response
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 0500040001
dec_pkt d078f60d01
MIC Wrong
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0xc8d5e8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 9
              max_key_size= 16
              initiator_key_distribution= 2
              responder_key_distribution= 2

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
0ea453d976fb9d17c1d2daff1fe7d174917a85e37e0a0d1b925519131528a184
b226d14e74fb0cec9358bb2275b59af6d0cd06da29f17303f346074ea3329bac
6b560054664de17a78ad3d4b8b2bd4522cca5b89e24cfa64611caa50850cc980
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Public_Key
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
device_public_key_x e7997f15c7f0a1d7fac56d3e23350e5befea45290984c7914965dd03cc99abd9
device_public_key_y 819872e9252bc1dd2309ddb036faf327b76f7ffa1ef352673ab74365ba78d41f
###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0x7c3122
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 69
###[ L2CAP header ]### 
        len       = 65
        cid       = 6
###[ SM header ]### 
           sm_command= 12
###[ Public Key ]### 
              key_x     = '\\xe7\\x99\x7f\x15\\xc7\\xf0\\xa1\\xd7\\xfa\\xc5m>#5\x0e[\\xef\\xeaE)\t\\x84ǑIe\\xdd\x03̙\\xab\\xd9'
              key_y     = "\\x81\\x98r\\xe9%+\\xc1\\xdd#\tݰ6\\xfa\\xf3'\\xb7o\x7f\\xfa\x1e\\xf3Rg:\\xb7Ce\\xbax\\xd4\x1f"

###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0xea3fdf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa0\\xffg\\xc50\\xa6\\xf2\\xdb\\xdf!\\x93\x02L\\xf1\\xff\x1c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr|SM_Public_Key
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
mrnd e3e95d865f3527c85e147a34123e466e
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd b141a659044fbbc9df91f8c5c89bec69
dhkey_check b20d52d31024f6abf6aec65c637160ac
calculate_DHKey
###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0xc7ee7a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xb1A\\xa6Y\x04O\\xbb\\xc9ߑ\\xf8\\xc5ț\\xeci'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0x6a0a10
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 13
###[ DHKey Check ]### 
              dhkey_check= '\\xedr\\x97\\xd2\\xc5\x0b\\xc0\\x85\\xe3\\x98\\xd8`M\x04\x16\x11'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_DHKey_Check|SM_Hdr
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 25a919aeda7080cb5c73a52e7c2114d7
raw_pkt d3
dec_pkt 06
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

06
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 25a919aeda7080cb5c73a52e7c2114d7
raw_pkt 7f75
dec_pkt 0771
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

0771
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 25a919aeda7080cb5c73a52e7c2114d7
raw_pkt b6e9
dec_pkt 0715
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x15

###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x15

0715
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 25a919aeda7080cb5c73a52e7c2114d7
raw_pkt 620c
dec_pkt 0213
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_TERMINATE_IND
###[ LL_TERMINATE_IND ]### 
           code      = 0x13

###[ BT4LE ]### 
  access_addr= 0x36fb6627
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_TERMINATE_IND
###[ LL_TERMINATE_IND ]### 
           code      = 0x13

0213
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_20 / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  7c:2d:0e:b1:e7:ca
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|ATT_Hdr|ATT_Read_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Read_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Error_Response
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 0500040001
dec_pkt d078f60d01
MIC Wrong
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0x885f9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 9
              max_key_size= 16
              initiator_key_distribution= 2
              responder_key_distribution= 2

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
8f7355254bfe3f3bc547f32cfbea55e0e4dd1f637655339dda17363feda137eb
317a85a2194e6222429182226f35ae9692a1b4a451a96ee026c18b08a552cb57
d3c4fb830fb2d804e9ac75fd6574294a26982f8ea182eb3b6929694491594466
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Public_Key
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
device_public_key_x 2c3f870ac2f51d09005ba4bdf5a600675c032c464d855dc5d6908e9ee9fcf025
device_public_key_y 04b7b19753d153ce170059439d301809aa6aa80be85bcd6025797ea5ab367d17
###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0x7b3477
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 69
###[ L2CAP header ]### 
        len       = 65
        cid       = 6
###[ SM header ]### 
           sm_command= 12
###[ Public Key ]### 
              key_x     = ',?\\x87\n\\xc2\\xf5\x1d\t\x00[\\xa4\\xbd\\xf5\\xa6\x00g\\\x03,FM\\x85]\\xc5\u0590\\x8e\\x9e\\xe9\\xfc\\xf0%'
              key_y     = '\x04\\xb7\\xb1\\x97S\\xd1S\\xce\x17\x00YC\\x9d0\x18\t\\xaaj\\xa8\x0b\\xe8[\\xcd`%y~\\xa5\\xab6}\x17'

###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0xb7d79b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'v8\\xf811\\xcfP\\x94\\xa7\\xed\x19\x07j@;d'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr|SM_Public_Key
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
mrnd 1a0b249063c44d17a03e373819c410e7
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 59d6af11b168d2ad96fe564f6ff35ecb
dhkey_check fe74a2f114ce39ff312de9eb979b9078
calculate_DHKey
###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0x4ac074
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Y֯\x11\\xb1hҭ\\x96\\xfeVOo\\xf3^\\xcb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0x667225
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 13
###[ DHKey Check ]### 
              dhkey_check= 'EN\\xea\x1c\\xe6\\xca\x1dT\\x96\\xb7\\xcfy\\xbf;v\\xeb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_DHKey_Check|SM_Hdr
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 79241783c2c7d2f4d5c903a1217f00ac
raw_pkt d3
dec_pkt 06
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

06
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 79241783c2c7d2f4d5c903a1217f00ac
raw_pkt 7f75
dec_pkt 0771
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

0771
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 79241783c2c7d2f4d5c903a1217f00ac
raw_pkt b6e9
dec_pkt 0715
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x15

###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x15

0715
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 79241783c2c7d2f4d5c903a1217f00ac
raw_pkt 620c
dec_pkt 0213
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_TERMINATE_IND
###[ LL_TERMINATE_IND ]### 
           code      = 0x13

###[ BT4LE ]### 
  access_addr= 0xcefefa8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_TERMINATE_IND
###[ LL_TERMINATE_IND ]### 
           code      = 0x13

0213
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
Counterexample found:  ('att_read_req_pkt', 'sm_sc', 'll_pause_enc_req_pkt', 'll_pause_enc_req_pkt', 'll_start_enc_rsp_pkt', 'll_start_enc_req_pkt', 'sm_sc', 'll_base')
-----------------Pre Start-----------------
Master Address:  29:0d:e6:6a:b6:25
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x2bbafc7d
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
###[ BT4LE ]### 
  access_addr= 0x2bbafc7d
  crc       = 0x521331
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_FEATURE_RSP
###[ LL_FEATURE_RSP ]### 
           feature_set= le_encryption+conn_par_req_proc+ext_reject_ind+slave_init_feat_exch+le_ping+le_data_len_ext+ll_privacy+ext_scan_filter+le_2m_phy+le_coded_phy+le_ext_adv+le_periodic_adv+ch_sel_alg+le_pwr_class+?+?+?+?

09fff901000e000000
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_FEATURE_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
###[ BT4LE ]### 
  access_addr= 0x2bbafc7d
  crc       = 0x3a2c77
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_REQ
###[  LL_LENGTH_REQ ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

14fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x2bbafc7d
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
###[ BT4LE ]### 
  access_addr= 0x2bbafc7d
  crc       = 0xcb7cfc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 6
###[ BTLE_CTRL ]### 
        opcode    = LL_VERSION_IND
###[ LL_VERSION_IND ]### 
           version   = 5.2
           company   = 205
           subversion= 0xb804

0c0bcd00b804
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_VERSION_IND
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  69:ba:9f:13:92:01
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|ATT_Hdr|ATT_Read_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Read_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Error_Response
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 0500040001
dec_pkt d078f60d01
MIC Wrong
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0x885f9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 9
              max_key_size= 16
              initiator_key_distribution= 2
              responder_key_distribution= 2

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
ef643ec5c68b82ccc7bc55bd1eefe6668a0e9ce3601fc91db3bd644954dd60f3
04fd6a0f54ea799eeb5886bcc8b6d66878d7f37a49f2d078750ed33177dd0837
63270d8ed37dcd5a5ae4e5272a1c7cd7bb931c55b75574fe58357e6c67aa48a9
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Public_Key
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
device_public_key_x bc2e44e3bccdeae30f3fe8573b3b9fa3c2488dc8a199c0fe8ba1acb97bd29064
device_public_key_y b00fe5bb1a7315ffed5ee2f05462470f5e176e5ced08bcacc7bfd345e8ad9bec
###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0x476239
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 69
###[ L2CAP header ]### 
        len       = 65
        cid       = 6
###[ SM header ]### 
           sm_command= 12
###[ Public Key ]### 
              key_x     = '\\xbc.D\\xe3\\xbc\\xcd\\xea\\xe3\x0f?\\xe8W;;\\x9f\\xa3\\xc2H\\x8dȡ\\x99\\xc0\\xfe\\x8b\\xa1\\xac\\xb9{Ґd'
              key_y     = '\\xb0\x0f\\xe5\\xbb\x1as\x15\\xff\\xed^\\xe2\\xf0TbG\x0f^\x17n\\\\xed\x08\\xbc\\xacǿ\\xd3E譛\\xec'

###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0x7285ec
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'n\\x8c"\\xb1\x13V\\xa1]\x0f\\xd4}\\xebV\\xf7\\xfd\x14'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr|SM_Public_Key
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
mrnd 38190c8109a683b3b6c54325bfd6b0f5
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4ba7822cdcb4f20219e535e8c437109d
dhkey_check e02b2fd8a94b0952526807f7921db71e
calculate_DHKey
###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0x138958
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'K\\xa7\\x82,ܴ\\xf2\x02\x19\\xe55\\xe8\\xc47\x10\\x9d'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0x5f4874
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 13
###[ DHKey Check ]### 
              dhkey_check= '\\xde\x03\\xa8\x12\r|\\xca\x06\\xe3\x0f\\xaf2\\x89\\xc2ͽ'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_DHKey_Check|SM_Hdr
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 777836c938ad3e088f52562ad73c3baf
raw_pkt d3
dec_pkt 06
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

06
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 777836c938ad3e088f52562ad73c3baf
raw_pkt 7f75
dec_pkt 0771
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

0771
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 777836c938ad3e088f52562ad73c3baf
raw_pkt b6e9
dec_pkt 0715
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x15

###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x15

0715
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 777836c938ad3e088f52562ad73c3baf
raw_pkt 620c
dec_pkt 0213
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_TERMINATE_IND
###[ LL_TERMINATE_IND ]### 
           code      = 0x13

###[ BT4LE ]### 
  access_addr= 0x94a7ed1d
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_TERMINATE_IND
###[ LL_TERMINATE_IND ]### 
           code      = 0x13

0213
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_20 / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  ba:db:a5:93:11:37
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xa24a64
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
###[ BT4LE ]### 
  access_addr= 0xa24a64
  crc       = 0xbd5263
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_FEATURE_RSP
###[ LL_FEATURE_RSP ]### 
           feature_set= le_encryption+conn_par_req_proc+ext_reject_ind+slave_init_feat_exch+le_ping+le_data_len_ext+ll_privacy+ext_scan_filter+le_2m_phy+le_coded_phy+le_ext_adv+le_periodic_adv+ch_sel_alg+le_pwr_class+?+?+?+?

09fff901000e000000
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_FEATURE_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
###[ BT4LE ]### 
  access_addr= 0xa24a64
  crc       = 0xd56d25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_REQ
###[  LL_LENGTH_REQ ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

14fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xa24a64
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
###[ BT4LE ]### 
  access_addr= 0xa24a64
  crc       = 0xf8798d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 6
###[ BTLE_CTRL ]### 
        opcode    = LL_VERSION_IND
###[ LL_VERSION_IND ]### 
           version   = 5.2
           company   = 205
           subversion= 0xb804

0c0bcd00b804
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_VERSION_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
###[ BT4LE ]### 
  access_addr= 0xa24a64
  crc       = 0xbd5263
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_FEATURE_RSP
###[ LL_FEATURE_RSP ]### 
           feature_set= le_encryption+conn_par_req_proc+ext_reject_ind+slave_init_feat_exch+le_ping+le_data_len_ext+ll_privacy+ext_scan_filter+le_2m_phy+le_coded_phy+le_ext_adv+le_periodic_adv+ch_sel_alg+le_pwr_class+?+?+?+?

09fff901000e000000
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_FEATURE_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
###[ BT4LE ]### 
  access_addr= 0xa24a64
  crc       = 0xd56d25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_REQ
###[  LL_LENGTH_REQ ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

14fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xa24a64
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f5:7d:01:68:e6:0a
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xd57c6af1
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
###[ BT4LE ]### 
  access_addr= 0xd57c6af1
  crc       = 0x521331
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_FEATURE_RSP
###[ LL_FEATURE_RSP ]### 
           feature_set= le_encryption+conn_par_req_proc+ext_reject_ind+slave_init_feat_exch+le_ping+le_data_len_ext+ll_privacy+ext_scan_filter+le_2m_phy+le_coded_phy+le_ext_adv+le_periodic_adv+ch_sel_alg+le_pwr_class+?+?+?+?

09fff901000e000000
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_FEATURE_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
###[ BT4LE ]### 
  access_addr= 0xd57c6af1
  crc       = 0x3a2c77
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_REQ
###[  LL_LENGTH_REQ ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

14fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xd57c6af1
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
###[ BT4LE ]### 
  access_addr= 0xd57c6af1
  crc       = 0xcb7cfc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 6
###[ BTLE_CTRL ]### 
        opcode    = LL_VERSION_IND
###[ LL_VERSION_IND ]### 
           version   = 5.2
           company   = 205
           subversion= 0xb804

0c0bcd00b804
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_VERSION_IND
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  fa:78:d9:85:17:dd
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x9ba169f0
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x9ba169f0
  crc       = 0x885f9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 9
              max_key_size= 16
              initiator_key_distribution= 2
              responder_key_distribution= 2

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
0a211847e8f1940e121cfab0d002df0b2b2d6bf38249aa6f02da9c2274f0606f
38197bb534f6fea2b3ae7578a361ba799dc5338fa25f546c229cba0defe706aa
e1e9cf84040f95d4962586ed9b5915870188cb1972a7257f053eabe65f6922a1
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Public_Key
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
device_public_key_x 9b8ae91d5a3e7dca727e944af6509489efe4d98fe1b0e1010de865f485440cf8
device_public_key_y 99e382e603db2ee41ff0c22a8d3baa144ff5e649c0d2b6d36ea0e618c5c1bb8b
###[ BT4LE ]### 
  access_addr= 0x9ba169f0
  crc       = 0xcf618d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 69
###[ L2CAP header ]### 
        len       = 65
        cid       = 6
###[ SM header ]### 
           sm_command= 12
###[ Public Key ]### 
              key_x     = '\\x9b\\x8a\\xe9\x1dZ>}\\xcar~\\x94J\\xf6P\\x94\\x89\\xef\\xe4ُ\\xe1\\xb0\\xe1\x01\r\\xe8e\\xf4\\x85D\x0c\\xf8'
              key_y     = '\\x99\\xe3\\x82\\xe6\x03\\xdb.\\xe4\x1f\\xf0\\xc2*\\x8d;\\xaa\x14O\\xf5\\xe6I\\xc0Ҷ\\xd3n\\xa0\\xe6\x18\\xc5\\xc1\\xbb\\x8b'

###[ BT4LE ]### 
  access_addr= 0x9ba169f0
  crc       = 0x419307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x95\\xa3D\\x8a\x12\\xb0O\x13\\xdb\\xd1m\\x89\\xa0\\xc6Q='

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr|SM_Public_Key
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
mrnd 5af7bb5be7fbad80fc488d1432da9053
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd d2d0241b33c376e2e40d331cb3129e20
dhkey_check d6db2502048e1ba2a19c0b4b169b25c0
calculate_DHKey
###[ BT4LE ]### 
  access_addr= 0x9ba169f0
  crc       = 0xef1b22
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xd2\\xd0$\x1b3\\xc3v\\xe2\\xe4\r3\x1c\\xb3\x12\\x9e '

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
###[ BT4LE ]### 
  access_addr= 0x9ba169f0
  crc       = 0xabcbfb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 13
###[ DHKey Check ]### 
              dhkey_check= '~\\xd2:\\xe4F\\x85\\xe6\\xce\x11j\\xc2ٌ\x04ښ'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_DHKey_Check|SM_Hdr
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
###[ BT4LE ]### 
  access_addr= 0x9ba169f0
  crc       = 0x521331
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_FEATURE_RSP
###[ LL_FEATURE_RSP ]### 
           feature_set= le_encryption+conn_par_req_proc+ext_reject_ind+slave_init_feat_exch+le_ping+le_data_len_ext+ll_privacy+ext_scan_filter+le_2m_phy+le_coded_phy+le_ext_adv+le_periodic_adv+ch_sel_alg+le_pwr_class+?+?+?+?

09fff901000e000000
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_FEATURE_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
###[ BT4LE ]### 
  access_addr= 0x9ba169f0
  crc       = 0x3a2c77
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_REQ
###[  LL_LENGTH_REQ ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

14fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x9ba169f0
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
###[ BT4LE ]### 
  access_addr= 0x9ba169f0
  crc       = 0xcb7cfc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 6
###[ BTLE_CTRL ]### 
        opcode    = LL_VERSION_IND
###[ LL_VERSION_IND ]### 
           version   = 5.2
           company   = 205
           subversion= 0xb804

0c0bcd00b804
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_VERSION_IND
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  8d:5f:74:18:fb:1c
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xee2ae032
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xee2ae032
  crc       = 0xc8d5e8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 9
              max_key_size= 16
              initiator_key_distribution= 2
              responder_key_distribution= 2

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
285e60bb674528e2039ba99bcd86c8bfd52992a8d54ed3c268b60d33073940f7
6e1781a97c41d1342e5cfd2bea36017f77a179dabdd7c6bc374f8b343d26c5a5
ea7a5807d68f5404687c1710ad13163f935088144d2f4058781a72f845b10d4a
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Public_Key
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
device_public_key_x b3c8cebee30355f82bdd61c382f46a2a4ac86e2835bed280c982200d473776aa
device_public_key_y d7a154b79fa1ef9a072a71c5e46c06efc4ea21ebc9dfaa838a32fe90c4fa4356
###[ BT4LE ]### 
  access_addr= 0xee2ae032
  crc       = 0x151511
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 69
###[ L2CAP header ]### 
        len       = 65
        cid       = 6
###[ SM header ]### 
           sm_command= 12
###[ Public Key ]### 
              key_x     = '\\xb3\\xc8ξ\\xe3\x03U\\xf8+\\xddaÂ\\xf4j*J\\xc8n(5\\xbeҀɂ \rG7v\\xaa'
              key_y     = 'סT\\xb7\\x9f\\xa1\\xef\\x9a\x07*q\\xc5\\xe4l\x06\\xef\\xc4\\xea!\\xeb\\xc9ߪ\\x83\\x8a2\\xfe\\x90\\xc4\\xfaCV'

###[ BT4LE ]### 
  access_addr= 0xee2ae032
  crc       = 0xe1b6c6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'z\\xa4䂰\x13?\\xffV5`?"\\xebN\x11'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr|SM_Public_Key
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
mrnd 42c8beff631d2399699c7048b9fdea20
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd c36499207e545754cbbb96553e8342ed
dhkey_check 61b1614c69a38819cc01d56ad25c5724
calculate_DHKey
###[ BT4LE ]### 
  access_addr= 0xee2ae032
  crc       = 0x58647d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xc3d\\x99 ~TWT˻\\x96U>\\x83B\\xed'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
###[ BT4LE ]### 
  access_addr= 0xee2ae032
  crc       = 0xf27662
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 13
###[ DHKey Check ]### 
              dhkey_check= 'j\x00\\x96\x0f\x02qI\x19\\x86oϿ>\\xf7ƥ'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_DHKey_Check|SM_Hdr
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  0c:43:86:23:63:5e
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xb8e02db9
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
ltk 00000000000000000000000000000000
skd 7d4e66308f1b0c09a2febcf52a966ae6
sk 8b40a6362d20966f8bbc3e312d4a063d
###[ BT4LE ]### 
  access_addr= 0xb8e02db9
  crc       = 0x8e8e40
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe66a962af5bcfea2
           ivs       = 0xac9bd85e

04a2febcf52a966ae65ed89bac
###[ BT4LE ]### 
  access_addr= 0xb8e02db9
  crc       = 0x172696
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x3
           error_code= 0x6

110306
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_ENC_RSP|LL_REJECT_EXT_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
###[ BT4LE ]### 
  access_addr= 0xb8e02db9
  crc       = 0xbd5263
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_FEATURE_RSP
###[ LL_FEATURE_RSP ]### 
           feature_set= le_encryption+conn_par_req_proc+ext_reject_ind+slave_init_feat_exch+le_ping+le_data_len_ext+ll_privacy+ext_scan_filter+le_2m_phy+le_coded_phy+le_ext_adv+le_periodic_adv+ch_sel_alg+le_pwr_class+?+?+?+?

09fff901000e000000
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_FEATURE_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
###[ BT4LE ]### 
  access_addr= 0xb8e02db9
  crc       = 0xd56d25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_REQ
###[  LL_LENGTH_REQ ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

14fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xb8e02db9
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
###[ BT4LE ]### 
  access_addr= 0xb8e02db9
  crc       = 0xf8798d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 6
###[ BTLE_CTRL ]### 
        opcode    = LL_VERSION_IND
###[ LL_VERSION_IND ]### 
           version   = 5.2
           company   = 205
           subversion= 0xb804

0c0bcd00b804
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_VERSION_IND
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  96:d6:41:f5:c8:e7
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xf161efd4
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
ltk 00000000000000000000000000000000
skd f314c401d36e2a9ec1fe5f2fb317ba86
sk 07cb32fa57b9452a7f1174abe533fe15
###[ BT4LE ]### 
  access_addr= 0xf161efd4
  crc       = 0xac877f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x86ba17b32f5ffec1
           ivs       = 0x4d0d8fe

04c1fe5f2fb317ba86fed8d004
###[ BT4LE ]### 
  access_addr= 0xf161efd4
  crc       = 0xba8aa2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x3
           error_code= 0x6

110306
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_ENC_RSP|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a5:f3:86:b5:4b:68
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xd7d1572
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_ENC_RSP
ltk 00000000000000000000000000000000
skd 0000000000000000f2919c3fce8bfc77
sk 2ccaa293e85d1764471bd96448ee2b00
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
###[ BT4LE ]### 
  access_addr= 0xd7d1572
  crc       = 0xbd9162
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x4

0704
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
###[ BT4LE ]### 
  access_addr= 0xd7d1572
  crc       = 0x521331
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_FEATURE_RSP
###[ LL_FEATURE_RSP ]### 
           feature_set= le_encryption+conn_par_req_proc+ext_reject_ind+slave_init_feat_exch+le_ping+le_data_len_ext+ll_privacy+ext_scan_filter+le_2m_phy+le_coded_phy+le_ext_adv+le_periodic_adv+ch_sel_alg+le_pwr_class+?+?+?+?

09fff901000e000000
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_FEATURE_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
###[ BT4LE ]### 
  access_addr= 0xd7d1572
  crc       = 0x3a2c77
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_REQ
###[  LL_LENGTH_REQ ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

14fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xd7d1572
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
###[ BT4LE ]### 
  access_addr= 0xd7d1572
  crc       = 0xcb7cfc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 6
###[ BTLE_CTRL ]### 
        opcode    = LL_VERSION_IND
###[ LL_VERSION_IND ]### 
           version   = 5.2
           company   = 205
           subversion= 0xb804

0c0bcd00b804
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_VERSION_IND
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  ad:54:2b:95:61:1d
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x4ddf98cb
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_ENC_RSP
ltk 00000000000000000000000000000000
skd 0000000000000000d0cc1d64fac17587
sk bc3a37da32df4ad5892abfa6f69542ce
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
###[ BT4LE ]### 
  access_addr= 0x4ddf98cb
  crc       = 0xa0a7a1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x4

0704
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  63:eb:07:aa:53:14
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0x3dbc61
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x5

###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0x3dbc61
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x5

0705
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0xfd362
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7c

###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0xfd362
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7c

077c
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0xaafe60
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa3

###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0xaafe60
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa3

07a3
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0x57cc61
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x6d

###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0x57cc61
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x6d

076d
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0x62f461
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xbd

###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0x62f461
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xbd

07bd
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0x237160
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x5f

###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0x237160
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x5f

075f
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0x957d60
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x1f

###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0x957d60
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x1f

071f
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0xe9bea0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xfa

###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0xe9bea0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xfa

07fa
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PING_RSP / Raw / LL_PING_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0x45d360
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x13

###[ BT4LE ]### 
  access_addr= 0x8ad3cad9
  crc       = 0x45d360
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x13

0713
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  49:8a:0c:23:7b:7b
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x2c61e3e8
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2c61e3e8
  crc       = 0x3dbc61
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x5

###[ BT4LE ]### 
  access_addr= 0x2c61e3e8
  crc       = 0x3dbc61
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x5

0705
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2c61e3e8
  crc       = 0x7f2063
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x76

###[ BT4LE ]### 
  access_addr= 0x2c61e3e8
  crc       = 0x7f2063
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x76

0776
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2c61e3e8
  crc       = 0x4716a1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa8

###[ BT4LE ]### 
  access_addr= 0x2c61e3e8
  crc       = 0x4716a1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa8

07a8
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2c61e3e8
  crc       = 0x2fa360
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7b

###[ BT4LE ]### 
  access_addr= 0x2c61e3e8
  crc       = 0x2fa360
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7b

077b
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  ee:ea:0f:07:a5:80
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt d3
dec_pkt 06
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

06
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 7f78
dec_pkt 077c
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7c

###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7c

077c
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt b65f
dec_pkt 07a3
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa3

###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa3

07a3
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 6772
dec_pkt 076d
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x6d

###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x6d

076d
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt c5f0
dec_pkt 07bd
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xbd

###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xbd

07bd
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt e33c
dec_pkt 075f
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x5f

###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x5f

075f
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt e80b
dec_pkt 071f
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x1f

###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x1f

071f
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 9a37
dec_pkt 07fa
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xfa

###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xfa

07fa
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PING_RSP / Raw / LL_PING_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt c03e
dec_pkt 0713
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x13

###[ BT4LE ]### 
  access_addr= 0x49ac7ad5
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x13

0713
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  58:f4:ff:ee:95:2d
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xaed97b86
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt d3
dec_pkt 06
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xaed97b86
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

###[ BT4LE ]### 
  access_addr= 0xaed97b86
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

06
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_RSP
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 7f72
dec_pkt 0776
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xaed97b86
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x76

###[ BT4LE ]### 
  access_addr= 0xaed97b86
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x76

0776
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt b654
dec_pkt 07a8
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xaed97b86
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa8

###[ BT4LE ]### 
  access_addr= 0xaed97b86
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa8

07a8
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 6764
dec_pkt 077b
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xaed97b86
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7b

###[ BT4LE ]### 
  access_addr= 0xaed97b86
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7b

077b
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  d5:4c:6a:86:3a:0d
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x8d5198b6
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
###[ BT4LE ]### 
  access_addr= 0x8d5198b6
  crc       = 0xbd5263
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_FEATURE_RSP
###[ LL_FEATURE_RSP ]### 
           feature_set= le_encryption+conn_par_req_proc+ext_reject_ind+slave_init_feat_exch+le_ping+le_data_len_ext+ll_privacy+ext_scan_filter+le_2m_phy+le_coded_phy+le_ext_adv+le_periodic_adv+ch_sel_alg+le_pwr_class+?+?+?+?

09fff901000e000000
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_FEATURE_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
###[ BT4LE ]### 
  access_addr= 0x8d5198b6
  crc       = 0xd56d25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_REQ
###[  LL_LENGTH_REQ ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

14fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x8d5198b6
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
###[ BT4LE ]### 
  access_addr= 0x8d5198b6
  crc       = 0xf8798d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 6
###[ BTLE_CTRL ]### 
        opcode    = LL_VERSION_IND
###[ LL_VERSION_IND ]### 
           version   = 5.2
           company   = 205
           subversion= 0xb804

0c0bcd00b804
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_VERSION_IND
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  d1:e1:73:42:fe:88
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xb0c90534
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  9e:a0:a9:4d:f4:a8
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xa7b5d909
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
###[ BT4LE ]### 
  access_addr= 0xa7b5d909
  crc       = 0x521331
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_FEATURE_RSP
###[ LL_FEATURE_RSP ]### 
           feature_set= le_encryption+conn_par_req_proc+ext_reject_ind+slave_init_feat_exch+le_ping+le_data_len_ext+ll_privacy+ext_scan_filter+le_2m_phy+le_coded_phy+le_ext_adv+le_periodic_adv+ch_sel_alg+le_pwr_class+?+?+?+?

09fff901000e000000
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_FEATURE_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
###[ BT4LE ]### 
  access_addr= 0xa7b5d909
  crc       = 0x3a2c77
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_REQ
###[  LL_LENGTH_REQ ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

14fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xa7b5d909
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
###[ BT4LE ]### 
  access_addr= 0xa7b5d909
  crc       = 0xcb7cfc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 6
###[ BTLE_CTRL ]### 
        opcode    = LL_VERSION_IND
###[ LL_VERSION_IND ]### 
           version   = 5.2
           company   = 205
           subversion= 0xb804

0c0bcd00b804
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_VERSION_IND
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  58:5e:53:d4:a3:b2
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xa49bcc75
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  54:ef:cc:3a:d7:92
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x24263d74
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|ATT_Hdr|ATT_Read_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Read_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Error_Response
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 0500040001
dec_pkt d078f60d01
MIC Wrong
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
###[ BT4LE ]### 
  access_addr= 0x24263d74
  crc       = 0xbd5263
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_FEATURE_RSP
###[ LL_FEATURE_RSP ]### 
           feature_set= le_encryption+conn_par_req_proc+ext_reject_ind+slave_init_feat_exch+le_ping+le_data_len_ext+ll_privacy+ext_scan_filter+le_2m_phy+le_coded_phy+le_ext_adv+le_periodic_adv+ch_sel_alg+le_pwr_class+?+?+?+?

09fff901000e000000
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_FEATURE_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
###[ BT4LE ]### 
  access_addr= 0x24263d74
  crc       = 0xd56d25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_REQ
###[  LL_LENGTH_REQ ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

14fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x24263d74
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
###[ BT4LE ]### 
  access_addr= 0x24263d74
  crc       = 0xf8798d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 6
###[ BTLE_CTRL ]### 
        opcode    = LL_VERSION_IND
###[ LL_VERSION_IND ]### 
           version   = 5.2
           company   = 205
           subversion= 0xb804

0c0bcd00b804
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_VERSION_IND
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  22:b6:2d:33:e7:f5
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xb8dd747f
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|ATT_Hdr|ATT_Read_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Read_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Error_Response
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 0500040001
dec_pkt d078f60d01
MIC Wrong
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  75:8f:ea:0f:3a:bc
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|ATT_Hdr|ATT_Read_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Read_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Error_Response
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 0500040001
dec_pkt d078f60d01
MIC Wrong
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0x885f9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 9
              max_key_size= 16
              initiator_key_distribution= 2
              responder_key_distribution= 2

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
27a94e21407fe3053c75c4a0b4ea0626441b5f7a062a28000d5304a4c8b8df6b
032ec0ed38a8051ded9b855f51dbeeca2a73cf139705fd8d9124171af333e7d1
cdf2b6c56f9510675838e636df450d477d62cae1704850983ad0d406dc7fe781
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Public_Key
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
device_public_key_x b228f3ee16d35beef153771d85e5069a942c170275ca577721aa2f3647983a07
device_public_key_y b19657075c6d1c10b408a307b09d48eb3b78afaa67c5a1b322f784c689f0eca1
###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0xbf9267
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 69
###[ L2CAP header ]### 
        len       = 65
        cid       = 6
###[ SM header ]### 
           sm_command= 12
###[ Public Key ]### 
              key_x     = '\\xb2(\\xf3\\xee\x16\\xd3[\\xee\\xf1Sw\x1d\\x85\\xe5\x06\\x9a\\x94,\x17\x02u\\xcaWw!\\xaa/6G\\x98:\x07'
              key_y     = '\\xb1\\x96W\x07\\m\x1c\x10\\xb4\x08\\xa3\x07\\xb0\\x9dH\\xeb;x\\xaf\\xaagš\\xb3"\\xf7\\x84Ɖ\\xf0\\xec\\xa1'

###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0x42f145
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x99 \\x8cBD\\x95\\xf4\\xf0\\xfc\\xffP\\xef  =\x05'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr|SM_Public_Key
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
mrnd 51c6a1c9e34512ef7488632dab7bb29f
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd d5301453b0343547ef5a3268d3f44aa8
dhkey_check ef0f9f2af701ef531fbdf1ef0a13760f
calculate_DHKey
###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0x32e663
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xd50\x14S\\xb045G\\xefZ2h\\xd3\\xf4J\\xa8'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0x40de2e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 13
###[ DHKey Check ]### 
              dhkey_check= 'z\\xbf\x15\nw\\x9e%\\xb5|\\xe5ʟ1\x0b\\xcd\t'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_DHKey_Check|SM_Hdr
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk c32dff60269350e185b9c1d546b72b7e
raw_pkt d3
dec_pkt 06
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

06
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk c32dff60269350e185b9c1d546b72b7e
raw_pkt 7f75
dec_pkt 0771
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

0771
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk c32dff60269350e185b9c1d546b72b7e
raw_pkt b6e9
dec_pkt 0715
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x15

###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x15

0715
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk c32dff60269350e185b9c1d546b72b7e
raw_pkt 620c
dec_pkt 0213
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_TERMINATE_IND
###[ LL_TERMINATE_IND ]### 
           code      = 0x13

###[ BT4LE ]### 
  access_addr= 0x6fee26ea
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_TERMINATE_IND
###[ LL_TERMINATE_IND ]### 
           code      = 0x13

0213
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  dd:73:d6:72:13:e1
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|ATT_Hdr|ATT_Read_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Read_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Error_Response
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 0500040001
dec_pkt d078f60d01
MIC Wrong
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0xc8d5e8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 9
              max_key_size= 16
              initiator_key_distribution= 2
              responder_key_distribution= 2

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
cd873309081076c1d4d813672a4cccbc5595103b92b8df80de09a5ca638a5883
94b0849499fcc3ef0e5662fd912f58d4c6b54fbd4eea85de4fa61846aad569d3
01a85009bd87a58f78a9e991245fbff33407c6527458498da4df96ec4ddccfab
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Public_Key
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
device_public_key_x 27af1a7c664a1e4ae4374c9582843bbdf79cb64733ae358ec38feb2e29bf1da8
device_public_key_y 783dab02d3540b2340d144649c334c60332298eb511f543e5ebc0955a4a438b9
###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0xedd3e7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 69
###[ L2CAP header ]### 
        len       = 65
        cid       = 6
###[ SM header ]### 
           sm_command= 12
###[ Public Key ]### 
              key_x     = "'\\xaf\x1a|fJ\x1eJ\\xe47L\\x95\\x82\\x84;\\xbd\\xf7\\x9c\\xb6G3\\xae5\\x8eÏ\\xeb.)\\xbf\x1d\\xa8"
              key_y     = 'x=\\xab\x02\\xd3T\x0b#@\\xd1Dd\\x9c3L`3"\\x98\\xebQ\x1fT>^\\xbc\tU\\xa4\\xa48\\xb9'

###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x19bcf7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1de\\xaf-ko\\xe1\\xa0`\\x90\\x8e\\x88_\\xa9\\xab\\x8e'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr|SM_Public_Key
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
mrnd b5f42649b4eeba8b24bdc61db311d081
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 6a9ef6741bb858a8598a61faacd59390
dhkey_check f2f5d69afeca28c9abb61acaba789897
calculate_DHKey
###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x78f38b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'j\\x9e\\xf6t\x1b\\xb8X\\xa8Y\\x8aa\\xfa\\xacՓ\\x90'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x3aeff6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 13
###[ DHKey Check ]### 
              dhkey_check= 'dw\\xae\\xd7\\xf4\x01\\xbe]I)\\xce\\xfdL \\xa8\\xd6'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_DHKey_Check|SM_Hdr
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 632eea7217a68337b6ab3515f14db81d
raw_pkt d3
dec_pkt 06
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

06
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 632eea7217a68337b6ab3515f14db81d
raw_pkt 7f75
dec_pkt 0771
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

0771
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 632eea7217a68337b6ab3515f14db81d
raw_pkt b6e9
dec_pkt 0715
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x15

###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x15

0715
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 632eea7217a68337b6ab3515f14db81d
raw_pkt 67ee
dec_pkt 07f1
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xf1

###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xf1

07f1
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 632eea7217a68337b6ab3515f14db81d
raw_pkt c05e
dec_pkt 0213
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_TERMINATE_IND
###[ LL_TERMINATE_IND ]### 
           code      = 0x13

###[ BT4LE ]### 
  access_addr= 0x2fab0c8b
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_TERMINATE_IND
###[ LL_TERMINATE_IND ]### 
           code      = 0x13

0213
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_20 / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  e9:1d:b3:53:5b:83
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0x9ea48d39
  crc       = 0x1db43a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|ATT_Hdr|ATT_Read_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Read_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Error_Response
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 0500040001
dec_pkt d078f60d01
MIC Wrong
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x9ea48d39
  crc       = 0xc8d5e8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 9
              max_key_size= 16
              initiator_key_distribution= 2
              responder_key_distribution= 2

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
628c89d29374e47a811c664db857048aa077c1c8bdd23bda7d960d9c291b4f8e
c3e971e69c467591b9d40f711febb5e772f6e63ba0450bcfddb909dd1c5e2541
bb1f3d631d7eecca833761627cd91c6c5cada5d3367169ef833d8cfd0285bb87
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Public_Key
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
device_public_key_x 30434b9fd008a4a61522d2b4b716cb60f89e0c268fadc38d0ffaaf23d2107178
device_public_key_y 42b3e5712441f80b7cf4d39de7278b086abb3ca93c9f274d923037de4efcb440
###[ BT4LE ]### 
  access_addr= 0x9ea48d39
  crc       = 0x232eb9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 69
###[ L2CAP header ]### 
        len       = 65
        cid       = 6
###[ SM header ]### 
           sm_command= 12
###[ Public Key ]### 
              key_x     = '0CK\\x9f\\xd0\x08\\xa4\\xa6\x15"Ҵ\\xb7\x16\\xcb`\\xf8\\x9e\x0c&\\x8f\\xadÍ\x0f\\xfa\\xaf#\\xd2\x10qx'
              key_y     = "B\\xb3\\xe5q$A\\xf8\x0b|\\xf4ӝ\\xe7'\\x8b\x08j\\xbb<\\xa9<\\x9f'M\\x9207\\xdeN\\xfc\\xb4@"

###[ BT4LE ]### 
  access_addr= 0x9ea48d39
  crc       = 0x591b2e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8e\\xb8\\xa1^\\xe8a\\xeb;{\\xc0\\x8e\\xa6\\xb5\\x85v3'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr|SM_Public_Key
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
mrnd c435d00d7f25ad4b55627e3a4c6e1547
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a11e6f0b69484aae88e38431ac239cd7
dhkey_check 9cf3fe6c421b83e3291cdb09c8d66ee8
calculate_DHKey
###[ BT4LE ]### 
  access_addr= 0x9ea48d39
  crc       = 0x18d167
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa1\x1eo\x0biHJ\\xae\\x88\\xe3\\x841\\xac#\\x9c\\xd7'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
###[ BT4LE ]### 
  access_addr= 0x9ea48d39
  crc       = 0x91188e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 13
###[ DHKey Check ]### 
              dhkey_check= '\\x87Q|\\xe4\\xe4l佢Y\\xbb\\xa6\\x95\\xd0_\\x8a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_DHKey_Check|SM_Hdr
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk b0e8f7476d100adba24eb13825a0e525
raw_pkt d3
dec_pkt 06
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9ea48d39
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

###[ BT4LE ]### 
  access_addr= 0x9ea48d39
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

06
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk b0e8f7476d100adba24eb13825a0e525
raw_pkt 7f75
dec_pkt 0771
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9ea48d39
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

###[ BT4LE ]### 
  access_addr= 0x9ea48d39
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

0771
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk b0e8f7476d100adba24eb13825a0e525
raw_pkt b3ef
dec_pkt 0213
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9ea48d39
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_TERMINATE_IND
###[ LL_TERMINATE_IND ]### 
           code      = 0x13

###[ BT4LE ]### 
  access_addr= 0x9ea48d39
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_TERMINATE_IND
###[ LL_TERMINATE_IND ]### 
           code      = 0x13

0213
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_FEATURE_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_RSP
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_VERSION_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_CONNECTION_UPDATE_IND
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  71:88:79:dc:65:ec
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_LENGTH_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
###[ BT4LE ]### 
  access_addr= 0xc7b0eb15
  crc       = 0xf2f568
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 9
###[ BTLE_CTRL ]### 
        opcode    = LL_LENGTH_RSP
###[  LL_LENGTH_RSP ]### 
           max_rx_bytes= 0xfb
           max_rx_time= 0x848
           max_tx_bytes= 0xfb
           max_tx_time= 0x848

15fb004808fb004808
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_LENGTH_RSP
-----------------Pre End-----------------
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|ATT_Hdr|ATT_Read_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Read_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / ATT_Hdr / ATT_Error_Response
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk 00000000000000000000000000000000
raw_pkt 0500040001
dec_pkt d078f60d01
MIC Wrong
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xc7b0eb15
  crc       = 0x885f9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 9
              max_key_size= 16
              initiator_key_distribution= 2
              responder_key_distribution= 2

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
824778c536e3b5fbec7381d0fbc9c6c3533f1189d2ff71e96b22e04a64954894
28492249408bf10af4712599320c3d44d25f4c5f0c956e059df82bfb9785b3b6
9a1a568cf8ad7a543ae6ace87ac6757dc5102b3273b6ab464489f0404f240ac2
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Public_Key
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
device_public_key_x 57fe4fa75b418c544ba199414ab5b2dc1dbe4866e56487e119724cc3c0b65fff
device_public_key_y 197c8b6b62a427a50857ba43ab9f73305e9c82e349943f1a9e4eb689f9f8bfd7
###[ BT4LE ]### 
  access_addr= 0xc7b0eb15
  crc       = 0x4bebef
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 69
###[ L2CAP header ]### 
        len       = 65
        cid       = 6
###[ SM header ]### 
           sm_command= 12
###[ Public Key ]### 
              key_x     = 'W\\xfeO\\xa7[A\\x8cTK\\xa1\\x99AJ\\xb5\\xb2\\xdc\x1d\\xbeHf\\xe5d\\x87\\xe1\x19rL\\xc3\\xc0\\xb6_\\xff'
              key_y     = "\x19|\\x8bkb\\xa4'\\xa5\x08W\\xbaC\\xab\\x9fs0^\\x9c\\x82\\xe3I\\x94?\x1a\\x9eN\\xb6\\x89\\xf9\\xf8\\xbf\\xd7"

###[ BT4LE ]### 
  access_addr= 0xc7b0eb15
  crc       = 0x11edd4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'mS\\xbe\\x93\\xf6\\x94\\xb3\\xe4q\\xb1\\xb0\\xc0\x10\\x9fx\\xde'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr|SM_Public_Key
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
mrnd 98504162a2d3b2543e3b9a1b9548e971
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd e9526ff1bfe8100269c3853d6722a772
dhkey_check 970923c00a4ad7d753ba9679624928bf
calculate_DHKey
###[ BT4LE ]### 
  access_addr= 0xc7b0eb15
  crc       = 0x2e4f9e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xe9Ro\\xf1\\xbf\\xe8\x10\x02iÅ=g"\\xa7r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_DHKey_Check
###[ BT4LE ]### 
  access_addr= 0xc7b0eb15
  crc       = 0x2254d7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 13
###[ DHKey Check ]### 
              dhkey_check= '\x07.\\xff\\xe6̴\\xaf\\xa4w\\xa9\\xb4\x1f\\x88\\xda\\xc3\\xc9'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_DHKey_Check|SM_Hdr
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk fe4b22e08cdd83ac091551bebe9f5385
raw_pkt d3
dec_pkt 06
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xc7b0eb15
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

###[ BT4LE ]### 
  access_addr= 0xc7b0eb15
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

06
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_RSP
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_START_ENC_REQ
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
aaaaaaaaaaa+Encrypted
iv 0000000000000000
skd 00000000000000000000000000000000
sk 00000000000000000000000000000000
ltk fe4b22e08cdd83ac091551bebe9f5385
raw_pkt 7f75
dec_pkt 0771
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xc7b0eb15
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

###[ BT4LE ]### 
  access_addr= 0xc7b0eb15
  crc       = 0x0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x71

0771
RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Request
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Public_Key
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE / BTLE_DATA / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
TX ---> BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_DHKey_Check
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / Raw
-----------------Post Start-----------------
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
TX ---> BTLE|BTLE_DATA|BTLE_CTRL|LL_TERMINATE_IND
aaaaaaaaaaa+Encrypted
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_20 / Raw
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  88:18:ea:33:04:d3
Advertiser Address:  9c:95:6e:40:0f:bb
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
Error: The device is not ready. Please reset the device
NRF52 Dongle closed
Dongle connection reset complete
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
Error: The device is not ready. Please reset the device
NRF52 Dongle closed
Dongle connection reset complete
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
Error: The device is not ready. Please reset the device
NRF52 Dongle closed
Dongle connection reset complete
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
device reports readiness to read but returned no data (device disconnected or multiple access on port?)
Pcap saved
0
-----------------------------------
Non-determinism in learning: 0
Non-determinism in equivalence check: 0
-----------------------------------
Traceback (most recent call last):
  File "/home/yangting/Documents/Ble_Test/srcs/ble_learning.py", line 122, in <module>
    visualize_automaton(learned_model, path=learned_model_path, file_type='dot')
                        ^^^^^^^^^^^^^
NameError: name 'learned_model' is not defined. Did you mean: 'learned_model_path'?
