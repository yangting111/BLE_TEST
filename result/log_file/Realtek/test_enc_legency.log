------------------------------
test_layer:test_pkts
------------------------------
Advertiser Address:  00:E0:12:34:56:78
config_file:  /home/yangting/Documents/Ble_Test/srcs/Config_File/Realtek/peripheral_07_30.ini
['ll_enc_req_pkt', 'll_enc_rsp_pkt', 'll_start_enc_req_pkt', 'll_start_enc_rsp_pkt', 'll_pause_enc_req_pkt', 'll_pause_enc_rsp_pkt']
-----------------Pre Start-----------------
Master Address:  3f:c0:cd:51:16:dc
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x15bf3e01
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x15bf3e01
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x15bf3e01
  crc       = 0xe9f1d8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc5\\xc25T\\xe9\\xae\\xdaeuX\\xc0\\x96\\x9f7\\xe0/'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x15bf3e01
  crc       = 0x433889
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '2\x03A]\\xbeB\\xc1\x06k\\xeaC=KF\\x82\\xea'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x15bf3e01
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 851c7276ae3c305816639d6c6e8f1130
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x15bf3e01
  crc       = 0xfa0a13
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x15bf3e01
  crc       = 0xf80864
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xfd50b9dd2f6de383
           ediv      = 0xd3a
           skdm      = 0x682288a098d854cc
           ivm       = 0x5468d347

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
ltk 7b33c9c7ee0e5f0f12510178dc8d26b0
skd 66f6b09565c2760a4e7c4f5227be2729
sk e6e2774912197131fd4634e9d4a7be61
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x15bf3e01
  crc       = 0x2a9d15
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x2927be27524f7c4e
           ivs       = 0xa49ef89c

###[ BT4LE ]### 
  access_addr= 0x15bf3e01
  crc       = 0x2a9d15
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x2927be27524f7c4e
           ivs       = 0xa49ef89c

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x15bf3e01
  crc       = 0x819f1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x15bf3e01
  crc       = 0x819f1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_ENC_RSP|LL_START_ENC_REQ
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  34:c2:69:79:da:d3
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x59aaeb15
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x59aaeb15
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x59aaeb15
  crc       = 0xd52cf3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x14\\xccը\\x94%\\xb6f\\x81\\xca:\x7fn\\xecv\\xae'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x59aaeb15
  crc       = 0xe51a87
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '3\x01\\x9f\x0c\\xea\\xbb\x0c\\xb88&\\x97\\xeev\\x98\\xeeW'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x59aaeb15
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd bc6c79abc2b85372a5274c77cd69ae9d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2f64b93b3559ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x59aaeb15
  crc       = 0xd01100
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/d\\xb9;5Y\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x59aaeb15
  crc       = 0x1f2899
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x1faba43ef318dd44
           ivs       = 0x15a263e0

ltk b8cc8b9a7830c41fd414591cdcff9d02
skd 00000000000000000dd7f407e37a1912
sk f0d75890229795370c6050797291835c
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x59aaeb15
  crc       = 0x40e75a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

###[ BT4LE ]### 
  access_addr= 0x59aaeb15
  crc       = 0x40e75a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a9:a5:52:bb:40:fa
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xcd8594a1
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xcd8594a1
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcd8594a1
  crc       = 0x41250b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'I\\x87\x16\\xbc\x11\x16>\\xea\\xd9\\xd9\\xd8$=bb\\xbf'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcd8594a1
  crc       = 0xc1f2f2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '!(R\\x94\\xc2\\xd4\\xfb\\xde\x7f\\xa6\\x88\\x88^S\\x99h'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xcd8594a1
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 07b59981c1c5f7b0745f86b42317d784
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 1ea5b0e58f52d87290e5eed4c872776a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xcd8594a1
  crc       = 0x7b707b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x1e\\xa5\\xb0\\xe5\\x8fR\\xd8r\\x90\\xe5\\xee\\xd4\\xc8rwj'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcd8594a1
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcd8594a1
  crc       = 0xeb6e47
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ Raw ]### 
           load      = '\\xae\x07\\x92n\\x8d\\xf7'

###[ BT4LE ]### 
  access_addr= 0xcd8594a1
  crc       = 0xeb6e47
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ Raw ]### 
           load      = '\\xae\x07\\x92n\\x8d\\xf7'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a2:9f:f1:60:f7:fb
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xdc860267
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xdc860267
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdc860267
  crc       = 0x15f938
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x9b\\xbeM\\x84\x0f!\\xdbE\\xf2ʅ!4-\\x81\\xb6'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdc860267
  crc       = 0x3d74fe
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xe1|\\xeb\\xfc^H\\xd0\\xe8\\x8e\x7f}QlϤH'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xdc860267
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 37d34cf2f1e6c446abd34cef2a7b4aab
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd d79ded42e8ce76a55325ae3faa12d79b
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xdc860267
  crc       = 0x17875e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'ם\\xedB\\xe8\\xcev\\xa5S%\\xae?\\xaa\x12כ'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdc860267
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xdc860267
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xdc860267
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  3f:fb:47:35:77:c1
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x3911b719
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x3911b719
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3911b719
  crc       = 0x4fde6c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '%\\xc0\\xad]\\xd9_\\xdcP\x13)L0\\xcd\x1bk\\xfb'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3911b719
  crc       = 0x22b85c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xbe8*5\\xbd)\x13l|\\xf8\\xd6\\xfdq$\\xe4\\xb8'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x3911b719
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 4451b30fa3d63a9dd77d2eef511f9f0e
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x3911b719
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3911b719
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x3911b719
  crc       = 0x367055
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xa
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x3911b719
  crc       = 0x367055
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xa
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  5e:51:14:40:e6:b8
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf82ddae
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf82ddae
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf82ddae
  crc       = 0x883df7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '#M\\x98\\xf6\\xa5\\x833\x03\\xfa\\xca\\xf5\t\\x89?=['

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf82ddae
  crc       = 0x3e3858
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'B\\xb0w\\xba\x15\\xc3a\\xe1\\xd5\x08c\\xb4\x0e\\xe2j\\x95'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf82ddae
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 33389570b05983f6803f93d3397d4a5c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd c0d69ded60ebce76ba53255edda9122f
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf82ddae
  crc       = 0xba149f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xc0֝\\xed`\\xeb\\xcev\\xbaS%^ݩ\x12/'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf82ddae
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf82ddae
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xf82ddae
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
----------------step int find_cex----------------
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c6:a9:99:58:67:5d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x98005b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '~\\xbc\\xa3,\\xb2\\xe8\\x92t%,\\xe0w\\x8b{\x10\\xe5'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x6c53ae
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xe4bn\\xc3bk\\x87b`\\xab\x056\\xd7\\xd1\\xcfJ'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd dd277cafd3a986ca892501ab699de912
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cd4b61eb662f77a782cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x604916
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6\\xcdKa\\xebf/w\\xa7\\x82\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0x11ddee82
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  bc:f9:5a:9f:de:25
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0x2fb997
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x98\\x8cp\\xfc;\\xf5\\xe0)\\x96ần\\xd3P\\xea'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0x29ecd0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc4f\\xf7i\\xfe\x0cۇ\\x89\\xf8=\x1c\\xa2\\xc7n='

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd fb08fb7a761cc3e63ae3bbe81c731421
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 44296cbda214b65e64b93b35b2dc9d1a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xfd2e65
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'D)l\\xbd\\xa2\x14\\xb6^d\\xb9;5\\xb2ܝ\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xe7cfc3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xe7cfc3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xf00430
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x2b6552837932e5f9
           ivs       = 0x64414ab7

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xd2f7c3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xae

###[ BT4LE ]### 
  access_addr= 0xd910e5e7
  crc       = 0xd2f7c3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xae

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c6:56:63:e1:b9:4c
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0xd08366
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '-\\xddA0EXs\x0bjw\\xf2\\x82,\\xcc\\xff\\xe8'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x86362d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x93[Oǿ\\x98\\x8eB\\x99\\xe0zo]\\xb2ڸ'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3c025f8ab1c058afc2d57a5d440eec07
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2a6cdda915b6ee547177aa9cde9d2ae1
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0xb1da4b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '*lݩ\x15\\xb6\\xeeTqw\\xaa\\x9cޝ*\\xe1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0xb10030
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x35edbea77c95f63
           ivs       = 0xd221dafe

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0xcfc100
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xae

###[ BT4LE ]### 
  access_addr= 0xa6ec9761
  crc       = 0xcfc100
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xae

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
Counterexample found:  ('ll_pause_enc_rsp_pkt', 'll_pause_enc_rsp_pkt', 'll_pause_enc_rsp_pkt', 'll_start_enc_rsp_pkt', 'll_pause_enc_req_pkt', 'll_enc_rsp_pkt')
-----------------Pre Start-----------------
Master Address:  ed:3b:e6:82:80:ff
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xcfc04b8e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xcfc04b8e
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcfc04b8e
  crc       = 0xbae9be
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = ':r\x0f\\xbbq\\xd6ޢ\\xa5\\x8f\\xd6û\\x8d\x08\\xab'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcfc04b8e
  crc       = 0x82e3bc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc6\\xd2\\xc4\x04\\xe2\x0e`\x15\\x9f\\xecλ`\\xb3\\x8c\\x95'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xcfc04b8e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 17362f3e015274bd3b8d9d1f80da99e8
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 94a31456ca510a2b46b2dc4d2359ee26
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xcfc04b8e
  crc       = 0x265dbf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x94\\xa3\x14V\\xcaQ\n+F\\xb2\\xdcM#Y\\xee&'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcfc04b8e
  crc       = 0xf3af66
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc7553b0cc56d2512
           ivs       = 0xb033b1d3

ltk 419c1e2be95027c8a3209cdf32a552cb
skd 0000000000000000d9c68119f3eb8bec
sk e8b100d6bc52034a3db35580bbbacc59
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcfc04b8e
  crc       = 0xed4b6e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

###[ BT4LE ]### 
  access_addr= 0xcfc04b8e
  crc       = 0xed4b6e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  59:4b:d0:ea:1f:c5
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x72950d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'ht\\xb6\\xb3\\x8d\\xe7\\xa5+\\x85\x7f\\xc0\\xdd\x18\\xb0\x13\\x93'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0xe6b3b4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x9f\\xe8fYRm\x07\x17\\xbf\x18\\xf0I\\x806\x10\\xb5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 6ed33af6ba118ccf66875b8dfc4aefd2
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e2b85ad93b2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x8d743f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^+\\x85\\xad\\x93\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0x616760
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf1f1957a34caa38f
           ivs       = 0xc8b63d5

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0xcfc100
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xae

###[ BT4LE ]### 
  access_addr= 0xdaf38893
  crc       = 0xcfc100
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xae

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  8c:c1:4d:1c:e8:ae
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0x648a31
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '"ʗ\\x8d\x1d\\xeb8\x1c)+\\x99\x15\\xb1:_\\xcf'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0x59e3bd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xdb\x1b\\xd9;\\xe2}O\\xa9\\xefy\x0cO\\x9c\\xb4\\x94\\xc3'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd a47fe1cb73abaaf0436cb24a38dd4ea7
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0xb4e024
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0x64d54f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x78b3f8a1d310e002
           ediv      = 0x6ad9
           skdm      = 0x5c2d17286976470f
           ivm       = 0xd0be0354

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
ltk ee146716e16a46c1cd1a689fc60831af
skd 8194618c2d3a4b9f10df939088ef4948
sk 222a359a422a0fd88cb5ccbf88689794
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0x7ab0f4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4849ef889093df10
           ivs       = 0x2927be27

###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0x7ab0f4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4849ef889093df10
           ivs       = 0x2927be27

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0xead822
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0xead822
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_ENC_RSP|LL_START_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0x482bcf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xee9c998266c7b432
           ivs       = 0x6613e480

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0xed4b6e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

###[ BT4LE ]### 
  access_addr= 0xa6e23fce
  crc       = 0xed4b6e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  44:7c:a2:ad:13:47
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x1b0f4edf
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x1b0f4edf
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1b0f4edf
  crc       = 0x1fe0b3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'Ȉ\\xeajb\ue0c2\\xf7\\xf1\\xa8{OZ\\xd8\x16'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1b0f4edf
  crc       = 0x98626c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x08\x7f8\\xf0\\xf6;\\x84n\\xa9\\xdcِ\\x9e\\xca&\\x80'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x1b0f4edf
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3d0649a9d62328657adc7f02ce9a5374
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b753d8ba5bcadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x1b0f4edf
  crc       = 0x3d2f6e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7Sغ[\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1b0f4edf
  crc       = 0xe44922
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x1d3c57198bbc9722
           ediv      = 0xda9a
           skdm      = 0xb6e561b53968f10a
           ivm       = 0xa9dbf947

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
ltk 77487cd2c8647528d735c76b04269cc5
skd b3f4e15d287b8f3cc4f72424f13d0909
sk 65aa15924f17f81ee6a784f535466053
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x1b0f4edf
  crc       = 0xc80a80
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9093df12424f7c4
           ivs       = 0x4849ef88

###[ BT4LE ]### 
  access_addr= 0x1b0f4edf
  crc       = 0xc80a80
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9093df12424f7c4
           ivs       = 0x4849ef88

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x1b0f4edf
  crc       = 0xead822
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x1b0f4edf
  crc       = 0xead822
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_ENC_RSP|LL_START_ENC_REQ
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  4a:ce:1f:da:d9:c8
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4a2291fb
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4a2291fb
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4a2291fb
  crc       = 0x38a2c5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc2\x19\\x83\\xbd\\xb4D\\xd9\x03c\\xed\\x86\x08\\xf1\\xa7\\x83>'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4a2291fb
  crc       = 0x51267e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xfc\\x8f\x06#r"\\xb0\\xf0\\xd1,\x1ah\\x86E\\xc5\x14'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4a2291fb
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd b77993c025146e5750dc44feceed31ad
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad93b2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4a2291fb
  crc       = 0x417199
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4a2291fb
  crc       = 0x68f614
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x26856ad62b689587
           ivs       = 0xd5fb3daa

ltk 29e2349ebf70e7194dbe4191560e1cd8
skd 00000000000000003f448d22c2ef1512
sk 9a7a9ea4b3a899a35edeaa7ae95dc788
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4a2291fb
  crc       = 0xed4b6e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

###[ BT4LE ]### 
  access_addr= 0x4a2291fb
  crc       = 0xed4b6e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4a2291fb
  crc       = 0x68f614
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x26856ad62b689587
           ivs       = 0xd5fb3daa

ltk 29e2349ebf70e7194dbe4191560e1cd8
skd 00000000000000008a42e84fec4bbd76
sk c48d436da1ae682438801415ea6a521b
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4a2291fb
  crc       = 0xed4b6e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

###[ BT4LE ]### 
  access_addr= 0x4a2291fb
  crc       = 0xed4b6e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  49:0b:1b:27:b6:9e
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xbd0822e3
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xbd0822e3
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xbd0822e3
  crc       = 0x27eb0c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x81\\xccp\\x8a\\xbc\\xc1\\x8a)\\xa6|\x02\\xda!$\\xb9\\xb4'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xbd0822e3
  crc       = 0xea7add
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\r\\xf0.\x06(\\xecƠG\x06\\xd47\x12fB%'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xbd0822e3
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 66502c52cb2d14e638e870e0549cc1f8
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd bf78ad545cbc56ae41e67efc92b91ff9
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xbd0822e3
  crc       = 0xc6c11
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xbfx\\xadT\\\\xbcV\\xaeA\\xe6~\\xfc\\x92\\xb9\x1f\\xf9'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbd0822e3
  crc       = 0x788faf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x67985b3785f04bcd
           ivs       = 0xc1bc6295

ltk 0524486c7c00fa5b0a0b25d67a02d52d
skd 0000000000000000620694f8f5cf4a26
sk 4e69f74c00b3ff527cd220684458db1d
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xbd0822e3
  crc       = 0x40e75a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

###[ BT4LE ]### 
  access_addr= 0xbd0822e3
  crc       = 0x40e75a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  e0:54:08:2b:83:de
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x7aec3f8e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x7aec3f8e
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7aec3f8e
  crc       = 0x9ab70
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'K\\x823Z/\\x9d\\xcfǚ\\x9bx\\xa3\\xb9\\xaa#H'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7aec3f8e
  crc       = 0x2e337d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '&\\xab"1L֙E\\x94\\xef.<\\xb4銐'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x7aec3f8e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c19f449f6b54500cd0afc59a7e72f697
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x7aec3f8e
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7aec3f8e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x7aec3f8e
  crc       = 0xf37309
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 113
###[ Raw ]### 
           load      = '\\x9d\\xe1\\xec\x14qD'

###[ BT4LE ]### 
  access_addr= 0x7aec3f8e
  crc       = 0xf37309
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 113
###[ Raw ]### 
           load      = '\\x9d\\xe1\\xec\x14qD'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7aec3f8e
  crc       = 0x781178
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x50c5a26baef226b5
           ivs       = 0x3ade7580

ltk c662f92b188516ccf709103fda9c41ea
skd 000000000000000042120135a93e9aa1
sk 185e4763234f37253c1da51649389c32
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x7aec3f8e
  crc       = 0xd844f8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\x97P\x00\\x82)i'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x7aec3f8e
  crc       = 0xd844f8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\x97P\x00\\x82)i'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  76:60:b0:e3:a7:eb
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa2c1b737
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa2c1b737
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa2c1b737
  crc       = 0xa5c350
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'C+\\xfe\\xacv\x07]C\\x89\x144\\xf1\\x9aE\\xef>'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa2c1b737
  crc       = 0x5fbeda
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'b\\xc7\\xda<\x06\\xa5z\\x91\\xd7+\\xb9\\xfe$]\x13\\xcc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa2c1b737
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd b69710d74ef2e797d8d93961bf6987a4
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad934b61eb662f77a782cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa2c1b737
  crc       = 0x670b80
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93Ka\\xebf/w\\xa7\\x82\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa2c1b737
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa2c1b737
  crc       = 0xf37309
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 113
###[ Raw ]### 
           load      = '\\x9d\\xe1\\xec\x14qD'

###[ BT4LE ]### 
  access_addr= 0xa2c1b737
  crc       = 0xf37309
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 113
###[ Raw ]### 
           load      = '\\x9d\\xe1\\xec\x14qD'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  6e:9a:9b:99:11:26
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xdbd1569e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xdbd1569e
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdbd1569e
  crc       = 0x5098d4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x08ȣ\\xb2tϗ\x15\\xe9(\\x85\\xde}\\xb2\x00\\xfe'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdbd1569e
  crc       = 0xf8a717
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xaft\\xcfz\\xfb6\\xc8\\xe4/L4\\xaa\\xbc\\xe9-\\xc9'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xdbd1569e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd bf99db1df7d64e4919dc53ab255ede81
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad93b2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xdbd1569e
  crc       = 0x417199
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdbd1569e
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xdbd1569e
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xdbd1569e
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdbd1569e
  crc       = 0xb8f0d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x92e60d0595081429
           ivs       = 0xdf1e47c8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xdbd1569e
  crc       = 0xf7f7c2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x70

###[ BT4LE ]### 
  access_addr= 0xdbd1569e
  crc       = 0xf7f7c2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x70

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  b7:0d:30:0e:1f:6e
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x1884a933
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x1884a933
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1884a933
  crc       = 0xa61cfb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'H\\xf5\x0b}\\xd1դ\\xc4\\xc1a\\xf2\\x8b\\xe0\\xbf\\xcd~'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1884a933
  crc       = 0x8d275c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'Rj\x19\\x860\\xf2\x1d\\xc7ķm\\x84x\\x89\\x8c\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x1884a933
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 2fece8e6423456c5a702d147feebda80
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cda6b075b794bb53c5e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x1884a933
  crc       = 0xe87f34
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6ͦ\\xb0u\\xb7\\x94\\xbbS\\xc5\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1884a933
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x1884a933
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x1884a933
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  d2:51:1b:82:49:10
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x3d946f1e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x3d946f1e
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3d946f1e
  crc       = 0xcd8c98
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'P\\xd6Q\\xae\x00\\xbe2\r\\x9f\x03\\xe9>\\xc1\\xaa+\x19'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3d946f1e
  crc       = 0x43bc9d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x89l7^\\xb0\\x95TX\\xa1\\xc2J\\xe5\\x84eG\\xe5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x3d946f1e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd f4fe3951e0d6146d4015aa8d0950c167
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 53d8ba5b2a6cdda97177aa9cbb3b55ca
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x3d946f1e
  crc       = 0xe11928
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Sغ[*lݩqw\\xaa\\x9c\\xbb;U\\xca'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3d946f1e
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x3d946f1e
  crc       = 0x9bdc61
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xa
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x3d946f1e
  crc       = 0x9bdc61
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xa
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3d946f1e
  crc       = 0x22aa98
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf9c9f2a9a20a05ac
           ivs       = 0xf897c9b

ltk d1b16e41b34cf4ab72a5976792ceca04
skd 0000000000000000c22a1e65c3ab456d
sk 946276ee79e3798db418cb83a0023030
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x3d946f1e
  crc       = 0x40e75a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

###[ BT4LE ]### 
  access_addr= 0x3d946f1e
  crc       = 0x40e75a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  3d:11:5e:1a:cb:59
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x332c8652
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x332c8652
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x332c8652
  crc       = 0x81bd48
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xfcR!\x08\\xb6D!\\xef\\xd1\\xd5\\xfd\\xac\\xa4u\\xea\\xf7'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x332c8652
  crc       = 0x8ae91b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xeb\\xa9\x10\\xe2\\xfd\\xfa?\\xa8\\xe1\x08\\xc8\\xG\\x81\\x86'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x332c8652
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd d7b5b07b8ecdb7e82f48975fe55b2ffe
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 17af952b88d7ca9167ee47ba30f723d9
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x332c8652
  crc       = 0x7c75e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x17\\xaf\\x95+\\x88\\xd7ʑg\\xeeG\\xba0\\xf7#\\xd9'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x332c8652
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x332c8652
  crc       = 0x367055
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xa
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x332c8652
  crc       = 0x367055
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xa
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  63:7d:46:55:ce:89
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4f2ac5c0
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4f2ac5c0
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4f2ac5c0
  crc       = 0xf36f02
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'O\\x8f\\xbd@\\x87\x7f\\xea<\\x85zV<\\x9c\\x83vf'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4f2ac5c0
  crc       = 0x77e297
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = ' \\xd3\\xe8\\xa8O\r\\x8b|\\xae\\xf8<\\xdd\\xef\x0b\\xa5\\xe5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4f2ac5c0
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd ae7a446d6ba524492171d7324905b18d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4f2ac5c0
  crc       = 0x77130c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4f2ac5c0
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4f2ac5c0
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x4f2ac5c0
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4f2ac5c0
  crc       = 0x33bce7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x46fd13549af6ff65
           ivs       = 0xbc940b0

ltk 129ca1f6f847a0a9891fed739911ee70
skd 0000000000000000c915c958714abf81
sk 45c93db683a740d098efce416dcf838e
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4f2ac5c0
  crc       = 0x40e75a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

###[ BT4LE ]### 
  access_addr= 0x4f2ac5c0
  crc       = 0x40e75a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  1b:b5:01:58:50:55
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x79a8fb9c
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x79a8fb9c
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x79a8fb9c
  crc       = 0xec9871
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'BP\\x8b\\x8d\x0b\\xe6\\xcb\x10\\xc3PS\x7f\x7f\x08\\x8d\\xb3'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x79a8fb9c
  crc       = 0x2d047f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1d\x1a\\xaf\nėR\x0c\\xb2#C\x07\\x9dc\\xeb\\xcc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x79a8fb9c
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 98adb56fff1bd6150f600024c811eae4
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd59ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x79a8fb9c
  crc       = 0x360915
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcdY\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x79a8fb9c
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x79a8fb9c
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x79a8fb9c
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  ce:4e:95:c9:fc:64
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0x54028b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc1\\xa1\x01c\\x94M\\xa3\\xb0k\\xd31\\xcdo:\\xc5\\xf1'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0x9d88d8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '#V\\xce\\xf8\\x98\x02.\n\\x9bӨ\\xd6\\xe1\\xe3"\\xae'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e72f33f4c9066d5165c90e48e8009c2a
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad934b61eb662f77a782cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0x670b80
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93Ka\\xebf/w\\xa7\\x82\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xe7cfc3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xe7cfc3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xd3470f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x2d97e8aa99fb839f
           ediv      = 0xff31
           skdm      = 0xb514d6b57622f061
           ivm       = 0x2a11448f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xf287c1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa9

###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xf287c1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa9

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xe2c1c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x941bc9067cec3ed1
           ivs       = 0x72c55da5

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xa774c1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7d

###[ BT4LE ]### 
  access_addr= 0x65a2b323
  crc       = 0xa774c1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7d

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  b8:84:6a:5f:28:f1
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0xd09ffd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'F\\xe5V\\xd6\\xe6\x07](\\xa58\\xe8\x10\\xe0\\xc8\\xee\\x81'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x8a180a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xed<\x158lm\\xdd\x16b`\\xcb^k\\xc3\\xed\\xd0'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd bcab46dd4e778b00eb1ef0e6b5d9cf3e
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd c0d69ded60ebce76dda9122fed548993
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x49c30e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xc0֝\\xed`\\xeb\\xcevݩ\x12/\\xedT\\x89\\x93'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0x3d51ee
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x7ef6d8ff6f7e6985
           ediv      = 0x9111
           skdm      = 0xf2b7e4c93f232ada
           ivm       = 0xe9cfda1b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0xefb102
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa9

###[ BT4LE ]### 
  access_addr= 0x675cf211
  crc       = 0xefb102
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa9

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  9e:c9:d1:c9:68:b8
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x4efba
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'i!\\xf2\x12\\xf3\x04r\\x86|\\xcd5\\x97\\xdc\x14\x18-'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0xc62dfe
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '{\\xe0p\\xa1s ?-RtV\\r\\x90\\xf5\\xef'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd ffe16a9afa0e7f0d3b24d70f7124078f
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0xfa0a13
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x493757
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa881f41380589f13
           ivs       = 0x3b12d964

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0xcfc100
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xae

###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0xcfc100
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xae

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0x493757
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa881f41380589f13
           ivs       = 0x3b12d964

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0xba4202
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7d

###[ BT4LE ]### 
  access_addr= 0x99e1c8a
  crc       = 0xba4202
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7d

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a5:81:0a:c0:eb:7e
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0x5302f0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'b\\x8f\x1c\x05XT\\x9fW\x175\\xc8XP$t\\x9b'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0x5ba7b3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xcb\x1bJS\\xbf\\xd9ٌT\\x885+\\xfb\\x92\\xb1\\xd4'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3f35293a5e22cfbb1c9bf7b5bb16ca50
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b753d8ba5be5ee54317177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0x46998c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7Sغ[\\xe5\\xeeT1qw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0xe7cfc3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0xe7cfc3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0x767a5b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc5b19d3433684dbd
           ivs       = 0xfa443bdc

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0xd2f7c3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xae

###[ BT4LE ]### 
  access_addr= 0xb3457ca6
  crc       = 0xd2f7c3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xae

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  e9:31:1a:6f:2b:58
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0xaa9cd3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x14TmA\\xc9\\xea[\\x82\\xd1U\\xc9\\xe4=%\\xd7g'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x284564
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'WB\\xc9\\xc0\x7f\\xb4\\x82Y\x01PB\x1d\x15\\x81Z\\xbe'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd de4da7c0e9bb9d087d643710bb175700
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x77130c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x4fec03
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xaf

###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0x4fec03
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xaf

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0xc19251
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x701017aa893a9013
           ivs       = 0x67c8384d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0xba4202
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7d

###[ BT4LE ]### 
  access_addr= 0xad101c9e
  crc       = 0xba4202
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7d

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  b2:93:30:77:40:2d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0x674aee
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\\xa4\\xae\\xe1\\xbf\x08'r\\xf2\\x9b\x0b\\xd0\x1f\\x854\\xc0\\xf7"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0x74aef3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\r\\x97\\xa9\\xf4\\xe1\x0fO\\xf1fa\\x8a\\xb5\\xf3\\x87n\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd aab07db190e800a58dc252d5eac11643
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 5cbc56ae2e5e2b5792b91ff9c9dc8f7c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0xe5a17c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\\\xbcV\\xae.^+W\\x92\\xb9\x1f\\xf9\\xc9\u070f|'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0xe7cfc3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0xe7cfc3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0x52dac0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xaf

###[ BT4LE ]### 
  access_addr= 0xf9c1f186
  crc       = 0x52dac0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xaf

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  ee:ea:ac:5e:27:6b
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x237be7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'O\x00\x04B\x05\\xd7TͦB\x17H\\x897|:'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x5bb6b9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'lrH\x19\\x92\\x81E(\\xd3d\\xb7\\xb6\\xb2t\\xe2\x10'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 64c235ef077b58bee45909f58a980bf7
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b72a6cdda9e5ee54317177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0xf04e70
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7*lݩ\\xe5\\xeeT1qw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0xf5701
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xac

###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0xf5701
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xac

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0x6546a2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe670f324204f1165
           ivs       = 0xdb73b194

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0xba4202
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7d

###[ BT4LE ]### 
  access_addr= 0xb2e85799
  crc       = 0xba4202
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7d

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  85:c8:9a:13:1b:6a
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0xcfda19
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x81\x1ew4l\x00\\x9fGʪ\\xd4~1[g\\xdd'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x4b967f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'x\\xc0U\\xd6!2\\\\xbd\x1a^\\xe1Hz\\xa8V2'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 5b1fe9403b56c0fd5d94cf0f31a133cb
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cd4b61eb662f77a782cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x604916
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6\\xcdKa\\xebf/w\\xa7\\x82\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0xf5701
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xac

###[ BT4LE ]### 
  access_addr= 0xb6b31929
  crc       = 0xf5701
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xac

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  36:ad:e5:d6:17:7a
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x9eb807
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa1^\x07Y\\xe6\\xecב\\xdf~SZ\x03\\xe1 \n'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x5c22fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'ٍ\\xb4\\xecD\x0ex\\x98\\xd7\\xda\x14\\x95К+\\xa2'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 21bf4c78b2eef6e6bd0495e4f385a0c5
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd ca510a2be52885152359ee26922c7797
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x69cdba
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xcaQ\n+\\xe5(\\x85\x15#Y\\xee&\\x92,w\\x97'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0xdff901
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa0

###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0xdff901
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa0

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0x4162f5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x916f2c4a11734ae8
           ivs       = 0xd7e35058

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0xba4202
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7d

###[ BT4LE ]### 
  access_addr= 0xbcb8b990
  crc       = 0xba4202
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7d

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  d4:40:e6:ba:05:ae
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0x69c92
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "]\x1c\\xab\\xd8q\x1f\\xf1\\xa1'7\\x8d\\x99gƥ\x07"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0x625e52
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'fs\x06Tu\\xd9\x1b\x1b\\xc5h\x02\x03sG\\xd7\\xcc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 0798cd89e6b4a27595a7745223711dcb
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 8f52d872a214b65ec872776a64b93b35
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xab8fe2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x8fR\\xd8r\\xa2\x14\\xb6^\\xc8rwjd\\xb9;5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0x36a0fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xe7cfc3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xe7cfc3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xc2cfc2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa0

###[ BT4LE ]### 
  access_addr= 0x483e81e6
  crc       = 0xc2cfc2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa0

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c8:9a:df:45:2f:c9
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x5fd73e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x10de\\xe3\\xb1\\xe7d\\x8a>\x00e\\x9b\\xae\\xb3G\\xff'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0xe7a94
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xcd\\xe2\\xf9\\xcc\\xf1|\\x94n\\x97E\\xb2h\\x82oܱ'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd f4383eb19ff2b7420d55b2df3cbfc519
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 44296cbd510a5b2f64b93b3559ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x8052d5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'D)l\\xbdQ\n[/d\\xb9;5Y\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x5fd402
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa1

###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0x5fd402
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa1

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0xba077e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf23f5d1f96c4152c
           ivs       = 0xa4f8a4a8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0xba4202
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7d

###[ BT4LE ]### 
  access_addr= 0x9b0cf6bb
  crc       = 0xba4202
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7d

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  29:e3:d3:a8:90:20
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0xf80aa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '*\\xb9\\\\xa0"a\\xa7x0\\xed\\xb0\\xbaGt0\\xd3'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x159a6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '#\\x95C\\x94IB\\xcb}+%\\xc2\\xf5\\x87\\x96\\xbb9'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 45895985c9795886c62dd1ef1cec92da
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x77130c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x5fd402
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa1

###[ BT4LE ]### 
  access_addr= 0xd07887fe
  crc       = 0x5fd402
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xa1

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  4e:df:c3:5c:8d:2f
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0xce2886
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8f\x1e\\xe4\\xe6\x1fg\\xf9%\\xect?\\xcdI\\xa4R\\xa5'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0x71b421
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x86n,\\xfa\x0cA\\x9f9m:\\xe2O\\xc3:\\xe90'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd b7a1933efff3cc7dfb21a4ade572d97f
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 44296cbda214b65ec872776a64b93b35
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0x39a08
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'D)l\\xbd\\xa2\x14\\xb6^\\xc8rwjd\\xb9;5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0xb87e0d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 113
###[ Raw ]### 
           load      = '\\x9d\\xe1\\xec\x14qD'

###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0xb87e0d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 113
###[ Raw ]### 
           load      = '\\x9d\\xe1\\xec\x14qD'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0x2329c1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x5cb970ccd50190c8
           ediv      = 0x85cc
           skdm      = 0x8a1d2909da0099d0
           ivm       = 0xeb1043b3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0xf12223
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 113
###[ Raw ]### 
           load      = '\\xfa>\\xf73-\\xdfL\\x9d\nuDm\\xbe\\x93\x0c\\xec'

###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0xf12223
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 113
###[ Raw ]### 
           load      = '\\xfa>\\xf73-\\xdfL\\x9d\nuDm\\xbe\\x93\x0c\\xec'

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0xe00311
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 209
###[ Raw ]### 
           load      = '\\xc8hY\x04'

###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0xe00311
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 209
###[ Raw ]### 
           load      = '\\xc8hY\x04'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x6294ec96
  crc       = 0x6488b8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc5df15cd092e041e
           ivs       = 0x82b35396

ltk 33ff9688fb29a7491f390045a7e49229
skd 607c84f3a50f3e00de29d084357db71c
sk bb8e883e5ef23f801532822749062145
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  7d:20:99:f1:fc:4d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0x90d908
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '@\\xd8\\xf4\\x9cy\x0f\\xb62iF\\xafb\\xd8t\x12Q'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0xd5c905
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'd\\xb7\\xcbW\\xbbLJ\\x89\\xc1L\\xcd&uC\\x80?'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e5642e045d09eb6db3ef1165baab7a3d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d94bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0x86b773
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0x3e5035
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 126
###[ Raw ]### 
           load      = 'D\x1b\x14R\\xc3\x15'

###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0x3e5035
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 126
###[ Raw ]### 
           load      = 'D\x1b\x14R\\xc3\x15'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0x3ab596
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x49c55c472e139704
           ediv      = 0x9d6c
           skdm      = 0xac4ab3dbeadad0eb
           ivm       = 0x20faf318

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0x573aa9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 130
###[ Raw ]### 
           load      = "\\xf8xC\\x89\\xf6L!'2#\x1aLD\\xa20\\xd7"

###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0x573aa9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 130
###[ Raw ]### 
           load      = "\\xf8xC\\x89\\xf6L!'2#\x1aLD\\xa20\\xd7"

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0xfb0108
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 125
###[ Raw ]### 
           load      = '*\\xb4bm'

###[ BT4LE ]### 
  access_addr= 0x779c86f1
  crc       = 0xfb0108
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 125
###[ Raw ]### 
           load      = '*\\xb4bm'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  1b:84:ab:f6:7f:f1
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0xc148dd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = ':\\xc0\x18-\\xff\\x80\\xc6&\\xfa0\x12D\\xaa\\xe3\\x8d+'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0xfe32d5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xbede4\\xa5\\xa6\x19\t\x1f\x08\\xed\\xf3\\xb7+B\\xf3'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 105ce5118e1d5103b129597721709f73
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 44296cbda214b65e64b93b35b2dc9d1a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0xcaab69
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'D)l\\xbd\\xa2\x14\\xb6^d\\xb9;5\\xb2ܝ\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0xf3192
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0xf3192
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0x297108
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x2a6e43b3d5236f46
           ivs       = 0x18ed386f

ltk a331f69625e851bc0307526e99afc950
skd 00000000000000008ba7731a68bee4d8
sk b210abe76dccea4f380b9ba3b883e7e2
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0x7066e8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 151
###[ Raw ]### 
           load      = "\x1e'~\\x878\\xb8"

###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0x7066e8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 151
###[ Raw ]### 
           load      = "\x1e'~\\x878\\xb8"

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0x297108
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x2a6e43b3d5236f46
           ivs       = 0x18ed386f

ltk a331f69625e851bc0307526e99afc950
skd 0000000000000000f30afa6dc5e16f96
sk 27253f7b65c09edb6ef65fb8a0cd2e1c
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0xb3042f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 105
###[ Raw ]### 
           load      = '\\xe1\\xe9\\xb6\x0f0U'

###[ BT4LE ]### 
  access_addr= 0xa82022a9
  crc       = 0xb3042f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 105
###[ Raw ]### 
           load      = '\\xe1\\xe9\\xb6\x0f0U'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  db:d7:4a:22:18:ad
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x461a9a2
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x461a9a2
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x461a9a2
  crc       = 0x82323
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'L\x07\\xbbh@ȰJ\\xf5n\x19\\xf3\\x89\x1dJ9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x461a9a2
  crc       = 0x7e5fd9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\x18r\\x98\x0b\\xe9l\x1f\\xd0\\xdf\\xc6\\xfa'\\x982\\x93\\xd0"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x461a9a2
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 4bfdb185104df0b397ea066456de6f5c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 1ea5b0e58f52d87290e5eed4c872776a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x461a9a2
  crc       = 0x7b707b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x1e\\xa5\\xb0\\xe5\\x8fR\\xd8r\\x90\\xe5\\xee\\xd4\\xc8rwj'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x461a9a2
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x461a9a2
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

###[ BT4LE ]### 
  access_addr= 0x461a9a2
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x461a9a2
  crc       = 0x2cd180
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xaac2b398a55ea432
           ivs       = 0x53472ec

ltk 409ef8da7e01c653586e1bc57b9c66ea
skd 0000000000000000f49ee1baaa4bec8f
sk 0294a4a0914d04e2b69e852f9c536a2d
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x461a9a2
  crc       = 0x3b6bec
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 151
###[ Raw ]### 
           load      = "\x1e'~\\x878\\xb8"

###[ BT4LE ]### 
  access_addr= 0x461a9a2
  crc       = 0x3b6bec
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 151
###[ Raw ]### 
           load      = "\x1e'~\\x878\\xb8"

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  d0:dc:b5:76:92:97
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0xd50fbe
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\\xd5\\xf6\\xd6'\x19\\xe2@_\\xd1\\xc6{\x1e@9\x05\\xb4"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0xae53dd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\x17\\xa0+<\\xe4\\xbb'\\x97Q\\xe6?\\xce\\xe9T\x08\x06"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd ba69f774afa9b7428bc57ea7a2e9b24b
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b753d8ba5be5ee54317177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0x46998c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7Sغ[\\xe5\\xeeT1qw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0x9433a5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 151
###[ Raw ]### 
           load      = "\x1f'\\xaa\\xcd1\\xe7"

###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0x9433a5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 151
###[ Raw ]### 
           load      = "\x1f'\\xaa\\xcd1\\xe7"

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0x736344
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x7961e9ee8540ab52
           ivs       = 0x3bb7d659

ltk ca48d1ffa27e249c0f419eec0be0a439
skd 000000000000000075d4e49d604adc66
sk 45e4ffdbb366d5b713a796467d233769
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0xf8092b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 105
###[ Raw ]### 
           load      = '\\xe1\\xe9\\xb6\x0f0U'

###[ BT4LE ]### 
  access_addr= 0x3200f0fa
  crc       = 0xf8092b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 105
###[ Raw ]### 
           load      = '\\xe1\\xe9\\xb6\x0f0U'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  9e:d4:0f:fc:ea:b3
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xe03ebf1
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xe03ebf1
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe03ebf1
  crc       = 0x5e3f1d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x82:T\x19\\x9d\\xd9!\\xa2\\xae\\xad\\xd4\x0ex*\\x8f7'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe03ebf1
  crc       = 0x49ba90
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1b\\xbf\x00\\xa8\x0c\\xc0\\xfd\\xc3\\xddʽP\\xf6Y\x14&'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xe03ebf1
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd cec5fd32b996dc5daeb652af5a7de0f4
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xe03ebf1
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe03ebf1
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xe03ebf1
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

###[ BT4LE ]### 
  access_addr= 0xe03ebf1
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe03ebf1
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xe03ebf1
  crc       = 0x9433a5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 151
###[ Raw ]### 
           load      = "\x1f'\\xaa\\xcd1\\xe7"

###[ BT4LE ]### 
  access_addr= 0xe03ebf1
  crc       = 0x9433a5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 151
###[ Raw ]### 
           load      = "\x1f'\\xaa\\xcd1\\xe7"

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a9:88:c9:d6:fa:24
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x287af0ee
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x287af0ee
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x287af0ee
  crc       = 0xe25491
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd7\\xefO\\x90\\x9e5I\\x87\x1c\\xe9;\\xd8c\\x955\\xae'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x287af0ee
  crc       = 0x8aa3e1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 't:\x0b\\x84\\x96\\xb0\x16\x0c[\\xbeַ`\x02\x14\\xfb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x287af0ee
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd bc68f6dee9fdecf02d5c0ef0c28a40fb
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb66a6b075b794bb53c5cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x287af0ee
  crc       = 0x854add
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebf\\xa6\\xb0u\\xb7\\x94\\xbbS\\xc5\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x287af0ee
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x287af0ee
  crc       = 0xf3192
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

###[ BT4LE ]### 
  access_addr= 0x287af0ee
  crc       = 0xf3192
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x287af0ee
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 971c26
dec_pkt 4264d4
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x287af0ee
  crc       = 0xb71895
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x8bceffbe1b20aed3
           ivs       = 0xb83a9473

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f95
dec_pkt 0791
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f8:12:dc:e5:ca:13
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf176a2ae
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf176a2ae
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf176a2ae
  crc       = 0x7689d3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb0\\xdcr,b\\xb3*\\xde\x0c\\xbe\x0e\\xe3{@\\xa9\\xf0'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf176a2ae
  crc       = 0xac9156
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8c\\xaf\\xb4E\\xfd|\\xdd\x0f\\xa1W\\xe9G\\xb6\\xd4K;'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf176a2ae
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 43cc6e954158cc9cadb599c48a99f038
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b72a6cdda9e5ee54317177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf176a2ae
  crc       = 0xf04e70
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7*lݩ\\xe5\\xeeT1qw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf176a2ae
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf176a2ae
  crc       = 0xf3192
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

###[ BT4LE ]### 
  access_addr= 0xf176a2ae
  crc       = 0xf3192
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf176a2ae
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 971c26
dec_pkt 4264d4
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  ae:44:e4:30:e5:02
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0xa4e7ad
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xaa\\xa3\\xf4\\xcc\x1f\x0e\\xd2\x06\\xbc^\\xe7\\xd7\\xd7\\xc1\\xee:'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0xec6e34
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '$\\x97\\xfcP\\xee\\xd1\x11\\xc0\\xce?8L\\xf6\x01\x06\\xf6'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 2b88e475b0a7b4c4159e2bd07821d4ca
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 1ea5b0e58f52d87290e5eed4c872776a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0x7b707b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x1e\\xa5\\xb0\\xe5\\x8fR\\xd8r\\x90\\xe5\\xee\\xd4\\xc8rwj'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0xb3ae5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 151
###[ Raw ]### 
           load      = '\x10&7\\x94\x1b\\x9f'

###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0xb3ae5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 151
###[ Raw ]### 
           load      = '\x10&7\\x94\x1b\\x9f'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0x3c4200
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc80c65c98c2e3d84
           ivs       = 0x8e0ca20a

ltk c0a6835ac343e31cea2aa39553f2ee1a
skd 00000000000000006e7c587a0948ed2d
sk 78830cae99dc15aa33ef6c977556208e
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0xf8092b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 105
###[ Raw ]### 
           load      = '\\xe1\\xe9\\xb6\x0f0U'

###[ BT4LE ]### 
  access_addr= 0xea08a4f0
  crc       = 0xf8092b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 105
###[ Raw ]### 
           load      = '\\xe1\\xe9\\xb6\x0f0U'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f8:00:1e:eb:d9:75
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x1239ce06
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x1239ce06
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1239ce06
  crc       = 0x18a4b7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc8\\xe2\\xd1ӏd\r\\xfe܌\\x87\\xb5\\xe8\x03j\\xff'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1239ce06
  crc       = 0xc30611
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa8[\\xe3^\x03\\xc1\\xd1B\\xeaT\\xe4 ?\\xb4\\x84M'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x1239ce06
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3a16d74762f6892ef6ab2057747a4139
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd bf78ad542e5e2b5723733ffa92b91ff9
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x1239ce06
  crc       = 0xc57aca
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xbfx\\xadT.^+W#s?\\xfa\\x92\\xb9\x1f\\xf9'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1239ce06
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x1239ce06
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

###[ BT4LE ]### 
  access_addr= 0x1239ce06
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1239ce06
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x1239ce06
  crc       = 0xb3ae5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 151
###[ Raw ]### 
           load      = '\x10&7\\x94\x1b\\x9f'

###[ BT4LE ]### 
  access_addr= 0x1239ce06
  crc       = 0xb3ae5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 151
###[ Raw ]### 
           load      = '\x10&7\\x94\x1b\\x9f'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  5d:08:7f:09:ee:a2
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0x2713c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf1\\xbcN@\\xc8)\x17Y?\\x91\x7fmvg\\xeb\x19'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0x85661b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'Ñh5\\xe2\\xe2\\xa4o\\x8a\x19V\\x94A\\x83\\x82\\xa5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 7a031cd3c33d601021800667a58b24c4
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2a6cdda915b6ee54bb3b55cade9d2ae1
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0xb889b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '*lݩ\x15\\xb6\\xeeT\\xbb;U\\xcaޝ*\\xe1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0x9d41f5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x378aef554d3057
           ivs       = 0xdb1a03ca

ltk cf98a30a83d79e3ad70b1c298ff17379
skd 0000000000000000f388b6e6eac5fd1d
sk 77178ff9b63630476a272e0f3920bd65
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0xed4b6e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

###[ BT4LE ]### 
  access_addr= 0x4b67bc24
  crc       = 0xed4b6e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  7c:ac:71:77:64:c5
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xc05eb49f
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xc05eb49f
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc05eb49f
  crc       = 0xcc8dfa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "j\\xf9NWt\\x9dȢ2e'b\x1b\\xb5h\\xff"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc05eb49f
  crc       = 0x35e579
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x80M\t@\\xb5zf\\xbce\\xd1\\xd2\\xdf|\\xe7n\x1e'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xc05eb49f
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 649bac3f210aa5f56001e812898f1853
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xc05eb49f
  crc       = 0xcd8f1f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xc05eb49f
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xc05eb49f
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

###[ BT4LE ]### 
  access_addr= 0xc05eb49f
  crc       = 0x443c96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc05eb49f
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xc05eb49f
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xc05eb49f
  crc       = 0xdbfa78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c3:7f:23:a3:2f:a0
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0x4c5bc0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '(\\xef\\x8aZ\\xed\\xbe\x0b4-϶\x1f;6_m'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0x3c6097
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'n4(\\x87\x03\\xb2\\x84â\\xc8zU\x0e\\x81\\x8f\\x9a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd f3810f7779c76bd0ffc6fecbc3336e13
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 5cbc56ae2e5e2b5792b91ff9c9dc8f7c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0xd22470
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\\\xbcV\\xae.^+W\\x92\\xb9\x1f\\xf9\\xc9\u070f|'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0xf3192
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0xf3192
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 235
###[ Raw ]### 
           load      = '\\xc6}U\\x9bR\\xfe'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0xc9c2b9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xe19f33d0b99b7f75
           ediv      = 0xe4f2
           skdm      = 0x5fcfe035b774c2fb
           ivm       = 0x34e17acd

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0xe677ce
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 72
###[ Raw ]### 
           load      = '\x07w\n\\xca)f\\xbbA4l#\x05\x10H\x01\\xdd'

###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0xe677ce
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 72
###[ Raw ]### 
           load      = '\x07w\n\\xca)f\\xbbA4l#\x05\x10H\x01\\xdd'

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0xcc04dc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 113
###[ Raw ]### 
           load      = '\\xcc\\xe5y\\xe2'

###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0xcc04dc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 113
###[ Raw ]### 
           load      = '\\xcc\\xe5y\\xe2'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0xc9c2b9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xe19f33d0b99b7f75
           ediv      = 0xe4f2
           skdm      = 0x5fcfe035b774c2fb
           ivm       = 0x34e17acd

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcafff51e
  crc       = 0x99c864
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x2c9352b2ba0bacc3
           ivs       = 0x3bff07a0

ltk 0e1aa598bc78481c8af9a74d9fcd71ab
skd c2ef8be8c2e0bfeef2fba658a1f8bfb8
sk 32b7c7220596561d42bdb6e7b15156a7
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  82:8c:08:18:c4:5d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0x577ae6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xe2\r[\\x87\\xd1qNۮ;\\xf0\\xb5Y\\xb9\\xe2\\xc4'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0x7826c5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\\xee?\x10\\xb9w'\\xd4B\\xfa\\xba\x1d\\xa7x\\xf2\\xe1{"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd a7883e81660df01bc85bb6c9d04b3219
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cd4b61eb6694bb53c5cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0xb15686
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6\\xcdKa\\xebf\\x94\\xbbS\\xc5\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0xcd3f85
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 193
###[ Raw ]### 
           load      = '\\xa9\\xa5\x7fJ\\xb4\\xc0'

###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0xcd3f85
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 193
###[ Raw ]### 
           load      = '\\xa9\\xa5\x7fJ\\xb4\\xc0'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0xf5c061
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xf90a49b49dc9f288
           ediv      = 0xc8ad
           skdm      = 0x5af1a435d79bd4e5
           ivm       = 0xde9983f4

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0x8e6cfe
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 73
###[ Raw ]### 
           load      = 'b\\\\xee\\xc5\x03\\xff#\\xd3i\\xb1\\xd4\\xf3\x1fXx\\x97'

###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0x8e6cfe
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 73
###[ Raw ]### 
           load      = 'b\\\\xee\\xc5\x03\\xff#\\xd3i\\xb1\\xd4\\xf3\x1fXx\\x97'

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0xe57040
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 30
###[ Raw ]### 
           load      = '\\xf1\x1dl\\x95'

###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0xe57040
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 30
###[ Raw ]### 
           load      = '\\xf1\x1dl\\x95'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4d107c48
  crc       = 0xf5c061
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xf90a49b49dc9f288
           ediv      = 0xc8ad
           skdm      = 0x5af1a435d79bd4e5
           ivm       = 0xde9983f4

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a6:9c:1c:cd:9b:b4
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0x31eb73
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x9c\\xd1\\xc9-{=\\xf5\\xbc\\xe4\\x98Z\\x97\\xe8\x19\\xc8\\xe2'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0xcba7a3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1c\\xf4t\\xb4#8\\x8c_\\xaa\x7f\x07v\\xbf!\x1b\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 6721579f265dba0cc50d5c9843caa5bb
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0x5a7608
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 102
###[ Raw ]### 
           load      = '\\xcam\\xc6{N$'

###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0x5a7608
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 102
###[ Raw ]### 
           load      = '\\xcam\\xc6{N$'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0x6a06a3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xebb0ae786a0ba2fc
           ediv      = 0x2f6d
           skdm      = 0xc343542d3a5775e5
           ivm       = 0xbf3a2ea3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0x7752a4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 204
###[ Raw ]### 
           load      = "\\xa0\\xb1\\xf9\\xc1'R\x10\x12g.P.\\xeb\rSL"

###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0x7752a4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 204
###[ Raw ]### 
           load      = "\\xa0\\xb1\\xf9\\xc1'R\x10\x12g.P.\\xeb\rSL"

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0x5197a9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 79
###[ Raw ]### 
           load      = '\\xd6V\\xbb-'

###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0x5197a9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 79
###[ Raw ]### 
           load      = '\\xd6V\\xbb-'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0x1bfb74
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa9da9748a4626dbd
           ivs       = 0x25030a7c

ltk ba1c2aaec3dde44c6e3787d33005fa4d
skd beaf5405bf42bff5ece62ff130bd4785
sk 5e15bd4091512ca755586249a2b97a53
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xaef7c346
  crc       = 0x1bfb74
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa9da9748a4626dbd
           ivs       = 0x25030a7c

ltk ba1c2aaec3dde44c6e3787d33005fa4d
skd beaf5405bf42bff57841a28d475b8d3b
sk be9b13aca937c1990652bd078ece8b2c
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a0:69:2f:46:ef:3f
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0xb5fe04
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xaa{Q\\x8c\\x8e\x1eʞ{\\xc0m?\\xed=\x01\\xe9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0x1b52d5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x11\\xfc<\\xb1_\\x85A\x06\\x97\\xfc2\x1b\\x9d\\xd5\\xce\\xee'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 851d28f1584ce48ce864c18f54049757
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b753d8ba5be5ee54317177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0x46998c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7Sغ[\\xe5\\xeeT1qw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0xbaaffb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 163
###[ Raw ]### 
           load      = 'Ҏ\\x8dN\\x9c\x1a'

###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0xbaaffb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 163
###[ Raw ]### 
           load      = 'Ҏ\\x8dN\\x9c\x1a'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0xbbcd49
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xd5ff6a79f833ed9f
           ediv      = 0xc75f
           skdm      = 0x7673ad141aab0140
           ivm       = 0x449495c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0x39bd49
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 69
###[ Raw ]### 
           load      = 'ϱ\x1a&\\xb4\x00\\xc1\\x99\x1dsc\\xca \\x83\\xcd\x0e'

###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0x39bd49
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 69
###[ Raw ]### 
           load      = 'ϱ\x1a&\\xb4\x00\\xc1\\x99\x1dsc\\xca \\x83\\xcd\x0e'

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0xc78894
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 245
###[ Raw ]### 
           load      = '\\xdf-\\xa5,'

###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0xc78894
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 245
###[ Raw ]### 
           load      = '\\xdf-\\xa5,'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x603f8e6d
  crc       = 0xdb6742
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x7637ac5473e4d2ae
           ivs       = 0xad2c5f72

ltk 9d2929af69df6d97c9f8f18dc936d06f
skd 46cc9ebf8f9c446851c5b944e8f13fd2
sk df58f3fa93abf1d8bd7bfe191b1422e5
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  23:95:50:0f:cd:61
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0x9b8036
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc5\\xd3ǘ.\\xc9\rO\\xa4\\xb5\\xc2\\xff\x15X\\x8fX'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0xf755f5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd8cW+皁ٜ\x16Yyk˛\\xf3'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 71259280092418e63a5a77c84497ad37
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0x77130c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0x23a37c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 130
###[ Raw ]### 
           load      = 'ԖP\\xe2\\xb0P'

###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0x23a37c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 130
###[ Raw ]### 
           load      = 'ԖP\\xe2\\xb0P'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0xcb0786
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xdc8ea04e7e9279db
           ediv      = 0x574
           skdm      = 0x80ca1f55cf34d37c
           ivm       = 0x5893cb54

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0x2e426c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 159
###[ Raw ]### 
           load      = '\x1dn\\xddA\\xb3-\\xceF\x17\x06\x06>\\xd8{\\x9f\\xfb'

###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0x2e426c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 159
###[ Raw ]### 
           load      = '\x1dn\\xddA\\xb3-\\xceF\x17\x06\x06>\\xd8{\\x9f\\xfb'

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0x90149c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 34
###[ Raw ]### 
           load      = '\\xba\\x8e\x01\\x9c'

###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0x90149c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 34
###[ Raw ]### 
           load      = '\\xba\\x8e\x01\\x9c'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xedc5394f
  crc       = 0xfedf20
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x20652c271fa80de9
           ivs       = 0xa1af66be

ltk 8f3c36d3ac9618bf1345f518f7c60b1d
skd f520dce68e478b98f6a182148c30ae3b
sk 4f6fb18113d06d3816b069614895b220
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  36:53:fe:f8:ea:bf
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0x6cb00e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'ɏN3\\xcc\\xc1`\\xac"9\\xa8\\xab\\x90\\xf0\\xa6\\xbe'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0xa4e07e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xfe\\x95\\xf3\\xdd\\xe2\x1c\\xd6\\xd89T\\x8ai\\xb6\\xb5\x7fH'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 57c3c471f14892313aa58104490b7b17
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0xde5196
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 72
###[ Raw ]### 
           load      = 'V%\\xee\x16\\xf9\\x88'

###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0xde5196
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 72
###[ Raw ]### 
           load      = 'V%\\xee\x16\\xf9\\x88'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0xdaa4a0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x9f89e3ebfc20f9a0
           ediv      = 0xb91c
           skdm      = 0x1a0051159d3498e5
           ivm       = 0x44edf00f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0x1f75f3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 231
###[ Raw ]### 
           load      = '\x03\\x86̫YH4\\x9dU=\\xc54\\xd3h\\xc1\\xf8'

###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0x1f75f3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 231
###[ Raw ]### 
           load      = '\x03\\x86̫YH4\\x9dU=\\xc54\\xd3h\\xc1\\xf8'

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0x163495
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 63
###[ Raw ]### 
           load      = '\x0c\\xf4\x1eO'

###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0x163495
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 63
###[ Raw ]### 
           load      = '\x0c\\xf4\x1eO'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe865d1f7
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  be:77:78:ec:b5:76
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0xcf8d76
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'b\\xe3g}U\\xca\\xe5q\\x8d=>\x14땳\\xc3'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0xdbd684
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf3\\xd6Ϧ\\xcc\\xc5\\xee+\\xa2*\x14\\xa1\x11\x17\\x89\n'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd d833fa4dbcd37c551ddb239265483851
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 53d8ba5b2a6cdda97177aa9cbb3b55ca
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0xd69c24
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Sغ[*lݩqw\\xaa\\x9c\\xbb;U\\xca'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0xf332e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 113
###[ Raw ]### 
           load      = '\\xb5!\\xc8\\xd8"\\xa8'

###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0xf332e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 113
###[ Raw ]### 
           load      = '\\xb5!\\xc8\\xd8"\\xa8'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0x5e652e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x6428f57a27568ac
           ediv      = 0x36c4
           skdm      = 0x6fabc2c7b8203a28
           ivm       = 0x1dcc9dc5

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0xa2bc00
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 88
###[ Raw ]### 
           load      = '\\x9a\\xbe\x01\\xb2\\xf1\\xa3\x1eD\\xefX\x02\\xf3\\x9f\\xbe\x17P'

###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0xa2bc00
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 88
###[ Raw ]### 
           load      = '\\x9a\\xbe\x01\\xb2\\xf1\\xa3\x1eD\\xefX\x02\\xf3\\x9f\\xbe\x17P'

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0xd1e075
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 202
###[ Raw ]### 
           load      = 'Ž\\xc6\\xcf'

###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0xd1e075
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 202
###[ Raw ]### 
           load      = 'Ž\\xc6\\xcf'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x31990ff7
  crc       = 0xd1600b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x6c76ba1aad87f0f1
           ivs       = 0x99025a49

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  fb:13:0a:c4:64:78
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0xe8e6dc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\tv/\\x93\u07bc"\\xde^\\xdfmV=E\\xb0\x02'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0x9b1b57
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'A0l\\xda$(\x00\x178暠\\x81\tO\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c067ba153569036a483e8d33105ddb43
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0xc88e6a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 153
###[ Raw ]### 
           load      = '\x11<\\x83\\xa6\x03]'

###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0xc88e6a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 153
###[ Raw ]### 
           load      = '\x11<\\x83\\xa6\x03]'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0x5d4a23
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb7572e00620416d7
           ediv      = 0x539f
           skdm      = 0x195508741673e604
           ivm       = 0x450a50db

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0xd430fa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_IND
###[ LL_REJECT_IND ]### 
           code      = 0x7d
###[ Raw ]### 
              load      = '\\xb5b3>\x1b\\xb8\\xbat\\xd8\\xffo-\\xd4p\\xc9'

###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0xd430fa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_IND
###[ LL_REJECT_IND ]### 
           code      = 0x7d
###[ Raw ]### 
              load      = '\\xb5b3>\x1b\\xb8\\xbat\\xd8\\xffo-\\xd4p\\xc9'

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0xa4783c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 52
###[ Raw ]### 
           load      = '\\xde&\\xc0\x7f'

###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0xa4783c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 52
###[ Raw ]### 
           load      = '\\xde&\\xc0\x7f'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf8e48d40
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  3d:e8:8d:34:bf:69
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0x71494b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'iq\\xda\x07\\x84\\xee\\x8d\\xe5\\xb5I\\xc8\\xfdZ\\xcc\\xc7;'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0x85160f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '>\\x9f\\xa4y"G\\xa2\\xd1½o\\xa2z2s\\xf8'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd ba0e950107845e9f446fecc83bf9ec5c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd d6ca515a6be5282df52359d6f9912cef
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0x98a442
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xd6\\xcaQZk\\xe5(-\\xf5#Y\\xd6\\xf9\\x91,\\xef'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0xe616cc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 253
###[ Raw ]### 
           load      = '"\x0c\\xa7\\xf8\\x93\\xac'

###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0xe616cc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = 253
###[ Raw ]### 
           load      = '"\x0c\\xa7\\xf8\\x93\\xac'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0xbad79b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x8f6d97ae6863415f
           ediv      = 0x9c04
           skdm      = 0xf582569824778df8
           ivm       = 0xf7be2a8b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_PHY_RSP / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0x7f5a49
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 64
###[ Raw ]### 
           load      = '\\xd31D\\x9bEpd9,\\xd8\\xea\\xa8<\\xd1b\\xe9'

###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0x7f5a49
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 64
###[ Raw ]### 
           load      = '\\xd31D\\x9bEpd9,\\xd8\\xea\\xa8<\\xd1b\\xe9'

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0xe0c469
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = LL_PHY_RSP
###[ LL_PHY_RSP ]### 
           tx_phys   = ?+?
           rx_phys   = phy_coded+?+?+?
###[ Raw ]### 
              load      = '\x06\t'

###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0xe0c469
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = LL_PHY_RSP
###[ LL_PHY_RSP ]### 
           tx_phys   = ?+?
           rx_phys   = phy_coded+?+?+?
###[ Raw ]### 
              load      = '\x06\t'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_PHY_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x27fd1af7
  crc       = 0x606671
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x59c0c32d4510289d
           ivs       = 0x656a9827

ltk 26e8b3f41f554f8f279b3032b9a893ce
skd 9c8adeb2dc490e00abb09fed0c8e6ea4
sk d32e089b0abb4a28b788e0b5896ba56a
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  3c:cb:22:d8:71:ea
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0xa82fdd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa3\\xe5\\xa8\\f\\x82B\\xd0V\\xb9u\\xd6\\xc0X\x00O'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0x5f4295
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xceڇ\\xb8\\xb1\x0c\\xa09\\xaf\\xb5\\xe2\x01\\xd0O\\xb1\\x9a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e044dc7e5b9d7a464de7e231014c90c9
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 94a31456e528851546b2dc4d922c7797
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0x3b043a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x94\\xa3\x14V\\xe5(\\x85\x15F\\xb2\\xdcM\\x92,w\\x97'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0xcfc17c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_FEATURE_REQ
###[ Raw ]### 
           load      = '(\x1f\\x99s\\xb3\\x98'

###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0xcfc17c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_FEATURE_REQ
###[ Raw ]### 
           load      = '(\x1f\\x99s\\xb3\\x98'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0xd15e85
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x20faf32801fd9226
           ediv      = 0x3099
           skdm      = 0x5f9fc1e1f0070792
           ivm       = 0x8ee1cbc6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0x17a2b1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 172
###[ Raw ]### 
           load      = 'e\\x84f3\\xbad{\x02\\x9b+3cwL\\xf8\\xe9'

###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0x17a2b1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 17
###[ BTLE_CTRL ]### 
        opcode    = 172
###[ Raw ]### 
           load      = 'e\\x84f3\\xbad{\x02\\x9b+3cwL\\xf8\\xe9'

--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0x7172df
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 134
###[ Raw ]### 
           load      = '\\xb7\\xf8\\xb6\\x9f'

###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0x7172df
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 5
###[ BTLE_CTRL ]### 
        opcode    = 134
###[ Raw ]### 
           load      = '\\xb7\\xf8\\xb6\\x9f'

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xad37b8d9
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  59:ab:87:1e:d6:6c
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x9fe41819
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x9fe41819
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9fe41819
  crc       = 0xe7a1b3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xdb"A\\xb8\\xac\\xd0\\xca\x03\\xe0\\x86\x10H3\\x8d\\xc1\\x83'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9fe41819
  crc       = 0xd40436
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'ݓ(e\\x8b\x07R\\x9aa8\x19!\\xff\\xb5\tX'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x9fe41819
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd ddb5e279720bb82c68279c0cef4bbef2
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x9fe41819
  crc       = 0x836528
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9fe41819
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9fe41819
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x9fe41819
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9fe41819
  crc       = 0xafed31
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xab8692bf2d6c4d2c
           ediv      = 0x7d80
           skdm      = 0xecb17a4170a97304
           ivm       = 0xbb9d9a5b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9fe41819
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8406
dec_pkt fc02
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9fe41819
  crc       = 0x2e7ee8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9c5e5b672931af14
           ivs       = 0xcde59525

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c7:91:92:a4:1d:58
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x2af59f75
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x2af59f75
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x2af59f75
  crc       = 0x63a3a0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '[8\x14\x1e\\xce`&\\xd2,\\xa8x\\xfc\x0c[\x08`'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x2af59f75
  crc       = 0xb5bb44
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb5&>\\xa4\\xc2car\\x9a\\x9a\\xc9\\xee1J\\x81F'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x2af59f75
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 6f14f59f73a1e6386c0d47ce655fac2c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb66a6b075b7cadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x2af59f75
  crc       = 0xaa8122
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebf\\xa6\\xb0u\\xb7\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x2af59f75
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2af59f75
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x2af59f75
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x2af59f75
  crc       = 0x5c5ead
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x746a413dd9c4d080
           ediv      = 0x8f44
           skdm      = 0xf308cb96d29845d
           ivm       = 0x5e2b4c68

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x2af59f75
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8406
dec_pkt fc02
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  99:7a:2a:13:1c:60
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xc7217f6b
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xc7217f6b
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc7217f6b
  crc       = 0x37b541
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb1\\xbd\\xadA\\xd4N6\\x95W\\xd9)\\x81\\xa8%\\xa3\\xc9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc7217f6b
  crc       = 0x1a2217
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa6OW\\xe0\\xb9\\xd3Z\\x9d\\x9a\x0b\x1e2VRvh'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xc7217f6b
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 9b05bd54409cd230a228c4076a1aa347
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 3b4a61c31ea5b0e527cbdda190e5eed4
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xc7217f6b
  crc       = 0xe6f656
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ";Ja\\xc3\x1e\\xa5\\xb0\\xe5'\\xcbݡ\\x90\\xe5\\xee\\xd4"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xc7217f6b
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xc7217f6b
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xc7217f6b
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc7217f6b
  crc       = 0xc93765
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x52f3fe48d9b799cf
           ivs       = 0xb95e1e4b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xc7217f6b
  crc       = 0xb61a38
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xa29897828c3b8e49
           ediv      = 0x1dca
           skdm      = 0x7d3014a7a9c169cf
           ivm       = 0xa46b773b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840e
dec_pkt fc0a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc7217f6b
  crc       = 0xc93765
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x52f3fe48d9b799cf
           ivs       = 0xb95e1e4b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  cc:e3:53:96:5f:c4
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xeb78c1af
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xeb78c1af
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xeb78c1af
  crc       = 0xa9a6f1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '$\\xa4:\\xcf%u\x19\\xdf\\xd2,\\x8f\\xfedj\\xe8w'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xeb78c1af
  crc       = 0xf545c6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '/\\x92\\xbf\n\x12\\xad\\x848\\x89\\xe9\\xa0\x04\\x9e\\xc3vg'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xeb78c1af
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e3b4b3916c98ebefe070e6aa16a42b74
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 6cddd90eb6ee6c073955e2e24c95b8fe
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xeb78c1af
  crc       = 0x92a461
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'l\\xdd\\xd9\x0e\\xb6\\xeel\x079U\\xe2\\xe2L\\x95\\xb8\\xfe'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xeb78c1af
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xeb78c1af
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xeb78c1af
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xeb78c1af
  crc       = 0xa76806
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xac05a609a65f73db
           ivs       = 0x52c99de0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xeb78c1af
  crc       = 0x81c3fc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x8a7841093f6e720a
           ediv      = 0x1db0
           skdm      = 0x45b78c4a8abcf92c
           ivm       = 0x853c3aa9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840e
dec_pkt fc0a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  8f:f7:95:17:4e:1d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xbc30f930
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xbc30f930
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xbc30f930
  crc       = 0x93735e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'h]\\xefK\\xc9\x0c\\xfb\x01*\\x91\\xee\x00\\x94\\xb0\\xba\x0c'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xbc30f930
  crc       = 0xb8332e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa0\\xd6\to\x16?\x1eS\\xbd\x12\x1e"\\x85@\r^'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xbc30f930
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd b9079716f5ea30c61b7f2a0b4b9daf18
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 53d8ba5b2a6cdda9e5ee5431bb3b55ca
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xbc30f930
  crc       = 0xa71c6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Sغ[*lݩ\\xe5\\xeeT1\\xbb;U\\xca'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xbc30f930
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xbc30f930
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xbc30f930
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbc30f930
  crc       = 0x8dbd63
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x40bf0acf9d5f25a1
           ivs       = 0xb862b24d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbc30f930
  crc       = 0x8dbd63
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x40bf0acf9d5f25a1
           ivs       = 0xb862b24d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbc30f930
  crc       = 0x8dbd63
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x40bf0acf9d5f25a1
           ivs       = 0xb862b24d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  7a:bc:32:a4:25:8b
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x723b3050
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x723b3050
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x723b3050
  crc       = 0x7e9020
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "'\\xa7u\\x90m\\xbf\\xbf\\xb3墓;\\x8av@\x13"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x723b3050
  crc       = 0xb8c85a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xbe\\xb7\\x8f yL¨\x05N}\\xbeM\x1do\\xd5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x723b3050
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 0b723ff9e443bf45cfbfa3e357e161dc
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb66a6b075b7cadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x723b3050
  crc       = 0x9d042e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebf\\xa6\\xb0u\\xb7\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x723b3050
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x723b3050
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x723b3050
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x723b3050
  crc       = 0xeaa684
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xfb4fa439fbff03ba
           ivs       = 0x66931712

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x723b3050
  crc       = 0xeaa684
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xfb4fa439fbff03ba
           ivs       = 0x66931712

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  02:69:48:16:74:fc
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x7785893a
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x7785893a
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7785893a
  crc       = 0x789381
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'Ѝk\\xb3ɴ$\\xe6\\xa4WP\x00d\\xdf&W'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7785893a
  crc       = 0x63ca6f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf9\\xdcT\x07\\x88\\xa6\\xfb\rZ\\xbe\\xcaA|*\x16\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x7785893a
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd b43856606bffe2b1ffebb6990b98e2a8
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd c0d69ded60ebce76ba53255edda9122f
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x7785893a
  crc       = 0xba149f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xc0֝\\xed`\\xeb\\xcev\\xbaS%^ݩ\x12/'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7785893a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x7785893a
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x7785893a
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7785893a
  crc       = 0x4cbcc4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc9697b1aa9e46c88
           ivs       = 0xfbbd6447

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7785893a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7785893a
  crc       = 0x4cbcc4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc9697b1aa9e46c88
           ivs       = 0xfbbd6447

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a1:ef:5c:e4:c2:01
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xd75ec06f
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xd75ec06f
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd75ec06f
  crc       = 0xde51f7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\\\x83\\xf9K\\xc0\\xb4\x01M\\xa7i\\xa4\x14q\x7f\\xb6o'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd75ec06f
  crc       = 0x9443db
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x13\\xef3\\xc8\\xc5:\x07*\\x8fp\\xf2-\x17\x08\\x82\x1f'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xd75ec06f
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 451911995d6d57891ca4428a01608ec4
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cd4b61eb6694bb53c5cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xd75ec06f
  crc       = 0xb15686
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6\\xcdKa\\xebf\\x94\\xbbS\\xc5\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd75ec06f
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd75ec06f
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xd75ec06f
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd75ec06f
  crc       = 0x2c7113
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x854118bae1f0852e
           ivs       = 0x23c6b73a

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd75ec06f
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c9:35:f1:fe:9a:5a
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xeb79a772
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xeb79a772
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xeb79a772
  crc       = 0xb40461
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'k\\xd6\x02[-6^\\xc8ϡ)X\\xe8\\xbepf'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xeb79a772
  crc       = 0x5e8c1e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '1wGĞ\\xfe\\xc7\x04.\x05F\\xa4\\xeb\\xbd>y'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xeb79a772
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3b42199b5467811f8b46586808a7d9d9
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 1ea5b0e58f52d87290e5eed4c872776a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xeb79a772
  crc       = 0x4cf577
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x1e\\xa5\\xb0\\xe5\\x8fR\\xd8r\\x90\\xe5\\xee\\xd4\\xc8rwj'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xeb79a772
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xeb79a772
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xeb79a772
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xeb79a772
  crc       = 0xd9aaff
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf8ca4615797b8307
           ivs       = 0xd981157c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xeb79a772
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xeb79a772
  crc       = 0xd9aaff
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf8ca4615797b8307
           ivs       = 0xd981157c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  b7:16:dc:82:af:33
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xfd8d8164
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xfd8d8164
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfd8d8164
  crc       = 0x9c2c30
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xeeCcl\\x8bm\\xaf\x1fȐ\x7f\x1b\\x9d\x7fq\\xb7'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfd8d8164
  crc       = 0xbdf00
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '!\\x8a+@\\xde\\xec\\xce4,\\xd5\\xf0|2L\\xe8Y'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xfd8d8164
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 2b8a740d956b9050fa887beed148cc00
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd b075673bd8bab31ded54899375aac4cd
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xfd8d8164
  crc       = 0x56527
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xb0ug;غ\\xb3\x1d\\xedT\\x89\\x93u\\xaa\\xc4\\xcd'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfd8d8164
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xfd8d8164
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xfd8d8164
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfd8d8164
  crc       = 0x4a2e3b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x86a20b5585458d71
           ivs       = 0xb10c9e21

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfd8d8164
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  82:3e:b5:08:99:fa
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x24feebb9
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x24feebb9
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x24feebb9
  crc       = 0x8f919a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf0`\u05ff\\x97\\xcex\x18 $\x1c\\xee!%\\x96r'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x24feebb9
  crc       = 0x526d90
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb5;W1\\xfbؒ[\\x8f,\\xa6\x11\\xf4\\xd2$G'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x24feebb9
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd f72cde36c6fc08fef05cfe9c1fae5c2d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b753d8ba5bcadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x24feebb9
  crc       = 0xaaa62
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7Sغ[\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x24feebb9
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x24feebb9
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x24feebb9
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x24feebb9
  crc       = 0x6269f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x3d9ce28042d2da82
           ivs       = 0xd1b1e847

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x24feebb9
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8407
dec_pkt fc03
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x24feebb9
  crc       = 0x6269f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x3d9ce28042d2da82
           ivs       = 0xd1b1e847

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  cd:38:d4:9e:04:ee
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x69b5550b
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x69b5550b
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x69b5550b
  crc       = 0x50ab27
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '+|G|\t\\xb9⚤]{\\x96\\xe1iW>'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x69b5550b
  crc       = 0xacdfbc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf1OT\\xe0ي\\xfev\\xeb\\xca3\\xc12\\x97\x15A'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x69b5550b
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd f3a41f2c7c13f4bb10966b784cbb6e66
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x69b5550b
  crc       = 0x836528
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x69b5550b
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x69b5550b
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x69b5550b
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x69b5550b
  crc       = 0x959044
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4f52289414759a5d
           ivs       = 0x8474f118

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x69b5550b
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8407
dec_pkt fc03
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  ce:f6:23:dc:bf:ea
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x604698bd
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x604698bd
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x604698bd
  crc       = 0x64368f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'lnJ\\xc4\x05\x1f\\xb7\\xcae\\xef\\x9fa\\xb2\\x89\x14\x10'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x604698bd
  crc       = 0xd8c949
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x11\\x90\\xf5\\xd0p\x0fs|#\\xd9L[\\xafN\\x91\\xb8'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x604698bd
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd d96c0b15cfd9484154e11374334abc49
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 7194c28e3b4a61c34996bb4b27cbdda1
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x604698bd
  crc       = 0xdfdcbf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = "q\\x94\x8e;Ja\\xc3I\\x96\\xbbK'\\xcbݡ"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x604698bd
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x604698bd
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x604698bd
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x604698bd
  crc       = 0x7cb8ed
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x120d5205f2c01182
           ivs       = 0x7065fa62

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x604698bd
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8406
dec_pkt fc02
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x604698bd
  crc       = 0x7cb8ed
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x120d5205f2c01182
           ivs       = 0x7065fa62

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  1d:6d:ae:e5:be:56
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x8b8fdf8f
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x8b8fdf8f
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x8b8fdf8f
  crc       = 0x2355f1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "45X\\xae?J\\xe7=\x12S\\xb0\\xbc'\\xb1Ɍ"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x8b8fdf8f
  crc       = 0x34ebdf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x01\x12\n\\xd6R0;Ľ\x15\\xde(\x02\\xea\\xb1\\xe2'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x8b8fdf8f
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd a9bb9d91213229d8663b3c92d1954c8f
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd59ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x8b8fdf8f
  crc       = 0x360915
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcdY\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x8b8fdf8f
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8b8fdf8f
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x8b8fdf8f
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x8b8fdf8f
  crc       = 0x93e70d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xabd9c505fac3619e
           ivs       = 0xe1543371

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x8b8fdf8f
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8406
dec_pkt fc02
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
Hypothesis 1: 5 states.
-----------------Pre Start-----------------
Master Address:  70:42:71:d1:15:5e
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x4c48dd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xdeI\\xc2\\xe7\\xceIVM\\xae\\xeb)=\\xd9FIn'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x8bbf7f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "$\x19!\\xa7\x7f\\xbf}\\xca\\xd0_ւ\\x9b\r\\xb4'"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 20d052fe89c26e532af1be23a431f72b
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 87ad3bd3c0d69ded74a74abcba53255e
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x6bd425
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x87\\xad;\\xd3\\xc0֝\\xedt\\xa7J\\xbc\\xbaS%^'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x76564c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0xb
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0xfaf900
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0x7c2027
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x817337e1cf1a7d96
           ivs       = 0x8f411e41

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0xcfc100
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xae

###[ BT4LE ]### 
  access_addr= 0xa5ff00b6
  crc       = 0xcfc100
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xae

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
----------------step int find_cex----------------
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  98:3c:8e:c3:8d:ad
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x94bf9d95
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x94bf9d95
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x94bf9d95
  crc       = 0x5dde69
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xbc\\xad>1M[\x03`\x05U\\x84ߟ\x1an\x10'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x94bf9d95
  crc       = 0x166fed
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'm\\xb8\\x97\\x88\\xfeeFj\x02\x1b\\xa8\\xd2\\xf2\\xe2\\xb0z'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x94bf9d95
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd f05da59a11277eff7985787f550c5946
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb66a6b075b7cadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x94bf9d95
  crc       = 0x9d042e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebf\\xa6\\xb0u\\xb7\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x94bf9d95
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x94bf9d95
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x94bf9d95
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x94bf9d95
  crc       = 0xb6765d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x2a322161ad467759
           ediv      = 0x7972
           skdm      = 0xfffa1ca61a231fa1
           ivm       = 0x7d804cfc

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x94bf9d95
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  84:6c:d1:ac:28:04
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x442342ac
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x442342ac
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x442342ac
  crc       = 0xd89380
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'U:^\\x80\\x81/4\n\\xcc\\xd3\x19]Ҹ\\xb4\\x99'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x442342ac
  crc       = 0x377d26
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'y#_<9\x13\\xd2f\\xd6\\xde٧)\\x9agi'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x442342ac
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 017c5d52c77e4cd26503ed434defda16
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x442342ac
  crc       = 0x77130c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x442342ac
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x442342ac
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x442342ac
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x442342ac
  crc       = 0x2dc8f1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x4443bcb562748e2a
           ediv      = 0xb361
           skdm      = 0xd5d0e9476c1234d3
           ivm       = 0x501c6722

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x442342ac
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
Counterexample found:  ('ll_start_enc_req_pkt', 'll_enc_req_pkt', 'll_start_enc_req_pkt')
Counterexample ('ll_start_enc_req_pkt', 'll_enc_req_pkt', 'll_start_enc_req_pkt')
-----------------Pre Start-----------------
Master Address:  03:a0:2d:7b:1b:48
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa6839511
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa6839511
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa6839511
  crc       = 0x945a5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "DE\\xf9\\xba\\xdcU'\\xe2v5ʋ\\x88\\xbe(Q"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa6839511
  crc       = 0x50a0ee
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc3_\\xa4\\xfaѾ*+\\x92\\x8a4\\x8a\\xfe\\xcb\\xc5l'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa6839511
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 9ef9b11de01f725bf613ce11958c675d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 5b77b603ae3bdb854c95b8fea64a5c7f
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa6839511
  crc       = 0x3e1fb2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '[w\\xb6\x03\\xae;ۅL\\x95\\xb8\\xfe\\xa6J\\\x7f'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa6839511
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa6839511
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xa6839511
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa6839511
  crc       = 0x1c2826
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x68e451dacb26da75
           ediv      = 0x93e9
           skdm      = 0xfc949e0175982d52
           ivm       = 0x6ca476be

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa6839511
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  23:7f:f8:c7:e5:ce
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x22460681
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x22460681
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x22460681
  crc       = 0x8d8484
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x81\\xcf\x0c\\x85#>\x04u\\x90x\\xf4\\xa9nn4\\x97'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x22460681
  crc       = 0x2a4fff
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa1\\xf0\\xe1\\xd1\\xf2\\xdcz\\xe2lMZlU\\xc2\x03\x13'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x22460681
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 4964d6141fd7a39ea1e7dbb5a4364f03
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd bf78ad542e5e2b5723733ffac9dc8f7c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x22460681
  crc       = 0x40606
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xbfx\\xadT.^+W#s?\\xfa\\xc9\u070f|'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x22460681
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x22460681
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x22460681
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x22460681
  crc       = 0xe1db94
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xa8e518a3b8fac69
           ediv      = 0x1273
           skdm      = 0xe5226cc20cf70a8
           ivm       = 0x392e6e75

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x22460681
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a7:97:14:16:ee:6c
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x35868f44
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x35868f44
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x35868f44
  crc       = 0xb446eb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x98}\\xe2\x08A\x06-\x10"\x07h)\\xb3!p\\xb3'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x35868f44
  crc       = 0x5c4ed6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xcd\\\\xea\\xc5\\xc8\x04\\xb1\\xaa\x18\\x87\x16nd\\xfdQ\\xf6'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x35868f44
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 87d8e80e8656edf5023aad6a816507a3
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 44296cbda214b65e64b93b35b2dc9d1a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x35868f44
  crc       = 0xcaab69
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'D)l\\xbd\\xa2\x14\\xb6^d\\xb9;5\\xb2ܝ\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x35868f44
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x35868f44
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x35868f44
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x35868f44
  crc       = 0xfb5791
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xc981d49fb9adee1f
           ediv      = 0x6a14
           skdm      = 0xa34c8e637aec43cc
           ivm       = 0x1c82571d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x35868f44
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  7c:78:6a:1f:65:8c
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa2118fd2
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa2118fd2
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa2118fd2
  crc       = 0xf28964
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x94n\\xfb\\x9e\\xe0\\xbf\x15\\x9ez\\x96\x0fZ\x19\\xeeA='

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa2118fd2
  crc       = 0x16bbdf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '?|\\xa4\\xb1\x18C\\xe1\\xe2\\xb5潝\\x87\\xa2\\xff\\xcd'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa2118fd2
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 28ccf15877c9dab6868da42a66869fa2
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 15b6ee5487ad3bd3de9d2ae1ef4e9570
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa2118fd2
  crc       = 0x671ea6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x15\\xb6\\xeeT\\x87\\xad;\\xd3ޝ*\\xe1\\xefN\\x95p'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa2118fd2
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa2118fd2
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xa2118fd2
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa2118fd2
  crc       = 0xd4fbc5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x43165d34ff189673
           ediv      = 0x8868
           skdm      = 0x220cd787d1fbe4b4
           ivm       = 0x98a5e0db

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa2118fd2
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f5:b3:1d:44:8d:52
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4bf40f89
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4bf40f89
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4bf40f89
  crc       = 0x44fa86
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf4M\\xf6\\xcbDAR\\xae\\xab\r/\\xdc(\\x8a7\\xbc'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4bf40f89
  crc       = 0xc15c12
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc0w\\xd2\\xf3\\x97\\xb0\x12!\\xe4憮y\\x96\x04\\xdb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4bf40f89
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd d576e3f0e5d4fe2f5bab2f71ade4ee13
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4bf40f89
  crc       = 0x77130c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4bf40f89
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4bf40f89
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4bf40f89
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4bf40f89
  crc       = 0x4c7a84
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xda8577cd4e429c2d
           ediv      = 0xf080
           skdm      = 0xcd242cc8385f278d
           ivm       = 0x278d2f32

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4bf40f89
  crc       = 0x3a786b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x35cdc9e23ac108f6
           ivs       = 0x13cdb100

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  76:d7:a6:e2:42:38
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4a1f7151
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4a1f7151
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4a1f7151
  crc       = 0x2096ae
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xfa\x05]\\xf2\\xfcs0gr0e\\xfbr\\x8b$\\xab'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4a1f7151
  crc       = 0xe83e94
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x95\\x8fMq\\x94RT\\xd8\\xf2\x1b\\xb9HZ\\xd4N\\xe1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4a1f7151
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 9d99449607310b370a8d4077d2a82200
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4a1f7151
  crc       = 0x836528
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4a1f7151
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4a1f7151
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4a1f7151
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4a1f7151
  crc       = 0xf5294
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x9fbb63a9ba9dd917
           ediv      = 0xc5c3
           skdm      = 0xdea41596daee2373
           ivm       = 0xce10b1a0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  97:26:37:27:02:78
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x7f254551
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x7f254551
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7f254551
  crc       = 0x4250e8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'N\\xe3M4\\x9a6\\xc6Ғ\\xda\\xef\\xf3\\xd1\\xf2X='

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7f254551
  crc       = 0xe052fb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8d}\x11)\x0c\\xd1:\\xbb+\\\\x9a\\x89.\\xd1}\\xc8'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x7f254551
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 72f70ef4e7d9d8e3b002ec5ea6c74d93
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad934b61eb662f77a782cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x7f254551
  crc       = 0x670b80
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93Ka\\xebf/w\\xa7\\x82\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7f254551
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x7f254551
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x7f254551
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7f254551
  crc       = 0x93725e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x9d7fddb37b5831d0
           ediv      = 0x46fb
           skdm      = 0xfca6e129281dcdbc
           ivm       = 0xab688417

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7f254551
  crc       = 0x93725e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x9d7fddb37b5831d0
           ediv      = 0x46fb
           skdm      = 0xfca6e129281dcdbc
           ivm       = 0xab688417

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840e
dec_pkt fc0a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7f254551
  crc       = 0x1dbb44
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x493ed18b4c2fa536
           ivs       = 0x93c1ac5b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c3:39:b9:34:aa:2d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xfb8bfd96
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xfb8bfd96
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfb8bfd96
  crc       = 0x391089
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'B\\xad\\xdf\\xd8\\xd4\\xf1\\xa6\x1adXͳ\\xd5B\\xb3\x0f'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfb8bfd96
  crc       = 0x16c632
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'l\\x8aJ\\xa5*+\\xd6\x10\\x92@\\xea\\x8eCx\\xa7\\xe4'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xfb8bfd96
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 43660b7dd62651fcb8f36b74b6f7df99
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xfb8bfd96
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfb8bfd96
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xfb8bfd96
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xfb8bfd96
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfb8bfd96
  crc       = 0x74e055
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xa2197eabe159444f
           ediv      = 0xacf6
           skdm      = 0x7ee02c33b259b660
           ivm       = 0x21552227

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfb8bfd96
  crc       = 0x74e055
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xa2197eabe159444f
           ediv      = 0xacf6
           skdm      = 0x7ee02c33b259b660
           ivm       = 0x21552227

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840e
dec_pkt fc0a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  21:e6:d6:2c:1e:13
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf38943e6
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf38943e6
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf38943e6
  crc       = 0xe2cb7b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'ܜ\\xa3\\xb3z\\xdc\\xf0X\\xb1\x00\\xdd2\\xf6Mv\\xbb'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf38943e6
  crc       = 0xceafa6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'Q\\xeedvl\tk\\\\x9bYg\x12#:}\\x95'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf38943e6
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 6c5f7b317a56a262142aafc4f46a9812
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 44296cbd510a5b2f64b93b35b2dc9d1a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf38943e6
  crc       = 0x382a04
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'D)l\\xbdQ\n[/d\\xb9;5\\xb2ܝ\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf38943e6
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf38943e6
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xf38943e6
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf38943e6
  crc       = 0x18d2ac
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xc1ea5db65666d98d
           ediv      = 0x4ab4
           skdm      = 0x788b526eae443779
           ivm       = 0xe10866e2

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf38943e6
  crc       = 0x6a3934
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc43a49ec85341104
           ivs       = 0xae9dacd6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf38943e6
  crc       = 0x6a3934
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc43a49ec85341104
           ivs       = 0xae9dacd6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  90:ff:ea:0c:4c:c2
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xc2000123
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xc2000123
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc2000123
  crc       = 0x89a3c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xea\x0f4\\xc1\\x80\\xa2\x19\x0f| ]D\\xa7&\\xe0W'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc2000123
  crc       = 0xa25052
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'u\\xd2\\xf3\\xb0C\x05<\r*\\xc0\\xf6\\xf3\\xea\x16\\x81\\xb9'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xc2000123
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd edcc0c78f30494d0ed967e1d10a08647
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 60ebce76b075673bdda9122fed548993
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xc2000123
  crc       = 0x515efa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '`\\xeb\\xcev\\xb0ug;ݩ\x12/\\xedT\\x89\\x93'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xc2000123
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xc2000123
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xc2000123
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xc2000123
  crc       = 0xed4b75
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x597aa0d53dcf2dc3
           ediv      = 0x5edc
           skdm      = 0xa0863736eddee65f
           ivm       = 0x1bce700b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc2000123
  crc       = 0xde2791
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x13e586bc7255d038
           ivs       = 0xe443f740

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a6:69:ac:eb:8a:8b
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x190ad47a
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x190ad47a
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x190ad47a
  crc       = 0x762cac
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '<\\xa9\x04\\xaa\\xe9*e\x07\x7f!65X\\v\\xfd'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x190ad47a
  crc       = 0x6378a6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb3\nֶ\\xa3\\xcf\\xe4O/\\x9c\\xa4\u05cb(\\xb3\\xbf'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x190ad47a
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 92d68418ae0ab125cfdf35e6fb0ca45c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x190ad47a
  crc       = 0xb4e024
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x190ad47a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x190ad47a
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x190ad47a
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x190ad47a
  crc       = 0x21c799
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x714bcd4de6d7908c
           ediv      = 0xf641
           skdm      = 0x7ee1a4a798e748c9
           ivm       = 0x9212ce8a

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x190ad47a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x190ad47a
  crc       = 0x18785f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x6981040f0c3227e9
           ivs       = 0xb3493b87

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  5d:3e:c9:2d:31:eb
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x2ebc7180
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x2ebc7180
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x2ebc7180
  crc       = 0xbc7f51
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd2xS\\xf49x\x03j\\xb1H \\xb2h-N\\xc3'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x2ebc7180
  crc       = 0x680536
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8f#o%g\\xbb\x0c\\x9d\\xa6BP Q]n3'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x2ebc7180
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e8aec30204d8e8c1a4011e6acc485b50
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 15b6ee54095b77aede9d2ae174a74abc
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x2ebc7180
  crc       = 0x346d75
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x15\\xb6\\xeeT\t[w\\xaeޝ*\\xe1t\\xa7J\\xbc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x2ebc7180
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2ebc7180
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x2ebc7180
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x2ebc7180
  crc       = 0x33b0eb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x4d3a49c15d3c72b9
           ediv      = 0x6df1
           skdm      = 0xb5149f4be0969583
           ivm       = 0x35bcd2c1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x2ebc7180
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  e2:e2:9a:ae:01:25
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xfb4ed81e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xfb4ed81e
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfb4ed81e
  crc       = 0xb00c50
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'pwp%\\xc4|T걶\\xb5Qme\\xe8!'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfb4ed81e
  crc       = 0x3386a1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8bq\\xdaHX\\xb2ܼ\\x95Co\\x97*Z\\x97G'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xfb4ed81e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 5962764df1545b7535fede61716c1ed6
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 87ad3bd3c0d69dedef4e957074a74abc
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xfb4ed81e
  crc       = 0x9f5c08
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x87\\xad;\\xd3\\xc0֝\\xed\\xefN\\x95pt\\xa7J\\xbc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfb4ed81e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xfb4ed81e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xfb4ed81e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfb4ed81e
  crc       = 0x5e28fa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xd3d0c59a35b677af
           ediv      = 0xc633
           skdm      = 0x649ebfa07e4fe25c
           ivm       = 0xe527eabd

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfb4ed81e
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfb4ed81e
  crc       = 0x8da236
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x174c97115162abb0
           ivs       = 0x842b3534

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  22:81:cc:ca:bd:b9
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x35cd6991
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x35cd6991
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x35cd6991
  crc       = 0xf2e90f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xce-@uqkt\\Y\\x8bǮ2Չ\\xf7'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x35cd6991
  crc       = 0xc8c0c3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x94\x02\\x98\\xbb\x0c\\xe3U2\\x94\\xe8%!\n\\xbb\\xe7N'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x35cd6991
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 5b3a634e1a3613393c63ffec83f05e5f
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 53d8ba5b2a6cdda9e5ee54317177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x35cd6991
  crc       = 0x9752ef
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Sغ[*lݩ\\xe5\\xeeT1qw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x35cd6991
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x35cd6991
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x35cd6991
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x35cd6991
  crc       = 0x9e9af0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xc2c40bc920d1d0fd
           ediv      = 0xa483
           skdm      = 0xa5f473ce62bc8d7d
           ivm       = 0xf3247549

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x35cd6991
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  7b:d9:24:3e:4f:03
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x65e4c7ae
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x65e4c7ae
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x65e4c7ae
  crc       = 0x380e52
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8c\x02Q{\\xfe\\xa6\\xfb\\xe2\x1a\\xdf\\xca\\xec\\xe5\\xb5\\xcdA'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x65e4c7ae
  crc       = 0x24ac61
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\r\x04\\xbf\\xeb\\xfb\x0e\\xf7h"\\x84\\xee\\xf0:\\xbd\\xe15'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x65e4c7ae
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 403a62e1fad4d117bcb59cb0e69ba08c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd e52885153b4a61c3922c779727cbdda1
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x65e4c7ae
  crc       = 0x4e76ae
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = "\\xe5(\\x85\x15;JaÒ,w\\x97'\\xcbݡ"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x65e4c7ae
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x65e4c7ae
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x65e4c7ae
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x65e4c7ae
  crc       = 0x4a3a25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x585503a4e71ce76b
           ediv      = 0x6de5
           skdm      = 0x84e30e41f1b5f285
           ivm       = 0x737ebc71

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x65e4c7ae
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8407
dec_pkt fc03
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x65e4c7ae
  crc       = 0xbc920d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x504530996676c489
           ivs       = 0xa57ac503

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  69:3e:32:08:f1:cb
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa0670a19
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa0670a19
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa0670a19
  crc       = 0x878410
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8a\\xdc^\\\\xc4\x17\\x86\x11\\x8a\x19\\x92\x04I\\xf5LV'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa0670a19
  crc       = 0x1969e9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '~\\xa8K\\xde\x11%r\\xe4RF\\xd5\x1b\\xfc<.\x0e'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa0670a19
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 9a3ebf594390b7bb45ffb06198dc3e78
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd c46be548f15a391298fb916ce67e241b
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa0670a19
  crc       = 0x9ba49e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xc4k\\xe5H\\xf1Z9\x12\\x98\\xfb\\x91l\\xe6~$\x1b'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa0670a19
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa0670a19
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xa0670a19
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa0670a19
  crc       = 0xb6ee2a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x728ac9d3e9e1b836
           ediv      = 0x5fcc
           skdm      = 0xfa4586a315174355
           ivm       = 0x63a15693

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa0670a19
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8407
dec_pkt fc03
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  4e:e1:e2:a4:b3:1a
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x400c7e5e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x400c7e5e
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x400c7e5e
  crc       = 0xfd976c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = ')\\xc7v\\xbc\\xc8\x1b0\x07\\xd4\x02\\xe2\x11=\\x88z\\x83'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x400c7e5e
  crc       = 0x7e9d44
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf6\\x8aiJ\\xa7k\\xbd\x11\\xee\\xd9y\x12\\x81Q0.'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x400c7e5e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 13156b512c304d7cc523c20d2bb2a9c7
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2a6cdda915b6ee54bb3b55cade9d2ae1
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x400c7e5e
  crc       = 0x3c0d97
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '*lݩ\x15\\xb6\\xeeT\\xbb;U\\xcaޝ*\\xe1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x400c7e5e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x400c7e5e
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x400c7e5e
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x400c7e5e
  crc       = 0xfa4b2e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x25386d1176873748
           ediv      = 0xff78
           skdm      = 0xb5b3a8284c6ac2b9
           ivm       = 0x9040d502

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x400c7e5e
  crc       = 0xfa4b2e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x25386d1176873748
           ediv      = 0xff78
           skdm      = 0xb5b3a8284c6ac2b9
           ivm       = 0x9040d502

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840e
dec_pkt fc0a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x400c7e5e
  crc       = 0x9a2d26
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xbba442f2fa70aa17
           ivs       = 0xe895bfdf

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  86:c8:36:e2:1e:d6
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x8acc01b3
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x8acc01b3
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x8acc01b3
  crc       = 0x3ed7e2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'F\\xa9\x1a\\xcc\\xf6#m\\xe2\x17\\x8e\\xa9\\xa1\\xa9(!\\xdb'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x8acc01b3
  crc       = 0x15e064
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'v\x1dۄ\\xd3\x1d\\x84\\x89\\xfdǆ쒈\\xa5\\x8c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x8acc01b3
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3ed2d9178d4bf72885a19e5ae745ff28
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd59ee4e0d94bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x8acc01b3
  crc       = 0xf02866
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcdY\\xeeN\r\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x8acc01b3
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8acc01b3
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x8acc01b3
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x8acc01b3
  crc       = 0x9923a8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xf630ea78c374c942
           ediv      = 0xe385
           skdm      = 0x10b915f20e031220
           ivm       = 0x2898088a

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x8acc01b3
  crc       = 0x9923a8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xf630ea78c374c942
           ediv      = 0xe385
           skdm      = 0x10b915f20e031220
           ivm       = 0x2898088a

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840e
dec_pkt fc0a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  58:fb:57:cc:c4:61
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x250fdb9d
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x250fdb9d
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x250fdb9d
  crc       = 0xc753ae
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8b\\xf1\\x9b9}r\\xf5Yl~d\\xadB\\xc9\x1b\\xaa'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x250fdb9d
  crc       = 0xb167c0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb7\\xa5O\\xb1\\xb7{J\x04\\xect\x15\\x973\\xdd%\\xdd'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x250fdb9d
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e468ae4e9e1d5d6a380ab142e03600ed
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb6653d8ba5bcadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x250fdb9d
  crc       = 0x14932d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebfSغ[\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x250fdb9d
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x250fdb9d
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x250fdb9d
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x250fdb9d
  crc       = 0x7b54
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xe1bedec9d4149f50
           ediv      = 0x792d
           skdm      = 0x52716ac3899594ef
           ivm       = 0x4ede8e0c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x250fdb9d
  crc       = 0x3875a7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x144bbba6b0107838
           ivs       = 0x86901d34

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x250fdb9d
  crc       = 0x3875a7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x144bbba6b0107838
           ivs       = 0x86901d34

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  97:3d:ef:10:a5:62
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x92ca35c5
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x92ca35c5
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x92ca35c5
  crc       = 0xa5795a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'Hjw\\x8fSd\\xc1r\x03\\x80kf\\xbfӈ\\xb2'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x92ca35c5
  crc       = 0x5aede0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xca\x16\u07fbշ\\xa9\\xf9Jf\x1e\\xe2\\xbf\\xfeZR'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x92ca35c5
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 286999a2a195079bf5a7d5984ed12186
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 87ad3bd3c0d69dedef4e957074a74abc
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x92ca35c5
  crc       = 0x9f5c08
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x87\\xad;\\xd3\\xc0֝\\xed\\xefN\\x95pt\\xa7J\\xbc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x92ca35c5
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x92ca35c5
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x92ca35c5
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x92ca35c5
  crc       = 0x304594
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xca34e8a72a2d0781
           ediv      = 0xf888
           skdm      = 0xeed85c8acbf63e17
           ivm       = 0xde9616a1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x92ca35c5
  crc       = 0xf5209
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x86a5daf11d663a36
           ivs       = 0x991b127e

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  9e:de:f1:fa:80:db
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf0fa1c
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf0fa1c
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf0fa1c
  crc       = 0x287478
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1d\\xf9\\xf2}\\x97V߅A\\xea\\xc1\x04\\xed\x0e\\xcc}'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf0fa1c
  crc       = 0x75c12c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '&X\x08\x1b\\xd2`\x1f\x15TZ1\\xcc+\x11G\\x9a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf0fa1c
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c8bc3ba9fed46a7869157232bd916250
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 15b6ee54095b77aede9d2ae1ef4e9570
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf0fa1c
  crc       = 0x329817
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x15\\xb6\\xeeT\t[w\\xaeޝ*\\xe1\\xefN\\x95p'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf0fa1c
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf0fa1c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xf0fa1c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf0fa1c
  crc       = 0xd3bc3e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xf7320a91d88143a8
           ediv      = 0x8978
           skdm      = 0xd0f30967892bb0fd
           ivm       = 0x1a642248

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf0fa1c
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf0fa1c
  crc       = 0xf9a022
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xde4fac2cb68e577a
           ivs       = 0xbac8dc59

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  60:18:d0:46:71:57
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x3c04ab3e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x3c04ab3e
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3c04ab3e
  crc       = 0x5c84f5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '*g\\xcdI\\x9d \\x83\\xd2\\xe0\\xe0\\xb9$ͺd#'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3c04ab3e
  crc       = 0xc5a839
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '$l\\x98\\xaf\x08\\x9b@e\\xd6$U\\xebW\\xb8\x03W'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x3c04ab3e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 4c56ae26339339d53b82cd25d66d2a7b
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 6cddd90eb6ee6c073955e2e29f2a71f5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x3c04ab3e
  crc       = 0xf9ecc2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'l\\xdd\\xd9\x0e\\xb6\\xeel\x079U\\xe2\\xe2\\x9f*q\\xf5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3c04ab3e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x3c04ab3e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x3c04ab3e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3c04ab3e
  crc       = 0xbe314f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x86ef6e9f0a1cfa8f
           ediv      = 0x12f3
           skdm      = 0x97e715f7eca362da
           ivm       = 0x374c1f30

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3c04ab3e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  3c:c4:00:bc:4e:f6
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4a4ca17c
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4a4ca17c
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4a4ca17c
  crc       = 0x5e92a7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'e\\xfe\\xed\\x85\\xc4\r\\x8a\\x84\\xf0\x0f\\x8eXJ\\x8eJ\\xcd'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4a4ca17c
  crc       = 0x207adc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd8\x11!\u07fb\\xa8c\\xc1\\x87\\xa2}\\xb0\x11\\xa6\\xb4\\xc9'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4a4ca17c
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c31594babef645a1be507f5d70a34c0d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4a4ca17c
  crc       = 0xb4e024
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4a4ca17c
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4a4ca17c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4a4ca17c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4a4ca17c
  crc       = 0x95809a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x6bda7058e602e1e
           ediv      = 0x89
           skdm      = 0xacb17c93f72c24ca
           ivm       = 0xfdfb7c20

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4a4ca17c
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4a4ca17c
  crc       = 0xc10d6d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x5377119b12bfe718
           ivs       = 0x7ffab4e4

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  61:c2:d8:16:da:f4
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xe2370cc7
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xe2370cc7
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe2370cc7
  crc       = 0x9c7cb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "*\\xa2{\\x93x'b)\\x94h@\\x98\x15\\xba\x05\\x9a"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe2370cc7
  crc       = 0x78750c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb7R0)\x1dʘ\\xe3)C\\xfbP|We\\x84'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xe2370cc7
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 5ddad1901dd7c8d246c9ef3c2dd0a2db
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d94bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xe2370cc7
  crc       = 0x86b773
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe2370cc7
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xe2370cc7
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xe2370cc7
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe2370cc7
  crc       = 0xd20ab3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x681ab81a11d5d8b7
           ediv      = 0x32ce
           skdm      = 0xcf4f4d61e5087178
           ivm       = 0x77022951

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xe2370cc7
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  8e:c6:7f:fa:62:e9
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xb6e7ca2e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xb6e7ca2e
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb6e7ca2e
  crc       = 0xc0cbf3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'D\x088\\x89\\x94D(\\x9a\\xb4\r\\xfd\t\\x92;\\\\x9e'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb6e7ca2e
  crc       = 0xa2fab
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8a\\x809\\x90\\x83\\xa5\\xf1\x11@\\xc5\\xf5\\xf6\\xcf\x1fO\\x98'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xb6e7ca2e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 220f539bd0a726a2725f891e19bc76ff
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb66a6b075b7cadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xb6e7ca2e
  crc       = 0x9d042e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebf\\xa6\\xb0u\\xb7\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb6e7ca2e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb6e7ca2e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xb6e7ca2e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb6e7ca2e
  crc       = 0xc9415d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb56bbea63f49b69b
           ediv      = 0xb1fc
           skdm      = 0x74d6c3ada80b24b5
           ivm       = 0x8f691f91

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb6e7ca2e
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8407
dec_pkt fc03
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb6e7ca2e
  crc       = 0xe927ff
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x252ffb935a7bba56
           ivs       = 0xaed7d4e8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  85:a4:2e:89:da:65
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4d5a0d61
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4d5a0d61
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4d5a0d61
  crc       = 0xcd28a1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x05\\xa9\\xe8Xf\x14\\xc8\\xc8\\xc4,F\\xfe\\x8b\\xb0\\x98\\xb0'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4d5a0d61
  crc       = 0x4e7e24
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf3\\xd8\n\x7f۶\\xaf\\x96\\xad\x01`\\x99\x03\\x9e\\xa5\\xae'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4d5a0d61
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 8a4852154fd3e73ee3af4d7a97239989
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e2b85ad93b2dc9d1a2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4d5a0d61
  crc       = 0xd8a580
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^+\\x85\\xad\\x93\\xb2ܝ\x1a/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4d5a0d61
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4d5a0d61
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4d5a0d61
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4d5a0d61
  crc       = 0x6656ce
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xe8424426a28f0059
           ediv      = 0x84b8
           skdm      = 0x9a4806706f95b6e3
           ivm       = 0x19fd7b26

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4d5a0d61
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8407
dec_pkt fc03
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  da:35:1d:86:e8:37
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf16d783c
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf16d783c
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf16d783c
  crc       = 0x8856c1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '[\x19\\xacm\\xe0\\x99\\x92\\x87\\X\x11\\xe5B\\xfa\\xff\\xd4'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf16d783c
  crc       = 0x589e0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x0eJ3 U\\x97\x01\\x8c\x0f\\x8c\\x87\x18\x05,\\xc2%'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf16d783c
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 6d1d1e04dc9470820dc8304581bc5370
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b753d8ba5be5ee54317177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf16d783c
  crc       = 0x46998c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7Sغ[\\xe5\\xeeT1qw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf16d783c
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf16d783c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xf16d783c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf16d783c
  crc       = 0x788bb2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x1fc2d14f77201689
           ediv      = 0x81d2
           skdm      = 0xef57b6512e66580e
           ivm       = 0xb4469092

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf16d783c
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8406
dec_pkt fc02
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf16d783c
  crc       = 0x2ee099
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4ebddb3b79e58eb6
           ivs       = 0x4e5fe194

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  4b:95:96:4a:fa:44
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x223ba62c
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x223ba62c
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x223ba62c
  crc       = 0x4beab
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'c\\xac\\x80ojy\x15\\xc6vى\\x87\x1c\\xe5[\\xf1'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x223ba62c
  crc       = 0x43322a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '+Ӡ\\xdd6\\xd9\x15\x1c\\xd6\\xf5\\xb2\\xf0{\x10\\xe0\\x8e'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x223ba62c
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd d75ec5fccef61c15e04b844764c119ca
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x223ba62c
  crc       = 0xb4e024
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x223ba62c
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x223ba62c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x223ba62c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x223ba62c
  crc       = 0x26e1f7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x29f83a951eb22595
           ediv      = 0xbbab
           skdm      = 0xcc75346f43c73c9e
           ivm       = 0xe68cf122

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x223ba62c
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8406
dec_pkt fc02
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
Hypothesis 2: 5 states.
-----------------Pre Start-----------------
Master Address:  82:c1:75:95:cc:0b
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xfe2dcf4b
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xfe2dcf4b
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfe2dcf4b
  crc       = 0xfabd6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd1\x7f\\)\\xf6h\x06!\\xc6/6\\xafxѐ\\xe1'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfe2dcf4b
  crc       = 0xa6b5ab
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'q\\x92\\xc6[!\\xf7v\\xa1\x00\\xb6\\x9f\\xa3\x15 \x05\\x8d'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xfe2dcf4b
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 33da4cb96a84eb6e85ffa30dba479312
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd59ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xfe2dcf4b
  crc       = 0x18c19
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcdY\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfe2dcf4b
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xfe2dcf4b
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xfe2dcf4b
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfe2dcf4b
  crc       = 0x4d84f9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xd03a85cc87ca581e
           ediv      = 0xa6fe
           skdm      = 0x605326afd7bd0241
           ivm       = 0x42419fac

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfe2dcf4b
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
----------------step int find_cex----------------
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  86:9e:10:f3:20:f0
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0x2dc4cc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x11\\xc6\x05j;\x07~L\\x84\\xaa\\xccT\\x89y\\xe3i'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0xed8361
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x85\\xb3\\x8f\\xa6؍.\\xc0/ \\x86+V\\x92\\xceM'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 616deb822bee5e08c8aefdcc86b2343c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e2b85ad93b2dc9d1a2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0xd8a580
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^+\\x85\\xad\\x93\\xb2ܝ\x1a/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0x1c2054
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x1b3c84a94f5ad372
           ivs       = 0xecc180c6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0xa8e7bf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x2f0f2e0628a0235a
           ediv      = 0x5e60
           skdm      = 0xbd939315652c372d
           ivm       = 0xfadb3587

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0x1c2054
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x1b3c84a94f5ad372
           ivs       = 0xecc180c6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x878fa694
  crc       = 0x1c2054
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x1b3c84a94f5ad372
           ivs       = 0xecc180c6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a6:b2:29:52:ec:0b
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0x55756
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '3\\x80\x12\\xb6S\\xc3\\xccc7\\xb8\x0b\\x94Ӡ!\\xd9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0x47684d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "+\\xbeT\x12\\x8d\x10H\x16C\\xfb\\xe0\x1e\\xd8k\x12'"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 9131f7236f9580529a2f8531f2c7ebd6
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0x836528
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0xef17a0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x154847373e6f44a
           ivs       = 0xfea4fcd8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0xf0a0c4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xa671b0273a7ccea1
           ediv      = 0xe522
           skdm      = 0x7c10d9493b569965
           ivm       = 0x835b0e33

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0xef17a0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x154847373e6f44a
           ivs       = 0xfea4fcd8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x649b0a7
  crc       = 0xef17a0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x154847373e6f44a
           ivs       = 0xfea4fcd8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
Counterexample found:  ('ll_start_enc_req_pkt', 'll_enc_rsp_pkt', 'll_start_enc_rsp_pkt', 'll_start_enc_req_pkt', 'll_enc_req_pkt', 'll_enc_rsp_pkt', 'll_enc_rsp_pkt')
Counterexample ('ll_start_enc_req_pkt', 'll_enc_rsp_pkt', 'll_start_enc_rsp_pkt', 'll_start_enc_req_pkt', 'll_enc_req_pkt', 'll_enc_rsp_pkt', 'll_enc_rsp_pkt')
-----------------Pre Start-----------------
Master Address:  72:76:65:5a:88:e0
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0x6cc552
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xfe?ןU\\xc9\\xd1V\\xd2*T\\xb7\\xcaH\\xfd\x19'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0x4ecc46
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb8\\xa3\\xf0N7\\x87c\\x99ծ\\xfdEp.P\\xc1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 11018d9325610b19c40c963c4cb87a57
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0xcd8f1f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0x758c6d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x779b061fda098283
           ivs       = 0xad113cd1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0x9868b6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xba7c3270fe1f3efc
           ediv      = 0x3cfb
           skdm      = 0x26c637bd152f376c
           ivm       = 0xb64e919a

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0x758c6d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x779b061fda098283
           ivs       = 0xad113cd1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa48816ee
  crc       = 0x758c6d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x779b061fda098283
           ivs       = 0xad113cd1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  6c:3c:0e:02:4f:a4
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0xc1dd41
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '^\\x94\\x81A䚓\\x86K\\x846/\\xebqd\\xf6'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0x6ad24c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd2\x07,\x10J`M\x18\tps\\xe8VX\\xfd|'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c8db3c74b3e1ca546cabc076fd7d364c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0xa5e82d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x969ded9dfcc60c7b
           ivs       = 0xd57fbc70

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0xfc93f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xd1306b62e16b9a12
           ediv      = 0xfcd8
           skdm      = 0x29f820d93e527264
           ivm       = 0x3549af4c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0xa5e82d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x969ded9dfcc60c7b
           ivs       = 0xd57fbc70

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x60442079
  crc       = 0xa5e82d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x969ded9dfcc60c7b
           ivs       = 0xd57fbc70

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  ed:f6:7f:50:9a:fa
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0xea133f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1d\\xd6|\\xdd\\xc3"\x0f\\x93\\x97)\\xeb\\xf3\\xb3\\xe9N\\xf3'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0x752a05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '<v\\xd9\\xc4\\xf7١O\\xac\\xfa\x04!\n\\xb3\\xf4x'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 5a48ba2738fb427f6380bab84fc98d34
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 1ea5b0e58f52d87290e5eed4c872776a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0x7b707b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x1e\\xa5\\xb0\\xe5\\x8fR\\xd8r\\x90\\xe5\\xee\\xd4\\xc8rwj'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0x3ccffd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe6ccba123038afda
           ivs       = 0x6188ecd9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0x24ea60
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x4b9479594b764e09
           ediv      = 0xa52b
           skdm      = 0x886ff99dd9db0861
           ivm       = 0x5c09f335

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0x3ccffd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe6ccba123038afda
           ivs       = 0x6188ecd9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xccddd9da
  crc       = 0x3ccffd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe6ccba123038afda
           ivs       = 0x6188ecd9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  93:9c:81:59:c6:3f
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0x9c0004
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xeb\\xcf\x14\\xd7J\\xe2Y\x11*\\x94\\x8e\x02v\\xdd\\xedl'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0xdc443b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa9\x01\\xd5XR\\x95\x07\\xfdVuY\\xeeP\\xce\\xdb3'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 933738f91ac9a4613b6d031d143c7c22
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cda6b075b7cadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0xa46d0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6ͦ\\xb0u\\xb7\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0xd3b3e3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9b70e13b1b9a0f05
           ivs       = 0xc337fd95

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0xc280e3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xad35cda2ab86c2be
           ediv      = 0x570b
           skdm      = 0xe396b6ca2c066ef3
           ivm       = 0xe7ab6883

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0xd3b3e3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9b70e13b1b9a0f05
           ivs       = 0xc337fd95

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x181deb78
  crc       = 0xd3b3e3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9b70e13b1b9a0f05
           ivs       = 0xc337fd95

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  8f:db:f9:76:f5:5d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0x95b6ae
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf4\\x8e\\x86=\\xa4\\xb5)\\xff\\x8b\x1e\\xebĄ\\xb8\\xa5p'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0x124bbb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8e\x1b\\x81SZ\\xa2\\x82\x0eK.ݨ\n\\xf1$\\xe4'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 83f1d84576d87a35e02dcde4b72b9153
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd c0d69ded60ebce7674a74abcdda9122f
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0x84a45c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xc0֝\\xed`\\xeb\\xcevt\\xa7J\\xbcݩ\x12/'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0x5a00e3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xdb6a5d76ea4cf260
           ivs       = 0x56ea37b8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0x5c969
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x2f64e287c3d646d1
           ediv      = 0xf363
           skdm      = 0x4e882f97460f0424
           ivm       = 0x41eab145

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0x5a00e3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xdb6a5d76ea4cf260
           ivs       = 0x56ea37b8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa0c4dca3
  crc       = 0x5a00e3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xdb6a5d76ea4cf260
           ivs       = 0x56ea37b8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  3f:26:31:28:1f:6a
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0x71ac4a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x9fY\x07iH\\xbb\\xe7$ߓ\\x81(\\xe5\x0f\\xcf\\xd7'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0x5598a5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 't\\xe0\\xe5\x06\\x87O0\\xd0\\xfc~\x1e\\x9f\\xd8-\\xb0\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd fee4ec4200145ade2b965bedc983f377
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0x836528
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0x762f75
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x149ea82fcffb2d11
           ivs       = 0xba0def78

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0xc89bd2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x812f8bc12dec6fdd
           ediv      = 0x4e7f
           skdm      = 0xd6377409ccbe8ef6
           ivm       = 0x2224d0f8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0x762f75
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x149ea82fcffb2d11
           ivs       = 0xba0def78

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf9290119
  crc       = 0x762f75
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x149ea82fcffb2d11
           ivs       = 0xba0def78

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  07:29:bb:b7:81:c8
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x5bb35951
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x5bb35951
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5bb35951
  crc       = 0x7cbfb4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x97\\xd1\x00\x10\\xcc\x13\\xe5\\xa68\\xf5\x1e\\xf8\\xe5\\xc7z\x1a'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5bb35951
  crc       = 0x22280c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '%\x02~\\xe7[\x14\x08\x125\\xea\\\\x88z,\\x81\\xc4'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x5bb35951
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 14e028b2bd3f0bb4e3373c2a1a6b05fe
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 53d8ba5b2a6cdda97177aa9cbb3b55ca
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x5bb35951
  crc       = 0xd69c24
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Sغ[*lݩqw\\xaa\\x9c\\xbb;U\\xca'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5bb35951
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x5bb35951
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x5bb35951
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5bb35951
  crc       = 0x8ab10f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xa2f60c33d7da62ec
           ediv      = 0x9766
           skdm      = 0xc4ca5593a72f5fad
           ivm       = 0xf1ab21c9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5bb35951
  crc       = 0x577d6c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xeb969635025d6e7f
           ivs       = 0x2dd6f6bb

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  0d:56:56:f9:7d:8d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0x3dc6fd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = ',\\xa3\\xcdr\x0e\x04\\x91?iQ\\P\\x9e@V<'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0xd3faa8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa5\\xc6*\\x91\\x95d\\xb8\x06\\x9b\\xcd&\\x94\\x94\x11\\xcb\\xfe'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 9d9381f0227d4e3b40990f21c65a46e2
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd59ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0x18c19
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcdY\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0x5afd3c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xe70e3b03ba3c93c6
           ediv      = 0x61b6
           skdm      = 0x3cccefde3263c4b
           ivm       = 0x377d35da

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0x5afd3c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xe70e3b03ba3c93c6
           ediv      = 0x61b6
           skdm      = 0x3cccefde3263c4b
           ivm       = 0x377d35da

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0x92b3f7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4cbe39c16ce6d2c5
           ivs       = 0xd84a9bf5

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xff45ae70
  crc       = 0x92b3f7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4cbe39c16ce6d2c5
           ivs       = 0xd84a9bf5

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f3:1b:53:94:e9:78
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x1340c57a
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x1340c57a
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1340c57a
  crc       = 0xb019d4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '.\\xb1\x02\\xbf\u0557\\x81ۜ\\xc8H\x1e\\xe9\\x9f\\xc1\\xf8'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1340c57a
  crc       = 0x872f16
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc7\x16\\x94\x01\t )r\r\\xce\\xcbJ\\x9c.\\xf4u'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x1340c57a
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3c9b13e3ccb8e9135f70931df250ea4f
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 44296cbda214b65ec872776ab2dc9d1a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x1340c57a
  crc       = 0x5f2660
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'D)l\\xbd\\xa2\x14\\xb6^\\xc8rwj\\xb2ܝ\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1340c57a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x1340c57a
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x1340c57a
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1340c57a
  crc       = 0x5a8d6e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xf542bead800fc1d0
           ediv      = 0x6597
           skdm      = 0xcd23d7f8f19f7421
           ivm       = 0xeea141d9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  66:68:91:7a:02:82
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4b057aa4
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4b057aa4
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4b057aa4
  crc       = 0xd53b36
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '*S\\xf1\\xde$\x15S1\\x87\\x99\\xc3g\x12\\xf4\\xe9\\x8c'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4b057aa4
  crc       = 0x5f3dd6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\x04\\xaf#\\xe0'Yh\x14oR\\xbc\\x8e\\x94lK\x01"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4b057aa4
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 20ce91fe185df5f1a0b09b7f127c4a7e
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4b057aa4
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4b057aa4
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4b057aa4
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4b057aa4
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4b057aa4
  crc       = 0x3ddf78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x825c802458ceec40
           ivs       = 0xd98e1dd1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4b057aa4
  crc       = 0x3ddf78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x825c802458ceec40
           ivs       = 0xd98e1dd1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  06:31:9e:67:8e:d4
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0x1f5ec9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x85\\xaf\\xdesB\\xbb/\x07Qi\\x96\\xd6\\xd2ʭ2'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0xa530ec
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '1U@[\\xac\x0e\\xa0jyP\\xaf\\xdb\\xc4\rK\\xbe'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c26b7dee24102fc087ace6e687898558
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 3b4a61c31ea5b0e527cbdda190e5eed4
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0xd1735a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ";Ja\\xc3\x1e\\xa5\\xb0\\xe5'\\xcbݡ\\x90\\xe5\\xee\\xd4"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0x7f4daf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa4302907b11dbab5
           ivs       = 0x37897ca7

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0x15245e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xae3e4b7e3b522d81
           ediv      = 0xc4fe
           skdm      = 0x60e23a3ad7de22
           ivm       = 0xe1448a6b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0x7f4daf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa4302907b11dbab5
           ivs       = 0x37897ca7

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xe0bd9c8a
  crc       = 0x7f4daf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa4302907b11dbab5
           ivs       = 0x37897ca7

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c7:1d:8d:09:b3:9c
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xfc29e363
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xfc29e363
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfc29e363
  crc       = 0x58c25f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xce\x08\\xc5&\\xb2\\xe8\\xa0\\xd3E\\x97\\xbc\\xcf\x10\\xa33\\x81'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfc29e363
  crc       = 0x9746c8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd0\x1a\\x8b\\x96p#\\xfbZ\\x86\x1e\\x96\\xdc\x08Z8\\xd1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xfc29e363
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 0d67cc8455f75b55524ab29ff39d0174
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 3b4a61c31ea5b0e527cbdda190e5eed4
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xfc29e363
  crc       = 0xd1735a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ";Ja\\xc3\x1e\\xa5\\xb0\\xe5'\\xcbݡ\\x90\\xe5\\xee\\xd4"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfc29e363
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xfc29e363
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xfc29e363
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfc29e363
  crc       = 0x146635
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x7cc8815849c24380
           ivs       = 0x16e24b7b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  3d:72:37:76:30:4d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xc4eb2071
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xc4eb2071
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc4eb2071
  crc       = 0x70f630
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xbe\x15\\xd1|\\x9c\tY\x11\\xbd\\xd3\x7fȥ\\x92\\xc26'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc4eb2071
  crc       = 0x2625c7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x9cm\x14\\x90\\xb6o\\xe6\\xf8\x12\\xf5\\x80\\x82\x06\\x83W\\xd1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xc4eb2071
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 70ed9cbae7ed5c0085169b1350f51d70
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xc4eb2071
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xc4eb2071
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xc4eb2071
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xc4eb2071
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xc4eb2071
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa4
dec_pkt 7adc
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc4eb2071
  crc       = 0xeaf6fe
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x36ff055fa3be4c6c
           ivs       = 0xf1d45055

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  64:41:fd:97:92:24
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0x7f80e6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb42n\x1e\\x84\\xe1\\xca\x7f\\x84E\\x88\\xc7\\xef!%\\xaf'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0x7564d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x9e\\xf8)\\xfe\\x96\\xcbZַo#\\x84`\\xcbU\\xd3'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 2b4b170c565ea037f53bc31a911ca3b0
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cda6b075b7cadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0xa46d0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6ͦ\\xb0u\\xb7\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa4
dec_pkt 7adc
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0x6c9aa4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xed707887cb0eff45
           ediv      = 0x4ae0
           skdm      = 0xfb6dd07e68a592a2
           ivm       = 0xbc4dc3e2

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0x17e1b3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe0f92266a5f548bb
           ivs       = 0x69c52c7c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa65bf1e0
  crc       = 0x17e1b3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe0f92266a5f548bb
           ivs       = 0x69c52c7c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  93:69:42:54:45:44
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x3246f2e4
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x3246f2e4
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3246f2e4
  crc       = 0xa723e6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xben\\xd6\x14\\xcf\x06!\x07\\xb7di\\xf7\\xa2\\x85\\x8e\x1d'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3246f2e4
  crc       = 0xfb78ed
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa7\\xb5\'"\\xa8\\xb1/4\\xb0\\x94&I\x19\\xb4rI'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x3246f2e4
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e6e2781e39bc86bf553fec31d247cf18
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd59ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x3246f2e4
  crc       = 0x18c19
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcdY\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3246f2e4
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x3246f2e4
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x3246f2e4
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3246f2e4
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa4
dec_pkt 7adc
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  95:42:a6:ae:32:a7
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x7f9fcd47
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x7f9fcd47
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7f9fcd47
  crc       = 0x670d75
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'G\x01\\xee\\x93`{@]\\x9c%\\x8b\\xe0\x04\\xc4\x13\x0b'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7f9fcd47
  crc       = 0x67a96b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xfd\\xec\\xcfN\\xef\x19^Gd\\xb9"M\\x81a#\\xf7'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x7f9fcd47
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e1324363b9257153216f472ef320d3c5
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 53d8ba5b2a6cdda9e5ee5431bb3b55ca
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x7f9fcd47
  crc       = 0x3df4ca
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Sغ[*lݩ\\xe5\\xeeT1\\xbb;U\\xca'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7f9fcd47
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x7f9fcd47
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x7f9fcd47
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7f9fcd47
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa7
dec_pkt 7adf
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7f9fcd47
  crc       = 0xfc0c37
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xae2be7a6e5f4e087
           ivs       = 0xa61f5c28

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  2b:75:91:18:fa:81
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0xfeb141
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xbd\\x85u\\x8d\\x9b\\xb6\x7f\\xed\\xa3\\xae\\xf5\\xef\\xdb\x1a)D'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0x827579
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xed\\xf0\\x96\\xc1ؽ\\x907O\\x8c^\x14\\xdau3,'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 136001729b1e84de0b365336ef6240ad
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0xb4e024
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa7
dec_pkt 7adf
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0x940a1d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x47922963bf324314
           ediv      = 0x9970
           skdm      = 0x2e23f5e61b76a1bc
           ivm       = 0x704e0193

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0x46f802
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x55c1e3c17b042b39
           ivs       = 0x727d4987

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdf26bc4d
  crc       = 0x46f802
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x55c1e3c17b042b39
           ivs       = 0x727d4987

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  16:8a:b5:51:4d:8c
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4bacfb66
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4bacfb66
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4bacfb66
  crc       = 0xc24212
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'H\\xb7\\xa6\\xeew\\xd1\x0f\\xa7f\u0601\\xad~z\u0602'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4bacfb66
  crc       = 0x704a46
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x10\x19\\xb7\\xe6q0\\xf2.\\xf0P{\\xf1#\x0fY\\x80'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4bacfb66
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 4cde7967d86a0b79dbe9eec45f267c1d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cd4b61eb662f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4bacfb66
  crc       = 0xcba3f8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6\\xcdKa\\xebf/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4bacfb66
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4bacfb66
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4bacfb66
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4bacfb66
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa7
dec_pkt 7adf
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  5a:3a:1a:69:45:7a
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x3d932556
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x3d932556
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3d932556
  crc       = 0xe0e51d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '-\\xach\\xf2.;Y\x13qS\\x81\\x85C\x07\\xe2\\xa7'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3d932556
  crc       = 0x881002
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xfb\\xda\x03p\\xd0\\xe0\\xb0cں\x14y\x11\\xef\x16\\xea'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x3d932556
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd cdda892937eded633899a2a32e2339c2
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd fbe2b55a7ef15aa985ccfdf041e67efc
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x3d932556
  crc       = 0xaf56b0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xfb\\xe2\\xb5Z~\\xf1Z\\xa9\\x85\\xcc\\xfd\\xf0A\\xe6~\\xfc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3d932556
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x3d932556
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x3d932556
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3d932556
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afab
dec_pkt 7ad3
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3d932556
  crc       = 0x3c6f30
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x843a5a3c5b5a3140
           ivs       = 0x8e468844

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  bc:e7:09:e6:23:37
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0x81eea0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x9cj\\xb0b]\\xeb8\\xbb\\xefO\\xbd\\xac$\\x81\\x8bo'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0xd9399a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '|&_\\x8fV\\x9f\\xf9\\x8c^l88\\xdc\\xc1ۋ'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd d6534c2c6f42698e91a4e3044af47ac6
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0xcd8f1f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afab
dec_pkt 7ad3
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0x16016e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb5911d737b767253
           ediv      = 0x1108
           skdm      = 0x8d31a976ab0601ee
           ivm       = 0x86a79faa

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0x30cf41
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x1a6110578e074ff5
           ivs       = 0x827ea087

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4eef1c33
  crc       = 0x30cf41
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x1a6110578e074ff5
           ivs       = 0x827ea087

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  85:ae:93:c2:4f:79
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x5df9cb70
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x5df9cb70
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5df9cb70
  crc       = 0xba5290
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'o\\xb9b\\xf6\\xaa\\xd6\\xdbh\\x9c#-\\xefw\\x84>\\xab'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5df9cb70
  crc       = 0x4fe2a0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8dȎ%p\\xb1\\xb0~\x10C\\xd4U\\xe2?Gn'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x5df9cb70
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd a492761fef3428a437858cfef31ab83f
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 53d8ba5b2a6cdda97177aa9cbb3b55ca
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x5df9cb70
  crc       = 0xe11928
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Sغ[*lݩqw\\xaa\\x9c\\xbb;U\\xca'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5df9cb70
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x5df9cb70
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x5df9cb70
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5df9cb70
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afab
dec_pkt 7ad3
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  35:a4:8d:16:f4:ec
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf1d9088b
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf1d9088b
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf1d9088b
  crc       = 0x52ea9f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xbe\\xfdח\\x8d\\xaf\\xf0\\x9f\n\\xee9\\x82G\x17\\xfb\\xb3'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf1d9088b
  crc       = 0xe2b95d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xbe%\\xd1\x1c\x04r4\x0b\\xbe\\xbcRl\\x9e%ƞ'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf1d9088b
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3cae52f50bf78ecb5f8e400aca3fcf8d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e2b85ad93b2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf1d9088b
  crc       = 0x8d743f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^+\\x85\\xad\\x93\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf1d9088b
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf1d9088b
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xf1d9088b
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf1d9088b
  crc       = 0x2e198d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xcef5197d1f00e88d
           ediv      = 0x2aa8
           skdm      = 0x4df7a5b379af3a18
           ivm       = 0xf6a60389

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf1d9088b
  crc       = 0x2e198d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xcef5197d1f00e88d
           ediv      = 0x2aa8
           skdm      = 0x4df7a5b379af3a18
           ivm       = 0xf6a60389

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840e
dec_pkt fc0a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf1d9088b
  crc       = 0x9048fa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x69b344c4c6695818
           ivs       = 0xba2b3132

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c6:0d:9e:ab:32:51
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0x809d1c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '`\\xff\\x8f\\x86L\\xb2\\xba(\\x91\\x93\x1e\\x9a\\xe8fB\x18'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0xcde60a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'ê\\x88\\xc3}\\xe3%7\\xb58\t(\\x97ħK'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 8eb3213d6e58c327dd92492c2840b04c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 60ebce76b075673bed54899375aac4cd
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0x6e59ce
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '`\\xeb\\xcev\\xb0ug;\\xedT\\x89\\x93u\\xaa\\xc4\\xcd'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0x946bc5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb3cd9613b5dd1cc0
           ediv      = 0xdad
           skdm      = 0x623d9be2a3505741
           ivm       = 0x9c71e399

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0x946bc5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb3cd9613b5dd1cc0
           ediv      = 0xdad
           skdm      = 0x623d9be2a3505741
           ivm       = 0x9c71e399

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840e
dec_pkt fc0a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0x946bc5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb3cd9613b5dd1cc0
           ediv      = 0xdad
           skdm      = 0x623d9be2a3505741
           ivm       = 0x9c71e399

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0x779d67
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc252a8a1bb78dbcd
           ivs       = 0x8d9ec875

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x881529f1
  crc       = 0x779d67
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc252a8a1bb78dbcd
           ivs       = 0x8d9ec875

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  d7:46:0c:9f:4e:70
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x8cbe0f3c
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x8cbe0f3c
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x8cbe0f3c
  crc       = 0x69a8d3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa2\\xfc\\xd1\\xc9\\xe0\\x88]U̳\x04\\xc9͆Q\\xa9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x8cbe0f3c
  crc       = 0x990488
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8b\\xe6_,j\\x8dR\\xb5\\x8euͬ\\xc1vH\x04'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x8cbe0f3c
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c260723a83921012e31b960aa64736ad
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb66a6b075b7cadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x8cbe0f3c
  crc       = 0x9d042e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebf\\xa6\\xb0u\\xb7\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x8cbe0f3c
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8cbe0f3c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x8cbe0f3c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x8cbe0f3c
  crc       = 0xddfade
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xf4f9b6abb459a5e3
           ediv      = 0xb482
           skdm      = 0x7abd53d913bac3e5
           ivm       = 0x69ec2d35

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x8cbe0f3c
  crc       = 0xddfade
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xf4f9b6abb459a5e3
           ediv      = 0xb482
           skdm      = 0x7abd53d913bac3e5
           ivm       = 0x69ec2d35

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840e
dec_pkt fc0a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  1d:aa:bb:4c:35:26
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xcadb7bb9
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xcadb7bb9
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcadb7bb9
  crc       = 0x976cae
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'xg\\xc0\\xf27\\xd6j*\\xa9Y\x00\\x97\\xa1ZtF'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcadb7bb9
  crc       = 0x9df13a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '7\\xdf\x1e\x08\\xd4~\\x96x\\xf9\\xa6a\\xebD\\xe3\\xbbL'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xcadb7bb9
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 006277a176c670feac25de0e70cde072
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 6cddd90eb6ee6c073955e2e29f2a71f5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xcadb7bb9
  crc       = 0xf9ecc2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'l\\xdd\\xd9\x0e\\xb6\\xeel\x079U\\xe2\\xe2\\x9f*q\\xf5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcadb7bb9
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcadb7bb9
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xcadb7bb9
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcadb7bb9
  crc       = 0x69b7c2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xdd1b8e1864e69d8c
           ediv      = 0xbb4b
           skdm      = 0xb40360a5bdcaabaf
           ivm       = 0x77e92930

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcadb7bb9
  crc       = 0x114482
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x1610a00cfce6ac6d
           ivs       = 0xddf9e450

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcadb7bb9
  crc       = 0x114482
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x1610a00cfce6ac6d
           ivs       = 0xddf9e450

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  25:3a:7c:fe:43:36
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0x456c97
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb6\x14M!\\xd7\\xc1\\xfa\t\x1c\\xb6\\x8b\\xa0m.\\xbc}'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0x6b8e7d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '߇\\xab\\xf1\\xe6\\xe6X\\xc2\x1b/y3:Ǡ\x13'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 447758195e60591e020ee5bb746450a3
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2f64b93b35b2dc9d1a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0x5fecdd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/d\\xb9;5\\xb2ܝ\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0x3243bc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xa101237db45640d0
           ediv      = 0x4b15
           skdm      = 0xe886e0def51589c2
           ivm       = 0x9acac028

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0x43839e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4cddef9d98a31a55
           ivs       = 0x276418a7

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0x3243bc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xa101237db45640d0
           ediv      = 0x4b15
           skdm      = 0xe886e0def51589c2
           ivm       = 0x9acac028

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0x43839e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4cddef9d98a31a55
           ivs       = 0x276418a7

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x18f1b5fe
  crc       = 0x43839e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4cddef9d98a31a55
           ivs       = 0x276418a7

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  53:d3:50:e3:bb:63
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x3237e42a
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x3237e42a
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3237e42a
  crc       = 0x6c5417
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x06\x11\x07p{k\x14Ŗ\x04\\xcf@fȑ\\xd7'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3237e42a
  crc       = 0x93e363
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'T\\xd0\\xf9\\xd1\\xf4$$\\x9f}\\xb1e[\\xff\x05\\xf6\\xd6'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x3237e42a
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd fff99bdaaa86eae4ad51141c8ee6a7a6
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd b6ee6c075b77b6039f2a71f54c95b8fe
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x3237e42a
  crc       = 0xc8f43
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xb6\\xeel\x07[w\\xb6\x03\\x9f*q\\xf5L\\x95\\xb8\\xfe'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3237e42a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x3237e42a
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x3237e42a
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3237e42a
  crc       = 0x8c3888
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x68442b0fc114940d
           ediv      = 0xf563
           skdm      = 0x2e45390a6f1316cf
           ivm       = 0xb6bb86d0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3237e42a
  crc       = 0xa4abc8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xb3cd4d28a0a6af6a
           ivs       = 0x1b02a254

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  50:ce:80:f8:cf:be
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x72de03fb
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x72de03fb
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x72de03fb
  crc       = 0x4d5f43
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = ';5 q/\\xf2\x00n,\\xf6\\x9eX\\xb2z\\x87B'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x72de03fb
  crc       = 0xe7a37
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xfbjJW\\x97?\\xb2\\xa8o\x15\\xf1\x0b9\\xb3^\\xf4'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x72de03fb
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 0d6e57d3b9ae87172b94656edfb0d357
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 53d8ba5b2a6cdda97177aa9cbb3b55ca
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x72de03fb
  crc       = 0xd69c24
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Sغ[*lݩqw\\xaa\\x9c\\xbb;U\\xca'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x72de03fb
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x72de03fb
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x72de03fb
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x72de03fb
  crc       = 0xe4adb9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xbf28ec96b361b9a8
           ediv      = 0x5892
           skdm      = 0xd227aef143185e1c
           ivm       = 0x1888bc7b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x72de03fb
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x72de03fb
  crc       = 0xd2d3a9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc9d88e843357d946
           ivs       = 0xc0d0fe8e

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  30:24:06:59:c6:49
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0x60b471
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "n\\xc1\\xf7p\\xef\\x9a`\\x99\\xff'\\xe5\\xeab\x11@\\x83"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0x45205
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '$*\t\\xc5\x02\x11\\xbc\x10p\\xec\\xfc\\xaf\\x80\\xac\\xce}'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 1ba486a5d5c17e9036897afebb0e991c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0xfa0a13
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0x6fd840
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x954a3ce6b34ba4d9
           ediv      = 0x2edf
           skdm      = 0x5cf05208a4b7f612
           ivm       = 0xf9895f23

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0x6fd840
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x954a3ce6b34ba4d9
           ediv      = 0x2edf
           skdm      = 0x5cf05208a4b7f612
           ivm       = 0xf9895f23

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0x70eea9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x3562912e8dfd70ed
           ivs       = 0xf3dd654c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x77ce0f17
  crc       = 0x70eea9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x3562912e8dfd70ed
           ivs       = 0xf3dd654c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  4f:a3:dc:6a:b0:8f
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xab8dcdae
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xab8dcdae
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xab8dcdae
  crc       = 0x33c694
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1f\\xeaBƬ\\xad\\xc3\\xfb\\xaf\\x85t\\xbd\\xf5xS\\xaa'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xab8dcdae
  crc       = 0x62a18e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'SJ2\\xff\\x99ZW\\x93۞\\xa0\\xf44\\x95\\xd8\\xe8'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xab8dcdae
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 9f412ab15236a6663b4c8771865c9261
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2e5e2b5717af952b92b91ff9c9dc8f7c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xab8dcdae
  crc       = 0x5e8bbe
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '.^+W\x17\\xaf\\x95+\\x92\\xb9\x1f\\xf9\\xc9\u070f|'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xab8dcdae
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xab8dcdae
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xab8dcdae
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xab8dcdae
  crc       = 0x36e4b9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x216352b321228a37
           ediv      = 0x6ef6
           skdm      = 0x3eaccbe85b8062cd
           ivm       = 0x9dbc1013

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xab8dcdae
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  92:b3:02:01:d8:eb
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x9e3a4461
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x9e3a4461
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9e3a4461
  crc       = 0xacee4c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x11\x1b\x01\x1d\\xe1\\xf6\\x99\r\x07\\x88\\xb1\x15\\xec\\xc39\\xdb'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9e3a4461
  crc       = 0xc241c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'ĩPV\\xe3\\xc3U1\\xa0ڗ\\x90\\x8e\x03\\xee\x1b'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x9e3a4461
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 87fc29026ffe11f8eb45a6873d3a5f77
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x9e3a4461
  crc       = 0xcd8f1f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9e3a4461
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9e3a4461
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x9e3a4461
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9e3a4461
  crc       = 0xacd08
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb00734328081fc88
           ediv      = 0x8a59
           skdm      = 0xabd3774de68960a9
           ivm       = 0xf3d22329

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9e3a4461
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9e3a4461
  crc       = 0xd7319d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x18b84b0417f8c4
           ivs       = 0x473b060c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  95:23:c9:9e:3e:84
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0x83fd86
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'b\\xe1m\x0c5\x14>\x10l\\xb3Q \\x8a\\xb3;\\xf1'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0xdb9b41
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xfe=4k/:Tí=\x03Z\\x98\\xba\x105'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 444acdf0a9ccce1a3579a072ebecfc5f
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 6cddd90eb6ee6c073955e2e29f2a71f5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0xf9ecc2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'l\\xdd\\xd9\x0e\\xb6\\xeel\x079U\\xe2\\xe2\\x9f*q\\xf5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0x3047b4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x6100d46924548084
           ediv      = 0xecf
           skdm      = 0x44ee60ba3987fa4
           ivm       = 0x1d06c674

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0x3047b4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x6100d46924548084
           ediv      = 0xecf
           skdm      = 0x44ee60ba3987fa4
           ivm       = 0x1d06c674

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0xb0f26
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x24befba5a111949d
           ivs       = 0x3cecac0b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x149fb3a5
  crc       = 0xb0f26
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x24befba5a111949d
           ivs       = 0x3cecac0b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  30:6c:1d:42:dc:57
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x43c3d3fc
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x43c3d3fc
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x43c3d3fc
  crc       = 0x8a374d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'k\x0e\\xb1z\x11\\x8b\\xe1{#\\x8a\\xb1\\xa8\\xc1\\xa0\\xa4\\xac'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x43c3d3fc
  crc       = 0x726d6f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x0f\x0b\\xa1\\xa0\\xb3\\xdcr\\x9b\\x88>\\xc7p,&JV'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x43c3d3fc
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3372050463d7e6c12087487982709b25
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cd4b61eb662f77a782cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x43c3d3fc
  crc       = 0x57cc1a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6\\xcdKa\\xebf/w\\xa7\\x82\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x43c3d3fc
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x43c3d3fc
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x43c3d3fc
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x43c3d3fc
  crc       = 0xaa5cb3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x26ed7fa941882324
           ediv      = 0xb5d3
           skdm      = 0xd2b7094d47c5a15f
           ivm       = 0x515450da

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x43c3d3fc
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  d8:fb:57:f0:d9:36
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x6c19df8c
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x6c19df8c
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x6c19df8c
  crc       = 0xf8dc49
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'Q\\xe01KF\\xa8\\xf2\\xc6\\xe7\\xea\\x80q\\xba\\xdc\\xca\x04'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x6c19df8c
  crc       = 0xb6fa14
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x90\n\\xb5\\xaf\\xf4\\xd9\\xe8\\x8bͺ6\x01Bf\\x85t'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x6c19df8c
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 73b7443a0668c768075b7c95508af89a
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 095b77ae87ad3bd3ef4e957074a74abc
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x6c19df8c
  crc       = 0x8bdd08
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\t[w\\xae\\x87\\xad;\\xd3\\xefN\\x95pt\\xa7J\\xbc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x6c19df8c
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x6c19df8c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x6c19df8c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x6c19df8c
  crc       = 0x4e234d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xdbfc2bd3d4bc98ed
           ediv      = 0x5bed
           skdm      = 0xfc83cd5dfc144972
           ivm       = 0xcdb6f34a

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x6c19df8c
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8407
dec_pkt fc03
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x6c19df8c
  crc       = 0x394f4c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x8452b7ffd27669d7
           ivs       = 0x77748551

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f2:ee:29:99:f6:40
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0xb00866
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc5Q\\x97_\\x99F\\xc5tcN\\xb0\\xaf\\xf0\\xf0|W'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0x43f7a9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '-\x01gX\x08\\xe4\\x84q\\xea\\xbc#\\xe2\\xf3\\xd1\n%'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e4538ea818c45c9c9f6acf1180a8e5bd
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 44296cbda214b65e64b93b35b2dc9d1a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0xfd2e65
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'D)l\\xbd\\xa2\x14\\xb6^d\\xb9;5\\xb2ܝ\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0xdec787
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x65a4356cab29d46d
           ediv      = 0xf075
           skdm      = 0x7e465576273455e8
           ivm       = 0x6ddb4df6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8407
dec_pkt fc03
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0xdec787
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x65a4356cab29d46d
           ediv      = 0xf075
           skdm      = 0x7e465576273455e8
           ivm       = 0x6ddb4df6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0x89538
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd169abe8ea1fba1b
           ivs       = 0x439414e2

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x830f534e
  crc       = 0x89538
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd169abe8ea1fba1b
           ivs       = 0x439414e2

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  25:08:8c:f2:f9:72
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x1beb60e4
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x1beb60e4
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1beb60e4
  crc       = 0xfe7f53
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x96\\xb3\\xcf\x11\\xbe\\xfa\\x8e휱\\xc2<\\xf3z\\xcc\x01'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1beb60e4
  crc       = 0x147e26
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb6\\xfe\\xd5\x01\x02\\xdf\x17\\xca\x07\\x952\\xd48\\x8a\x0f\\xf8'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x1beb60e4
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 8bfd151b0f9ee49b3b5241075ff3e4c0
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 3b4a61c31ea5b0e54996bb4b27cbdda1
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x1beb60e4
  crc       = 0x474df8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ";Ja\\xc3\x1e\\xa5\\xb0\\xe5I\\x96\\xbbK'\\xcbݡ"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1beb60e4
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x1beb60e4
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x1beb60e4
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1beb60e4
  crc       = 0x758541
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x52a085b23199f9d4
           ediv      = 0x42b7
           skdm      = 0x84a9d578e16cf217
           ivm       = 0x15f7dcee

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1beb60e4
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8407
dec_pkt fc03
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  ef:f8:79:4e:69:0d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x9588f472
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x9588f472
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9588f472
  crc       = 0x2bea96
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xfb\\xd6\x06\\xdfY\\xab\\x95\x00\\xc7\x0f\\x9a\\xbf\\x83q\x04\\xf8'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9588f472
  crc       = 0x71fd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x05\\xbf\x04\\xf8\\x9dd\\xc43\\xe4+\\xd8]Cz\\xe6\\xa2'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x9588f472
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 8779e70f3463deb8f6801d799fea613e
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x9588f472
  crc       = 0xb4e024
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9588f472
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9588f472
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x9588f472
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9588f472
  crc       = 0x8a912c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xc9108cf7237d09c
           ediv      = 0xa22
           skdm      = 0x3ca31125d855b594
           ivm       = 0xf6a10fcb

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9588f472
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8406
dec_pkt fc02
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9588f472
  crc       = 0xc57d97
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x88764d709d728a37
           ivs       = 0x6c5debb3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  1b:a8:33:fb:8a:cd
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0x4e45af
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'ܷ\\xf3\\xff]\\x8dx\\xb2\\xbc5\\xa7%N\x01\\xdes'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0x6c52c0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1f\\x91\x19^-\\xe8\\xf0Ê\\x8a\\xc96\\x81L\x1dt'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 9e0f9af187017523604152dc7ec398cb
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 60ebce76b075673bdda9122fed548993
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0x515efa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '`\\xeb\\xcev\\xb0ug;ݩ\x12/\\xedT\\x89\\x93'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0xe69a04
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x144754b5e87232dc
           ediv      = 0x5a9
           skdm      = 0xc7284e9dbc8a3050
           ivm       = 0xba1666f9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8406
dec_pkt fc02
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0xe69a04
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x144754b5e87232dc
           ediv      = 0x5a9
           skdm      = 0xc7284e9dbc8a3050
           ivm       = 0xba1666f9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0xa8305a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4a07814940479803
           ivs       = 0xc2d8e9c6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3c7b3cc0
  crc       = 0xa8305a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4a07814940479803
           ivs       = 0xc2d8e9c6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  38:08:87:3b:de:45
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x211e1ed6
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x211e1ed6
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x211e1ed6
  crc       = 0x947169
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\n\\x9d\\xfd\\x88G\\xd1\\xc6\x15\x00\\xf7\\xb7b\\\x1c\\xfcz'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x211e1ed6
  crc       = 0xd461a6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x85_\\x8a\\xaf}1\\x8f\\x9b\\xf5ĵ\\xa0Y3\x02\\x83'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x211e1ed6
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 23a0c12cb898a7b09f99067db3e0be38
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 1ea5b0e544296cbd90e5eed464b93b35
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x211e1ed6
  crc       = 0xe0f02f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x1e\\xa5\\xb0\\xe5D)l\\xbd\\x90\\xe5\\xee\\xd4d\\xb9;5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x211e1ed6
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x211e1ed6
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x211e1ed6
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x211e1ed6
  crc       = 0x34c67b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xa8898494e9a462dd
           ediv      = 0x3920
           skdm      = 0xc14074d78955a4cb
           ivm       = 0xce5ee7b0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x211e1ed6
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8406
dec_pkt fc02
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  16:77:62:e3:2b:b9
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xd0907791
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xd0907791
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd0907791
  crc       = 0x27be1d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '@\\xd5\x0b\\x8c5\\x9d\\xa7\\x83\\xfc\\xe7(6\\xb9\\xa4\\x85\\xaf'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd0907791
  crc       = 0xf27b6c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '?\\x9e\\xcfaA\\xaf\\xb3\\xee\\xb6\\xc5˸\\xea\\x9c+\\x91'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xd0907791
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 998859fdcb39f39e74b623d764f6b435
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xd0907791
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd0907791
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd0907791
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xd0907791
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd0907791
  crc       = 0x1ec2ab
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x8c36ff5d062c65b
           ivs       = 0x69e4fd07

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd0907791
  crc       = 0xd870af
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x76651b00670230ff
           ediv      = 0xa040
           skdm      = 0x74b4a44af36f9ffc
           ivm       = 0x7bb8a640

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840e
dec_pkt fc0a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd0907791
  crc       = 0x1ec2ab
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x8c36ff5d062c65b
           ivs       = 0x69e4fd07

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  6b:c3:21:f8:73:9e
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0x3a8ee9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x0e\\xbcó[Q\\xc5\\xf6\\xf8BF\\xb6\\xde\x00\x7f'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0x2415bc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf4σ\x1c\\xd4\x12T"\\xeb&\\xb9;"ȫv'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd abc3bceab0a6da491a2c9e3aaad947b7
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd c0d69ded60ebce76ba53255eed548993
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0x6ea589
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xc0֝\\xed`\\xeb\\xcev\\xbaS%^\\xedT\\x89\\x93'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0x60ff35
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xae27fb22fabb0c23
           ivs       = 0x6dd067e2

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0x5a1fde
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb94b28518d6e8d16
           ediv      = 0x76cb
           skdm      = 0x25be819e5f39178
           ivm       = 0x7fc7ddcf

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840e
dec_pkt fc0a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0x5a1fde
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb94b28518d6e8d16
           ediv      = 0x76cb
           skdm      = 0x25be819e5f39178
           ivm       = 0x7fc7ddcf

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0x60ff35
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xae27fb22fabb0c23
           ivs       = 0x6dd067e2

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4b4b4bb7
  crc       = 0x60ff35
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xae27fb22fabb0c23
           ivs       = 0x6dd067e2

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  68:12:bf:51:1b:7c
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x98a1501e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x98a1501e
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x98a1501e
  crc       = 0x4c96e6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x7f\\xbfM\x01O\\xa4:\\x99\\x94\\xd0\\xfba^[\x1a\\x96'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x98a1501e
  crc       = 0x297fa3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\\xa7\\xab\x0b\\xc3\\xef\x02 \\xafՉ\x07'\x12\\xea\x00\x12"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x98a1501e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 72816f60cbcb6c5fc7ab41f7520cce93
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb6653d8ba5bcadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x98a1501e
  crc       = 0x231621
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebfSغ[\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x98a1501e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x98a1501e
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x98a1501e
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x98a1501e
  crc       = 0xb29227
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9c7da153a9ef5f3e
           ivs       = 0x6aa95921

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x98a1501e
  crc       = 0x56eb61
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb3aae133d524977
           ediv      = 0xe6ee
           skdm      = 0x74fe56af05296440
           ivm       = 0x806d1211

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840e
dec_pkt fc0a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  49:3a:69:68:a5:9b
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x811b1493
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x811b1493
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x811b1493
  crc       = 0xe4c9b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\\xa5\\xf0\\xc1)'9\\xeeH6\\xf3Pnй\x06G"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x811b1493
  crc       = 0xb9374f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd4\\xfe\\xbbda\x191\\xdd_\\x96\\x93\\xee\x0b;\\xe6\\xe9'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x811b1493
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd fca56d3e80d9c466191c265cfe11fb29
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd bf78ad545cbc56ae41e67efc92b91ff9
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x811b1493
  crc       = 0xc6c11
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xbfx\\xadT\\\\xbcV\\xaeA\\xe6~\\xfc\\x92\\xb9\x1f\\xf9'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x811b1493
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x811b1493
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x811b1493
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x811b1493
  crc       = 0x65d8c3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe4978ceaca52a249
           ivs       = 0x76284cf9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x811b1493
  crc       = 0x65d8c3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe4978ceaca52a249
           ivs       = 0x76284cf9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x811b1493
  crc       = 0x65d8c3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe4978ceaca52a249
           ivs       = 0x76284cf9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  4b:48:93:7d:ae:76
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0xf88caf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc1\x13\\xd2\\xe7ݸ\x11D\\xf0\x02\\xd5\\xebـ\x07\\xd3'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0xcb1d4d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8b\\xb2\\xf7\\xc0\\x92\x10\\xe9\\x80\\xe3\\xc6GA\\xeb\x16\\xc9A'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd aac97929e69e62374264b9aa69001ced
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0x36787a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x8f6f40b2a23f2b38
           ivs       = 0x389b6cc4

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0x36787a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x8f6f40b2a23f2b38
           ivs       = 0x389b6cc4

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0xc09e4a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x66e709fead8265b0
           ediv      = 0x6f64
           skdm      = 0xd69619b328343fea
           ivm       = 0x58d0ff46

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0x36787a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x8f6f40b2a23f2b38
           ivs       = 0x389b6cc4

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x18d12ba2
  crc       = 0x36787a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x8f6f40b2a23f2b38
           ivs       = 0x389b6cc4

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  fc:01:96:17:86:1c
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xea4a8dd4
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xea4a8dd4
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xea4a8dd4
  crc       = 0xf9f820
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x98X\\xe7\\xd8\\xd0Ȭj\\xd8W\\xf5P\\xfcO\x17\\xf3'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xea4a8dd4
  crc       = 0x775823
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x06\\x9a\\xb3\x7fQ\\x87\x01d\\x92\\xc1\\xf3\\x84Qf\x1a\\xd3'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xea4a8dd4
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 31d3bc7eb0541b0688fd1127bfc6cbc0
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 15b6ee54095b77aede9d2ae174a74abc
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xea4a8dd4
  crc       = 0x3e879
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x15\\xb6\\xeeT\t[w\\xaeޝ*\\xe1t\\xa7J\\xbc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xea4a8dd4
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xea4a8dd4
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xea4a8dd4
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xea4a8dd4
  crc       = 0xb3fd83
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf7d2287f1f04da18
           ivs       = 0x53af340b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xea4a8dd4
  crc       = 0xb3fd83
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf7d2287f1f04da18
           ivs       = 0x53af340b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  ef:ff:44:33:dd:bd
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4c0170be
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4c0170be
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4c0170be
  crc       = 0x937d75
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '%yp\\xb1\x05V8!%#\\xf3\\x93ڥ{'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4c0170be
  crc       = 0x1d9379
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '_X]Ў\\xf2YҦ\\xe2!c\\x9eP\\xafZ'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4c0170be
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 5d75433c6b7f554927de4f8583716d46
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad934b61eb662f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4c0170be
  crc       = 0xcce16e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93Ka\\xebf/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4c0170be
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4c0170be
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4c0170be
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4c0170be
  crc       = 0x4969e8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd7d3c65e40df7cce
           ivs       = 0xb5aa4730

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4c0170be
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4c0170be
  crc       = 0x4969e8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd7d3c65e40df7cce
           ivs       = 0xb5aa4730

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  9b:2b:33:52:1c:99
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0x5eb939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'Xk\\x9e~\\xbc\\xeeL\x01\\xc2A\\xa4\\xc9K?Ч'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0x8ab004
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'i\\xaf\x10=\x10\x0f:ZHb\\xafS|ث\x0e'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 5f46fb7f89ecb961be63e7929286ed39
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 095b77ae87ad3bd3ef4e957074a74abc
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0x8bdd08
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\t[w\\xae\\x87\\xad;\\xd3\\xefN\\x95pt\\xa7J\\xbc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0x389c5e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa68d2c776a7a2a38
           ivs       = 0xce631090

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0xd22b8f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x504d09eddf5a85
           ediv      = 0x85b5
           skdm      = 0xe87723cd09e2878a
           ivm       = 0x44aa74b8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0x389c5e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa68d2c776a7a2a38
           ivs       = 0xce631090

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x879c5fd4
  crc       = 0x389c5e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa68d2c776a7a2a38
           ivs       = 0xce631090

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  d5:c4:d7:24:90:16
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x76ec5467
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x76ec5467
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x76ec5467
  crc       = 0x9b9091
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd2\x0bଭ\\xf6CX\\xd7\x1aQ\\xfc\x07\\x93J['

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x76ec5467
  crc       = 0x7403ac
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '8RKf;yƘOlW\\xf5\x14m\x1eH'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x76ec5467
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 00d00c0baf172aafd21043f5b335fdde
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x76ec5467
  crc       = 0x77130c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x76ec5467
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x76ec5467
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x76ec5467
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x76ec5467
  crc       = 0x83448b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x1f4f05ceb1fcdf61
           ivs       = 0x5411f03e

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x76ec5467
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  63:95:ed:f2:31:6f
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x8b985129
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x8b985129
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x8b985129
  crc       = 0xb6761f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'v\\xba\\x8a\\xcdd\\xd7\\xf0\\xd4\\xf0+\\xf2\\x82լ\\xdd-'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x8b985129
  crc       = 0xd0ed8a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xbc2H\\xc5iz\\xe1`J\\xe2\x08\\xa6\\xa2qdd'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x8b985129
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd d1372d2e45f00b54c44c930a3d442732
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x8b985129
  crc       = 0x836528
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x8b985129
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8b985129
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x8b985129
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x8b985129
  crc       = 0xb543be
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x575d17583a9c08c9
           ivs       = 0x2ccc69f7

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x8b985129
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x8b985129
  crc       = 0xb543be
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x575d17583a9c08c9
           ivs       = 0x2ccc69f7

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  92:37:75:27:74:20
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0x9d2bcc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'X#\\xb4h>=\\xe3\x01\\xef\\xd5\x14ԗ$\\x89j'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0xd2146d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '`SK\\x8a\\xea\x1d\\x88\x17\\x92P\\x8fоa\\xddm'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 75ae551d0c505afe8c35f9ec43c82836
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 3b4a61c38f52d87227cbdda1c872776a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0x558d0b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ";JaÏR\\xd8r'\\xcbݡ\\xc8rwj"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0xcc42
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x124bf45b464c7089
           ivs       = 0x7d6ea742

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0xe1f861
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x2ceb897821a6729b
           ediv      = 0x5f1a
           skdm      = 0xc3b6a857d8472eb5
           ivm       = 0xa3588d45

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0xcc42
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x124bf45b464c7089
           ivs       = 0x7d6ea742

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7c169655
  crc       = 0xcc42
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x124bf45b464c7089
           ivs       = 0x7d6ea742

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  0a:0b:23:e9:04:64
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xd9850e54
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xd9850e54
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd9850e54
  crc       = 0xe1c5c7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\u05feF\\x83\\x85\x02\\x92\x1dYї'Y\\xec\t\x11"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd9850e54
  crc       = 0x41093a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'cU\\xbcTٍ\\xf5G\\xa1\\x82\\\\xfd\\xec{\\xe8\\xfc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xd9850e54
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd a52c00e211c62fccaa8cd7e330776441
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 44296cbda214b65ec872776ab2dc9d1a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xd9850e54
  crc       = 0x5f2660
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'D)l\\xbd\\xa2\x14\\xb6^\\xc8rwj\\xb2ܝ\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd9850e54
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd9850e54
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xd9850e54
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd9850e54
  crc       = 0x56b87
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x577118701b14c880
           ivs       = 0x10b64145

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd9850e54
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  77:dd:22:45:12:4e
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x168ba9ab
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x168ba9ab
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x168ba9ab
  crc       = 0x5cb8b8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xac\x1b\\x90=\\xe8A\\x8d\\xeb\x0f\\xb5\\xfd\\xd6U\x19\\xff/'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x168ba9ab
  crc       = 0xbb6a33
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb4N\x1c\\xdc+1\\x9a\\xfaտ\x11\\xa2\\x9c\x0f\\xd6\x08'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x168ba9ab
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 568b6ecc596c50ac27687e38f9197327
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b753d8ba5be5ee54317177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x168ba9ab
  crc       = 0x46998c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7Sغ[\\xe5\\xeeT1qw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x168ba9ab
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x168ba9ab
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x168ba9ab
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x168ba9ab
  crc       = 0xb201f9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa1689ca3f6a8c86c
           ivs       = 0x7fcc6388

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x168ba9ab
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8407
dec_pkt fc03
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x168ba9ab
  crc       = 0xb201f9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa1689ca3f6a8c86c
           ivs       = 0x7fcc6388

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  5d:84:a8:05:09:2b
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0x76f41b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1eo\\xbeYa%Am\\xa2R42m\t\x0f\\x87'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0x6edd9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'I6\t\\x9d\\xebL\x1f.\\x9fN\\xf9\\xce\\xd0+q\\x9d'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 72406de1806f3b12c45d640a9fc1e279
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 87ad3bd3c0d69ded74a74abcba53255e
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0x6bd425
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x87\\xad;\\xd3\\xc0֝\\xedt\\xa7J\\xbc\\xbaS%^'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0x337334
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x48a6932310fc7541
           ivs       = 0xe7285bdb

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8407
dec_pkt fc03
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0x861851
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xd142675cf8330a52
           ediv      = 0x9a4f
           skdm      = 0x25ff74d5bc37263b
           ivm       = 0xd7aa8293

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0x337334
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x48a6932310fc7541
           ivs       = 0xe7285bdb

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdf92a2ac
  crc       = 0x337334
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x48a6932310fc7541
           ivs       = 0xe7285bdb

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  e3:17:09:cb:f8:35
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x7c118c24
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x7c118c24
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7c118c24
  crc       = 0x42e135
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'C\\xde\x03\\xfa\\xbby\\xf1J}EՃ\\xfd\\x9c\\xee\\xa9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7c118c24
  crc       = 0xf14e98
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc7۟HL\\xbc]\\xa1\\x8aΩ,&\x10\\xa0\\x8b'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x7c118c24
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 0817664555843e687d76d0449e88b7b5
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad93b2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x7c118c24
  crc       = 0x417199
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7c118c24
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x7c118c24
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x7c118c24
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7c118c24
  crc       = 0xaabad1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xccee4dcff107598a
           ivs       = 0x1512ca13

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7c118c24
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8407
dec_pkt fc03
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  09:c1:9b:66:a9:54
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x26b52d5
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x26b52d5
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x26b52d5
  crc       = 0xae10f8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '*\\x8bui<s\\xb4\\xe0\x0c\x075cl\\xa9[\\xb6'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x26b52d5
  crc       = 0xcbc5dd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '.\\xab\\xa2\\xebq\\xfc\\x9a`\x7f\\xa0\x1c\\xd2\\xf3xP%'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x26b52d5
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 9a71f15b6d3ac544dd297ecc65558e18
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b753d8ba5bcadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x26b52d5
  crc       = 0xaaa62
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7Sغ[\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x26b52d5
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x26b52d5
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x26b52d5
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x26b52d5
  crc       = 0xfa3633
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa083b4e862b02b6f
           ivs       = 0xfb7f19d2

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x26b52d5
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8406
dec_pkt fc02
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x26b52d5
  crc       = 0xfa3633
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa083b4e862b02b6f
           ivs       = 0xfb7f19d2

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a6:18:82:2f:c8:3f
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0x5d4f34
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'B\\xaf\\xa8n\\xf9\x15\\xea\x16\\xc7\\xf5A\\xb3P\x00\\xe9\\xd9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0xad001e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xbe\\xce\x05G,\x04\x1f\\xe3\x04\x1e\\xf5\\xdb\x08\\xea\\xf3*'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 8205adedac697655a60fd152784839c3
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 15b6ee54095b77aeef4e957074a74abc
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0x361804
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x15\\xb6\\xeeT\t[w\\xae\\xefN\\x95pt\\xa7J\\xbc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0x3812d9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9a0a0831dcbfc484
           ivs       = 0xd15ce768

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8406
dec_pkt fc02
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0xaa1c61
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb641c0d68707fd48
           ediv      = 0xeda1
           skdm      = 0x48ea2988055232d5
           ivm       = 0xc0ad06da

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0x3812d9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9a0a0831dcbfc484
           ivs       = 0xd15ce768

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcf4ad7e5
  crc       = 0x3812d9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9a0a0831dcbfc484
           ivs       = 0xd15ce768

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  45:9e:ca:18:87:a1
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x548dfe53
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x548dfe53
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x548dfe53
  crc       = 0x87d5ad
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = ']\\xfe\x10٤7\\\\xee\\xbd\x02\x03\\xf1\x02\\x9d\\xfaM'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x548dfe53
  crc       = 0x40ccfc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '$\\xf6\\xe7\\xff\x0cq`,\\xcc\x14E\\x99\\xbe\\xd1\\xeb\\xc8'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x548dfe53
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd f4a7b2a41e187ebbfe9c6264d17db77d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f96c2d6cd59ee4e0d94bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x548dfe53
  crc       = 0x5fce27
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/\\x96\\xc2\\xd6\\xcdY\\xeeN\r\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x548dfe53
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x548dfe53
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x548dfe53
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x548dfe53
  crc       = 0x9ffb34
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x6e8ec5242dfcd1c7
           ivs       = 0xd536a7a6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x548dfe53
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8406
dec_pkt fc02
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  29:f7:d8:80:c2:4a
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xe7c4aa87
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xe7c4aa87
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe7c4aa87
  crc       = 0xf20360
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'l\\xd8\\xfd\\x94?\\xc5|\\xed\x13\\xc4{\\xf94p\\xa0\\x84'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe7c4aa87
  crc       = 0x75e5dd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'D\\xd4]A\r]\\xac\\xbf\\xdfy~\\xa8\x01\\x8d\\xf8['

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xe7c4aa87
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3e71d2f8df7347626a5aaff51118337f
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad93b2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xe7c4aa87
  crc       = 0x76f495
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe7c4aa87
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xe7c4aa87
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xe7c4aa87
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xe7c4aa87
  crc       = 0x7c23b6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x539abe9925a94ec8
           ivs       = 0x729e17d4

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xe7c4aa87
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe7c4aa87
  crc       = 0xa49ea1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb04bc0759a868399
           ediv      = 0x9c16
           skdm      = 0xe6b44d67f0756702
           ivm       = 0xa11ddc5d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xe7c4aa87
  crc       = 0x7c23b6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x539abe9925a94ec8
           ivs       = 0x729e17d4

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  cd:bb:61:26:18:91
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0xff63ec
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x0ct\\xd0\t\\xd7j\\xa7\\xe7/U7\\x98\\xc8/}U'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0x8ea286
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'E\\xa8Ϲ\\x82\\xeds\\xab;I3ZG\\xa1\x1c\\x9b'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 9ce944a79ed83cdaa22a163928468cc8
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0x53213a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xce64877b3976f42
           ivs       = 0xce447b30

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0xf6183a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x5db8a4aa3a73ce96
           ediv      = 0x17e
           skdm      = 0xbc7fc4feeebd8ae9
           ivm       = 0x97484c4

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0xf6183a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x5db8a4aa3a73ce96
           ediv      = 0x17e
           skdm      = 0xbc7fc4feeebd8ae9
           ivm       = 0x97484c4

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08d
dec_pkt 32c0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0x53213a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xce64877b3976f42
           ivs       = 0xce447b30

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa2eb36a9
  crc       = 0x53213a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xce64877b3976f42
           ivs       = 0xce447b30

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  b7:3d:af:ad:f1:99
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x7c36ba7e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x7c36ba7e
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7c36ba7e
  crc       = 0x606339
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xfe1o\x0e\\x81fp\\xe3pa*\\x8fh\\xeb\\xe9\x19'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7c36ba7e
  crc       = 0x525b00
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '*\\x94\\xb1\\x91\\xb6\x04\\xcaB\\x8b\\xdf\\xe0Nl\\xce\\xc7\x15'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x7c36ba7e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 051b70789d664d645de09184039c5ba3
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad934b61eb6694bb53c5cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x7c36ba7e
  crc       = 0xb61410
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93Ka\\xebf\\x94\\xbbS\\xc5\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7c36ba7e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x7c36ba7e
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x7c36ba7e
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7c36ba7e
  crc       = 0x1fbd3b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xba65862fda518a7c
           ivs       = 0x3853bdb1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7c36ba7e
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7c36ba7e
  crc       = 0x650001
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xfa5ad95baba91cec
           ediv      = 0xd10e
           skdm      = 0xbc9cae82d2583281
           ivm       = 0x575d35d5

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  33:d8:64:3e:89:7f
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf7a49653
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf7a49653
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf7a49653
  crc       = 0xb44f51
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '<\\x84a\\xf3\x0e\\xb4\\xfa:\\xba8\\xfa\\xc4i\\xeb\\x97?'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf7a49653
  crc       = 0xae5ace
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x969;`\\xee\x07\\xd9\\xcasD\\xe2\\xb0T\\x92\\xb8\\xad'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf7a49653
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 301786352230d480dc9e793183f98240
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf7a49653
  crc       = 0xb4e024
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf7a49653
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf7a49653
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xf7a49653
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf7a49653
  crc       = 0x6effe7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x86a0e61f3bf28950
           ivs       = 0x7e4e633e

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf7a49653
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf7a49653
  crc       = 0x6effe7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x86a0e61f3bf28950
           ivs       = 0x7e4e633e

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf7a49653
  crc       = 0x6effe7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x86a0e61f3bf28950
           ivs       = 0x7e4e633e

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c1:d8:53:1f:cf:d9
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0xe0f738
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "tn\\x95\x19\\xed\x7f\\xf9'k\\x82\\xad\\xde\x1d\\xef_\\x8f"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0xc86e1d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x0b\\x8d\\xa5\\xd0\x03\\x92\\xb7\r\\xf9o\\x8fGUfpc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 04fe15fc45d69eb4f1563af26e619bca
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 87ad3bd3c0d69ded74a74abcba53255e
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0x5c5129
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x87\\xad;\\xd3\\xc0֝\\xedt\\xa7J\\xbc\\xbaS%^'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0xf0371
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x187752eb3a917404
           ivs       = 0x6aad3e10

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0xf0371
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x187752eb3a917404
           ivs       = 0x6aad3e10

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0x5251a0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x95d18fa2338f08e0
           ediv      = 0xcd0b
           skdm      = 0x27d6367dc6a7a39b
           ivm       = 0xc086268d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08d
dec_pkt 32c0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0xf0371
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x187752eb3a917404
           ivs       = 0x6aad3e10

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x49e0ca
  crc       = 0xf0371
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x187752eb3a917404
           ivs       = 0x6aad3e10

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  bb:d7:1e:b1:8a:06
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xcfed37e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xcfed37e
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcfed37e
  crc       = 0x588144
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'Y\\xae\\x9ck!\\xb6Q܉cN\\xa8k\\xd1>x'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcfed37e
  crc       = 0x887028
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'f\\xe67!\\xa7=\x14\x12\\xaa\\xbd\\xa4\\xfe>\\xb6e\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xcfed37e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd be99e6632f387a74e42872f84d7ec16a
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cd4b61eb6694bb53c5cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xcfed37e
  crc       = 0xb15686
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6\\xcdKa\\xebf\\x94\\xbbS\\xc5\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcfed37e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcfed37e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xcfed37e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcfed37e
  crc       = 0xe24cc0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x34b70dc783157946
           ivs       = 0x3ea5c2aa

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcfed37e
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcfed37e
  crc       = 0xe24cc0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x34b70dc783157946
           ivs       = 0x3ea5c2aa

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  11:ca:f8:42:83:8a
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xc2d1a13a
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xc2d1a13a
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc2d1a13a
  crc       = 0x61ed0b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = ' 6\x0b\\x8c\\\\xf9C*\\xfb\\xfd#\\x80\\xbcUe3'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc2d1a13a
  crc       = 0x8830fa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1b팍\\xc1\\xa8\\xccaik\\xe7&\\xb5\\x8f\x1eM'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xc2d1a13a
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd f796c756fd434dd01eee388211df52cd
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cd4b61eb6694bb53c5cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xc2d1a13a
  crc       = 0x86d38a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6\\xcdKa\\xebf\\x94\\xbbS\\xc5\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xc2d1a13a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xc2d1a13a
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xc2d1a13a
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc2d1a13a
  crc       = 0xee997b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x8c62913ab693fcd
           ivs       = 0x66773c5e

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc2d1a13a
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xc2d1a13a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc2d1a13a
  crc       = 0xee997b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x8c62913ab693fcd
           ivs       = 0x66773c5e

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a5:ae:6b:36:6c:76
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0x364de3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'ő\\xb6\\x8d$\\x92\\xc4\\xf41^u8\\xb4\\x9d\\xfc\\xfb'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0x12b9f3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb5\\xea\\x93\\xcf}Iв\x16*\x0cE\\xbd\\xec\\xe9G'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 924888a59173fda83b4d1da22858b821
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 8f52d87244296cbdc872776a64b93b35
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0x65cad8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x8fR\\xd8rD)l\\xbd\\xc8rwjd\\xb9;5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0x20391e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9d554ad1ed18516b
           ivs       = 0xd31fa0bf

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0x9d4a25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xc5fa2b6ed528f2fc
           ediv      = 0xf078
           skdm      = 0x41eccd579abc19a9
           ivm       = 0x9d7e5f77

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08d
dec_pkt 32c0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0x20391e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9d554ad1ed18516b
           ivs       = 0xd31fa0bf

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5deefdd9
  crc       = 0x20391e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9d554ad1ed18516b
           ivs       = 0xd31fa0bf

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  01:6e:c8:75:1d:23
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x14a40662
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x14a40662
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x14a40662
  crc       = 0xb0e3aa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'm\x15\\xbf\x0b\\x9ed\x1e\x1a\x06\\xac\\x8c\\x87\\xf6\\xfb\\xa3\\xc1'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x14a40662
  crc       = 0xd6345b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb3\\x90\x02XJ\\xd3\\xf8\\x8dȁ\\xf3=\\x8apsM'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x14a40662
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 7f9fbf9bff93c6721508064dc4203026
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 3f1a7b7a1c8d3db9b56799afd9b3ccd3
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x14a40662
  crc       = 0x2512f6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '?\x1a{z\x1c\\x8d=\\xb9\\xb5g\\x99\\xafٳ\\xcc\\xd3'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x14a40662
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x14a40662
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x14a40662
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x14a40662
  crc       = 0x6d916e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xfb578f30c359be6e
           ivs       = 0x8ef796a6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x14a40662
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x14a40662
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  76:23:83:4b:dc:ce
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x83bb1a90
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x83bb1a90
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x83bb1a90
  crc       = 0x786cf8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'Li\x06\\xe70{\x02\\x98\x14\\x84+\\xa4\\xdd\x0c\\xe4\\xa7'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x83bb1a90
  crc       = 0xfe024b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'a\x7f\\xf2\\xddn8~\x00\\xb1;\\x84\\xdc\\xc04\\xa1n'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x83bb1a90
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 37d2550186010dba355317cc55f98b60
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 44296cbda214b65e64b93b35b2dc9d1a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x83bb1a90
  crc       = 0xfd2e65
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'D)l\\xbd\\xa2\x14\\xb6^d\\xb9;5\\xb2ܝ\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x83bb1a90
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x83bb1a90
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x83bb1a90
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x83bb1a90
  crc       = 0x1c10a2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xaabe1dccdc6c7a4
           ivs       = 0xd272dfc8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x83bb1a90
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x83bb1a90
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98b
dec_pkt 4877
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x83bb1a90
  crc       = 0x1c10a2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xaabe1dccdc6c7a4
           ivs       = 0xd272dfc8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  ab:92:8d:9a:18:79
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0x63a6fd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'T\x05 Z)%lx$<\\xcab\\xec\\xd1\x1b\\x94'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0x4d0ee6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x19\\xa9\n\\xb6+\x0c\\xeb\x08\\xb3(թ5j\\x95R'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 44f645cbc04a73126a8a5370aa08d2e2
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cd4b61eb6694bb53c5cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0x86d38a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6\\xcdKa\\xebf\\x94\\xbbS\\xc5\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0xa15b42
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x42d62510acb5ba3b
           ivs       = 0xdab2dbdc

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98b
dec_pkt 4877
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0x7300d7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x5038ad63da1b60f
           ediv      = 0xb1e9
           skdm      = 0xa8f414e84cf34018
           ivm       = 0x279ca0f1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08d
dec_pkt 32c0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0xa15b42
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x42d62510acb5ba3b
           ivs       = 0xdab2dbdc

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd0f6e214
  crc       = 0xa15b42
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x42d62510acb5ba3b
           ivs       = 0xdab2dbdc

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  be:c5:b8:71:46:f3
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x5e311fa
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x5e311fa
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5e311fa
  crc       = 0xc33ece
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x02\\x86\\xfe\\xb2\\xaf\x19lFPn^u\\xfc\\xa6\\xe4\x17'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5e311fa
  crc       = 0x35c772
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xcf~\\xe5\x11\x07\x0f\\x8f\\xbe\\x82\\xdaN.\\x95&\\xe4\\xb7'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x5e311fa
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 394e951391b509f8f9eef0f2aaf01b01
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 15b6ee54095b77aede9d2ae174a74abc
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x5e311fa
  crc       = 0x346d75
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x15\\xb6\\xeeT\t[w\\xaeޝ*\\xe1t\\xa7J\\xbc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5e311fa
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x5e311fa
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x5e311fa
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5e311fa
  crc       = 0xfd88b5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf330a408189ad272
           ivs       = 0xe58f552d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5e311fa
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5e311fa
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98b
dec_pkt 4877
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  cf:ed:ed:14:51:81
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x7fdf575d
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x7fdf575d
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7fdf575d
  crc       = 0xec5fd4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xfe\x19o;\\x8dz^S\\xb8\\xdb\\xe9G\x11\\x98v\\xba'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7fdf575d
  crc       = 0x1ca4de
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '1֖\\xd0\\xfbd0NI(\\xba\\xf9\\x95\\xcb?\\xb4'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x7fdf575d
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 4d1d9e2e7c32a962e03d5ff89a291744
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 53d8ba5b2a6cdda97177aa9cbb3b55ca
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x7fdf575d
  crc       = 0xd69c24
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Sغ[*lݩqw\\xaa\\x9c\\xbb;U\\xca'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7fdf575d
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x7fdf575d
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x7fdf575d
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7fdf575d
  crc       = 0x50e4ed
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xccb44fd98ce55f79
           ivs       = 0xadba87c8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7fdf575d
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7fdf575d
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7fdf575d
  crc       = 0x50e4ed
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xccb44fd98ce55f79
           ivs       = 0xadba87c8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  45:f1:c3:c3:07:25
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0x6e481e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'F\\x8a\x0f\x12|\x03tG_\\xd1Q\\xb1\\x8a\x19\x0e.'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd cac02a4ddeb8d7575267ebe9d05e219a
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xdf3344
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = ']L\\x98(\x0c\\x94\\x91\\xf3r`\r\\xa9x\x17e\\xc7'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0x12cea6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x3713198d27ee7292
           ivs       = 0xc505479d

ltk 00000000000000000000000000000000
skd 0000000000000000a86456fc4c55df99
sk f986f0a7aa961b3ce7a3c56202e368ad
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0x40e75a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0x40e75a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x4
           error_code= 0x24

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_REJECT_EXT_IND
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0x9b0ccf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 3
###[ BTLE_CTRL ]### 
        opcode    = LL_REJECT_EXT_IND
###[ LL_REJECT_EXT_IND ]### 
           reject_opcode= 0x6
           error_code= 0x25

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_REJECT_EXT_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0x20ec00
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x1e

###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0x20ec00
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x1e

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xa85d03
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x3

###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xa85d03
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x3

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xb8e450
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x1756bcde60d6aa55
           ediv      = 0x4818
           skdm      = 0x433f3a22f052fce5
           ivm       = 0xbfe7fd1f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xc89603
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7

###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xc89603
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x7

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0x12cea6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x3713198d27ee7292
           ivs       = 0xc505479d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xacf1c2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xf0

###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xacf1c2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0xf0

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0x12cea6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x3713198d27ee7292
           ivs       = 0xc505479d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xafe8c1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x61

###[ BT4LE ]### 
  access_addr= 0x15cd5868
  crc       = 0xafe8c1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 2
###[ BTLE_CTRL ]### 
        opcode    = LL_UNKNOWN_RSP
###[ LL_UNKNOWN_RSP ]### 
           code      = 0x61

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  8d:74:be:05:07:68
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x9cd35fd3
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x9cd35fd3
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9cd35fd3
  crc       = 0x2b55cf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x9d0\x029<\\xc3tM\\xeai,+\x18v\\x90\\xdc'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9cd35fd3
  crc       = 0x866a9d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x03H?\\x9fe\\x8f\\x98֡=\\x88aS\x0ed\\xbd'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x9cd35fd3
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e164672cc77156dca51c56bfc429c5c2
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x9cd35fd3
  crc       = 0xfa0a13
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9cd35fd3
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9cd35fd3
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x9cd35fd3
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9cd35fd3
  crc       = 0x6018c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd10a5633eb884b81
           ivs       = 0xa6e7048f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9cd35fd3
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9cd35fd3
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f6:33:41:e1:df:e9
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x1cba533a
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x1cba533a
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1cba533a
  crc       = 0xe028e7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\\xf3\\xb9GQO\\xb6\\x840\\xf4\x1e\\xd4'\\xcdb\x17\x17"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1cba533a
  crc       = 0xea7e59
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x9e\\x82\\xb0G\n\\xdck\\xb0Ja~\\x87]@K\\x9f'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x1cba533a
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd ff151e89b55c3a3c687911a4249aeab7
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd bf78ad542e5e2b5723733ffa92b91ff9
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x1cba533a
  crc       = 0xc57aca
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xbfx\\xadT.^+W#s?\\xfa\\x92\\xb9\x1f\\xf9'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1cba533a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x1cba533a
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x1cba533a
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1cba533a
  crc       = 0xcd822a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa39bb65d59658e80
           ivs       = 0xdf1d76ed

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1cba533a
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1cba533a
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f986
dec_pkt 487a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1cba533a
  crc       = 0xcd822a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa39bb65d59658e80
           ivs       = 0xdf1d76ed

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  77:93:bc:b3:59:b7
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0x3aedca
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'f\\x8d*\\xfb\\xeb\\xce6\x1b\\xae-!\x0e\\xdfG\x13F'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0xfed1a7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'd\\x9ceƤW\\x98\\xa7\\x9fb\\xbffpi\\x98@'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd d390a19e640e836bd35be1e5c1679883
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2e5e2b5717af952bc9dc8f7c67ee47ba
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0x83b731
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '.^+W\x17\\xaf\\x95+\\xc9\u070f|g\\xeeG\\xba'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0x9a943f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x6ab99f6f5d100e1c
           ivs       = 0xb3a77646

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f986
dec_pkt 487a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0x442968
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x7617599e0f77f2bb
           ediv      = 0xec48
           skdm      = 0xc591054c20e85768
           ivm       = 0xf3567f3c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08d
dec_pkt 32c0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0x9a943f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x6ab99f6f5d100e1c
           ivs       = 0xb3a77646

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1ca1e842
  crc       = 0x9a943f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x6ab99f6f5d100e1c
           ivs       = 0xb3a77646

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  64:4f:98:f0:ec:c1
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x13894e11
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x13894e11
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x13894e11
  crc       = 0x99499c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'd>1\\x80\x16\\xb9\x195w=.I\\xad\\xdc\\xc3\\xeb'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x13894e11
  crc       = 0xd5bfa8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x193\\x93M\\xab\x0c\x00\\x8c\\xf0\\x8b\\x8c\x05Q\\xed)\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x13894e11
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e1f9199edccfd225ff37a2a5e7f5496d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2a6cdda915b6ee54bb3b55cade9d2ae1
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x13894e11
  crc       = 0x3c0d97
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '*lݩ\x15\\xb6\\xeeT\\xbb;U\\xcaޝ*\\xe1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x13894e11
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x13894e11
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x13894e11
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x13894e11
  crc       = 0x673224
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x3fed59eefdec599
           ivs       = 0xeb5e9bc9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x13894e11
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x13894e11
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f986
dec_pkt 487a
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  da:67:dc:0a:f6:b2
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0x146341
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'C\\xac\\xe5Ӽ\\xab{\x7f\x02fH\\xb3\x15\x1d,\\x93'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0xa6b4d1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8b\\xa7\\x94H\\xb1\\x8c8\\xed\\xb3\\xd6\\xd6\x0f8\\xf6{\\x93'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 09e240598011695c13548eb6d81fdf77
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd e52885157194c28e922c77974996bb4b
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0x98184c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xe5(\\x85\x15q\\x94\x8e\\x92,w\\x97I\\x96\\xbbK'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0xc85018
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x18c2dd6aaddd292d
           ivs       = 0xeca7b934

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0x6d3151
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x7cdd9f4ecd0d10d2
           ediv      = 0x946a
           skdm      = 0x77e761035bb520fa
           ivm       = 0xd8c267fa

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0x6d3151
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x7cdd9f4ecd0d10d2
           ediv      = 0x946a
           skdm      = 0x77e761035bb520fa
           ivm       = 0xd8c267fa

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x62b06142
  crc       = 0xc85018
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x18c2dd6aaddd292d
           ivs       = 0xeca7b934

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f2:8b:ce:08:8a:5c
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0x6f21f1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8a0\\x83[\\x8e\\xff\\xed\\xd3zK/\\x95\næ\\xa1'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0x97acc9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x14\\xae\x1a\\xb0*\x1d\\xee4\x19,\\x9a\\xeaG\\x9b|\\xb5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd cf51986d0b6c1a3526a9be23e41ab4e1
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 44296cbda214b65e64b93b35b2dc9d1a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0xcaab69
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'D)l\\xbd\\xa2\x14\\xb6^d\\xb9;5\\xb2ܝ\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0xd8334b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xca63dc972a07e21d
           ivs       = 0x6722eaf5

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0xeb1248
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xd6081dc15479e5fc
           ediv      = 0xf651
           skdm      = 0xde3b85d74df41546
           ivm       = 0xda7be9cc

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0xeb1248
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xd6081dc15479e5fc
           ediv      = 0xf651
           skdm      = 0xde3b85d74df41546
           ivm       = 0xda7be9cc

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0xeb1248
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xd6081dc15479e5fc
           ediv      = 0xf651
           skdm      = 0xde3b85d74df41546
           ivm       = 0xda7be9cc

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0xd8334b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xca63dc972a07e21d
           ivs       = 0x6722eaf5

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9ab01bcc
  crc       = 0xd8334b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xca63dc972a07e21d
           ivs       = 0x6722eaf5

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  34:45:f1:41:2e:54
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x7030329b
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x7030329b
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7030329b
  crc       = 0x3390ee
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'B;\\xcbd\\xf7t\x1a\x1e\\xa4s\x1a\\xf8\x03\\xcc/\\x95'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7030329b
  crc       = 0xf39799
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'G3*\\xea\\x84O\\xf7\\xee\\xcc\x17\\xa3\x17\x16`\\xd9\\xdc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x7030329b
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd abdec8112ffc220e0e5bcc8079687719
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb66a6b075b7cadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x7030329b
  crc       = 0xaa8122
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebf\\xa6\\xb0u\\xb7\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7030329b
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x7030329b
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x7030329b
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7030329b
  crc       = 0x3a42ef
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x456d1f43d100874d
           ivs       = 0xc8a9b12d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7030329b
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7030329b
  crc       = 0xa087b5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xf68e8d308ea82230
           ediv      = 0xa5d5
           skdm      = 0x1312d05eabce9d6
           ivm       = 0x79ba71e6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7030329b
  crc       = 0xa087b5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xf68e8d308ea82230
           ediv      = 0xa5d5
           skdm      = 0x1312d05eabce9d6
           ivm       = 0x79ba71e6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  2b:1c:4d:95:bf:d9
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0x2a2386
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8c\\xdd̝\r\x0c{\\xbbNt\x0e\\xb1V\\xa1j\\xf5'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0x8346ad
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc4\\xf6\\xb2z\\x8cU\\xeb\\x99\\xfc\\xc7\\xf5\\x80\\x8d\\xd9\x13\\xff'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 27689765780325d3b04baad685ecc30c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 15b6ee54095b77aede9d2ae1ef4e9570
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0x329817
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x15\\xb6\\xeeT\t[w\\xaeޝ*\\xe1\\xefN\\x95p'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0xf9ce87
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x657c23fb49dd02bc
           ivs       = 0x587b564d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0x23b1b9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x772d445349b94ba0
           ediv      = 0x8cdc
           skdm      = 0x43ad00f9b943c2d4
           ivm       = 0x7a6a20c7

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0xf9ce87
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x657c23fb49dd02bc
           ivs       = 0x587b564d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdcf5cad
  crc       = 0xf9ce87
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x657c23fb49dd02bc
           ivs       = 0x587b564d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a0:98:01:bc:24:c4
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0x108f48
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xe2J\\xe2\\xd7\r\\xa11r\\xa3\\xa2\\xe6\\x95\\xf9\x10\x1e\\xfd'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0x9b38bd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'g\\xaexF\\xa4r\\xe0\\xcf\\xf0@\\xbd\\xd4u\x04^\\xe0'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e0ebe483bef3d77d8d3ce3058d9e6c27
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 60ebce76d8bab31ded54899375aac4cd
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0x9d7d07
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '`\\xeb\\xcevغ\\xb3\x1d\\xedT\\x89\\x93u\\xaa\\xc4\\xcd'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0x95ba25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x2553ed58dfc36881
           ivs       = 0x7a4d5ede

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0xcbc271
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x58b195e471d3be49
           ediv      = 0x8d87
           skdm      = 0x9ae610dfcaedf617
           ivm       = 0xc0c419af

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0x95ba25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x2553ed58dfc36881
           ivs       = 0x7a4d5ede

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0xcbc271
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x58b195e471d3be49
           ediv      = 0x8d87
           skdm      = 0x9ae610dfcaedf617
           ivm       = 0xc0c419af

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0x95ba25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x2553ed58dfc36881
           ivs       = 0x7a4d5ede

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x2d193759
  crc       = 0x95ba25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x2553ed58dfc36881
           ivs       = 0x7a4d5ede

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  b3:11:a2:4d:c5:1e
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x1451e3ad
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x1451e3ad
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1451e3ad
  crc       = 0x9eedf2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc5\\xdcC\\xc0U\x1b\\xf1\\xa3@\\xa5\\xcf\\xe0ŏ\\xfeE'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1451e3ad
  crc       = 0x7b5ba3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf06t\\xffV\\xb3\x1b\\x96\x1f\\x88 u\x0e+[^'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x1451e3ad
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 229a72dc4c2406e891b506e26153c43a
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 3b4a61c38f52d87290e5eed4c872776a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x1451e3ad
  crc       = 0x7c7a44
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ';JaÏR\\xd8r\\x90\\xe5\\xee\\xd4\\xc8rwj'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1451e3ad
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x1451e3ad
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x1451e3ad
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1451e3ad
  crc       = 0xcd0c2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc84904239ef14c2a
           ivs       = 0x3f726a33

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1451e3ad
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1451e3ad
  crc       = 0x6b22
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xe2ac57dbbd610814
           ediv      = 0x103a
           skdm      = 0x238a4d01c9ab3e0d
           ivm       = 0x5042cf32

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1451e3ad
  crc       = 0xcd0c2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc84904239ef14c2a
           ivs       = 0x3f726a33

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f8:79:cc:a7:4d:55
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0xbe7063
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "u>\\x92\\x8cy\\x9d{'\x19iZ\\xd6\\xcfF\\xf0\x11"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0x28c81f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xecw\\xdbJ\\xd6}UX\x1e\\x89\\xe7\\x82\\xe0\\xd2j\\xca'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 46c2e0d6a4ae9d5ba30f667953b4a2de
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd ac95a3b46be5282df52359d6f9912cef
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0xc2e563
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xac\\x95\\xa3\\xb4k\\xe5(-\\xf5#Y\\xd6\\xf9\\x91,\\xef'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0x558233
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xb28559ab54adb3
           ivs       = 0x2594a2bd

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0x516b38
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x4e9a53b444121852
           ediv      = 0x9c6a
           skdm      = 0x7621dc65e29aa4fe
           ivm       = 0xe738303d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x193af02c
  crc       = 0x558233
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xb28559ab54adb3
           ivs       = 0x2594a2bd

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  50:d4:7d:f8:2b:04
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0x2aba25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa8Z\\xf2ct\\xa7\u0381\\xbf\\xb79\\xa3\\xeb\\xce\n\\x97'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0xd18718
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xe1\\xe8\\xadK3\\xd2\\xe0A\\xc6f\\xe1\x1b\\xa5!\\\\xe1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 678a9bf8b607912ccb66735644c7afab
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd b67294925b394a49ff4896f37c24cbfd
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0xa9f0af
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xb6r\\x94\\x92[9JI\\xffH\\x96\\xf3|$\\xcb\\xfd'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0xf4bb5c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd461c6dec91abd26
           ivs       = 0xb39eb7e1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0x4ffa01
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xcc8163e920ede260
           ediv      = 0x5120
           skdm      = 0x874664097c9997ee
           ivm       = 0x5a3728c8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0x4ffa01
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xcc8163e920ede260
           ediv      = 0x5120
           skdm      = 0x874664097c9997ee
           ivm       = 0x5a3728c8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0xf4bb5c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd461c6dec91abd26
           ivs       = 0xb39eb7e1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd2f4bb09
  crc       = 0xf4bb5c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd461c6dec91abd26
           ivs       = 0xb39eb7e1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  d3:1f:97:95:7b:94
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x896c18fa
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x896c18fa
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x896c18fa
  crc       = 0xd73d00
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '04\\x91\\xc8a\\xdd\x1a\\x94\\xa0\t\\x8c?Ϛ\\xc5('

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x896c18fa
  crc       = 0xea5d3a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x94Ȑ\\xd8\x1c\\xa6^\\xfc\\x9f\x11Z\x1b\\xf5\\xe3\\xcb\\xd4'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x896c18fa
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 0957c5a29fbbf9976fd9971e37ef5c58
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cd4b61eb6694bb53c5cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x896c18fa
  crc       = 0x86d38a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6\\xcdKa\\xebf\\x94\\xbbS\\xc5\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x896c18fa
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x896c18fa
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x896c18fa
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x896c18fa
  crc       = 0xef4c0d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x60312510d3ac9629
           ivs       = 0x7024bef7

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x896c18fa
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x896c18fa
  crc       = 0x142252
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xbd441462c2c1dc8c
           ediv      = 0xe458
           skdm      = 0x46810caef69b7d0f
           ivm       = 0x91d141a1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x896c18fa
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  74:c6:ae:5c:38:b1
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0x7de925
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb2\\xb2\\xa8\\xbe\x18ka\\xd7\\xfc\\xd8\x19N\\xafc\\xe7:'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0xf47eec
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '3\x0e9\\xe0\\x8d\\xae\\x9f$=K\\xe5\\xd8\x7f\\x80VI'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd b7065c657eb78197a51f236f5cae16c0
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd59ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0x360915
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcdY\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0xce1c3e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x70f14cc2e9d71292
           ivs       = 0xc9cc74ce

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0x4fdd14
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x7c4abddfe9a5626c
           ediv      = 0x6d87
           skdm      = 0x8ee783b229d64c5
           ivm       = 0x8ed08a7

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cd
dec_pkt 09d2
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x47e7da07
  crc       = 0xce1c3e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x70f14cc2e9d71292
           ivs       = 0xc9cc74ce

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  15:cd:13:85:06:45
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0x51a56e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '*8,аV\\xb5:x\n\x0c\\x9c\\xfa\x0b\\xeby'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0x740e2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xec\\xdb\\xd6eE\x07/d\x94B\\xee!\\xb3Q\x0c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 9dce92e0e57b86d405defbb1bdcfa738
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad93b2dc9d1a2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0x14a026
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93\\xb2ܝ\x1a/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0xbaf5b4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf7122f20e5854572
           ivs       = 0x93e9743f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0xfacb9c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x9f1d5f19dd8476fd
           ediv      = 0x2045
           skdm      = 0x14b49342a9ba9ca
           ivm       = 0x604ce160

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cd
dec_pkt 09d2
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0xfacb9c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x9f1d5f19dd8476fd
           ediv      = 0x2045
           skdm      = 0x14b49342a9ba9ca
           ivm       = 0x604ce160

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0xbaf5b4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf7122f20e5854572
           ivs       = 0x93e9743f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf097bb89
  crc       = 0xbaf5b4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf7122f20e5854572
           ivs       = 0x93e9743f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c0:a4:d9:a0:92:63
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xb9326c05
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xb9326c05
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb9326c05
  crc       = 0x9d4ea0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8aj\t\\xff\\xcc\x02q\\xce$\x1eؠV\x18\\xe2A'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb9326c05
  crc       = 0xdf0a4f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x07\\xa2\x7f\\xac\\x8d\\xee\\x8b:ʵ\\x88\\xfd\\x93I\\xdc*'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xb9326c05
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3bc5310bbf72e63fc4ab83dbdb5f519c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b753d8ba5be5ee5431bb3b55ca
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xb9326c05
  crc       = 0xdbbaa5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7Sغ[\\xe5\\xeeT1\\xbb;U\\xca'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb9326c05
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb9326c05
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xb9326c05
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb9326c05
  crc       = 0x75a8c2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe913f88c76462d22
           ivs       = 0xa9a1f59c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb9326c05
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb9326c05
  crc       = 0x98c48f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x73c5f8afe8b6daa2
           ediv      = 0x5295
           skdm      = 0x481f404111e328c6
           ivm       = 0xb9978784

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb9326c05
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cd
dec_pkt 09d2
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f0:1f:a5:6d:3d:6f
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0x950f82
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'YN\\xeb\\xfa\\x9e\x7ftD2gw\\x81\\xf8\\xcfL\x03'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0xe4a2f1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'P\\xdbD\x07\x1aF6+\x10\x1bZ\\xaed\\x99\\xbb\\x95'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 739b93d3f3932e9ce2d4d9c2d4ac9a03
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0x77130c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0xf84b62
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x6e26c7ba71048615
           ivs       = 0x9fc8bd1b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0x2bfbc0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x887ecfd90fa185ec
           ediv      = 0xcd48
           skdm      = 0x288aa8ab71cd3b5
           ivm       = 0x83a55185

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c1
dec_pkt 09de
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x30334d34
  crc       = 0xf84b62
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x6e26c7ba71048615
           ivs       = 0x9fc8bd1b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  3f:27:c5:5e:b2:f5
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0x33e313
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xe8\\xfdBI\\xdf_\x7fX\\xc9HQ\\x8a\\xac\\xb6$\\xb1'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0xe485d2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf2y\\x84\\xf3\x17\\xe8wirQ\x19\\xd0\x053\\xac\\xb4'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 2753633941ffc5cbef5e634ff554a3b5
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 87ad3bd360ebce76ba53255edda9122f
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0x700358
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x87\\xad;\\xd3`\\xeb\\xcev\\xbaS%^ݩ\x12/'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0x8af17
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x28e09d9d88717db0
           ivs       = 0xbdde42b0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0xa4ca12
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x20892dd01980b9a4
           ediv      = 0xe713
           skdm      = 0x52bf468a617eba0d
           ivm       = 0x48c93339

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c1
dec_pkt 09de
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0xa4ca12
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x20892dd01980b9a4
           ediv      = 0xe713
           skdm      = 0x52bf468a617eba0d
           ivm       = 0x48c93339

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0x8af17
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x28e09d9d88717db0
           ivs       = 0xbdde42b0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcb2739ac
  crc       = 0x8af17
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x28e09d9d88717db0
           ivs       = 0xbdde42b0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  81:d9:d8:fe:a3:d3
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x80233d53
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x80233d53
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x80233d53
  crc       = 0x348880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '!\\xa3\\xa0\\x86a\\xb9\\xd8\\xec\x12\\xfa\\x9a\\xc0 KS\x02'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x80233d53
  crc       = 0x69109
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x16\\xbc\\x96\x11\\x9a-\\xa2\\xd5\x02\\x9a\x03\\xa6\\xe3\\xd5\\xfd\\xa7'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x80233d53
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c17d694d3ebf5ea4e5534c66204c663b
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x80233d53
  crc       = 0xb4e024
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x80233d53
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x80233d53
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x80233d53
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x80233d53
  crc       = 0x598059
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x968eb204ea9f9383
           ivs       = 0x162e8d2c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x80233d53
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x80233d53
  crc       = 0x1ec936
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xe4d36e5e5bd8b3b6
           ediv      = 0xd921
           skdm      = 0x3463c7f7b5ea5aad
           ivm       = 0xbc857cc

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x80233d53
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c1
dec_pkt 09de
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f8:f4:04:72:14:a3
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0x4f2a52
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa4t\\xd5\x19\\xbb\\xf9\\x9c\\xb00\\x9dd\\xb5\\xa4\\xc1$\\x81'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0x587107
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x00m\\xf0K\\xc8R\\xe8\\x8e\x01o\\xe9\\xd6\\xf3G1\\x8a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 0f2aa746b87f8f79d3eccc6239cd0f5d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 15b6ee54095b77aede9d2ae1ef4e9570
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0x329817
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x15\\xb6\\xeeT\t[w\\xaeޝ*\\xe1\\xefN\\x95p'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0xab2ebf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xfce984388227e3f4
           ivs       = 0x302ada2d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0x9a39c4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x36ccff11fe5b6dee
           ediv      = 0xd342
           skdm      = 0x4bbe15401ead4858
           ivm       = 0x64dbfe92

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c0
dec_pkt 09df
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd6f77a1d
  crc       = 0xab2ebf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xfce984388227e3f4
           ivs       = 0x302ada2d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  d4:95:8a:d1:34:d0
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0xc89c6c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'hz\\x93X%\\xb1\u07b9\\x83\\xb7\\xe5\\xe8\\x9a\x155\\xe0'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0xe7f9f0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x9c\\xefu\\x9fp\\xe4\x1f*\\x82\\xd4:\\xef`\\xaa\\xf2*'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 1f5316db53a5d9a0d4de491ec44b89e1
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 94a31456e528851546b2dc4d922c7797
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0xc8136
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x94\\xa3\x14V\\xe5(\\x85\x15F\\xb2\\xdcM\\x92,w\\x97'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0xda7599
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd12af0970ea8e08
           ivs       = 0xb0088f3e

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0x3383de
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x2ca22c49e8f18775
           ediv      = 0x89d0
           skdm      = 0xe485c8036d8bc217
           ivm       = 0x3c14a4ff

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c0
dec_pkt 09df
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0x3383de
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x2ca22c49e8f18775
           ediv      = 0x89d0
           skdm      = 0xe485c8036d8bc217
           ivm       = 0x3c14a4ff

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0xda7599
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd12af0970ea8e08
           ivs       = 0xb0088f3e

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x851212a9
  crc       = 0xda7599
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd12af0970ea8e08
           ivs       = 0xb0088f3e

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  12:de:79:9e:57:b7
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x2e45bf92
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x2e45bf92
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x2e45bf92
  crc       = 0xaeda78
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'v\\xc2ږ\r3\x0bf\x08\\xb7g*>\\xd5\x1b\x12'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x2e45bf92
  crc       = 0x1491c9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x07\\xb9\\xe2\t\\x97\\xef\\xe0\\x91~\\xa2\\xf4_\\x9e|\x0c\x10'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x2e45bf92
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd afa7f794c5c1b6a10c1e48debe7df0c7
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x2e45bf92
  crc       = 0xcd8f1f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x2e45bf92
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2e45bf92
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x2e45bf92
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x2e45bf92
  crc       = 0x2f91bf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xff7aaf10c9c93bf5
           ivs       = 0x3f3070cd

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x2e45bf92
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x2e45bf92
  crc       = 0x956096
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xcef7dfacfeb99eeb
           ediv      = 0x22de
           skdm      = 0x74863e110e56250e
           ivm       = 0x8506b538

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x2e45bf92
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c0
dec_pkt 09df
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  6b:ce:3d:5c:15:20
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0xbedcee
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'ݩe-\uef77\\xbeW\\xc6u9>\\x8e\\xcc\\xe1'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0x1595e6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '{\\x91\U00061cf1\r\\xb2#\\xd3k_]\tp5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 9c90b442f18995a06dd86de33b1e2e91
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cda6b075b794bb53c5e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0xdffa38
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6ͦ\\xb0u\\xb7\\x94\\xbbS\\xc5\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0x3884ba
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe01f389a93f509b1
           ivs       = 0x4f465625

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0xab822e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x53c1e1213360f66b
           ediv      = 0xd69c
           skdm      = 0xbdad67d15cbeaa8e
           ivm       = 0xa954a9bc

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x9879e80a
  crc       = 0x3884ba
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe01f389a93f509b1
           ivs       = 0x4f465625

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  e9:07:df:fe:ab:7b
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0xc136db
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf2x\\x85K4\r\\xed\\xe1\\xda\x0cjŉ\\xacz\\xa9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0x9f9e62
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xe4-\\xa2|\\x9d"\\xb4\\x9e\\xf1\x074\\xa8\x9b\\xdcv'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 43da593ffb6d7fbe52efc823d23f086a
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb6653d8ba5bcadda9627177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0xc084b5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebfSغ[\\xcaݩbqw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0xb8347e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xfb5d130032967513
           ivs       = 0xae024ac

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0x5e4e0c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x34e84be514112a3f
           ediv      = 0x8a70
           skdm      = 0x6cebce3cf26c5bad
           ivm       = 0xd8f9d2f9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0x5e4e0c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x34e84be514112a3f
           ediv      = 0x8a70
           skdm      = 0x6cebce3cf26c5bad
           ivm       = 0xd8f9d2f9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0xb8347e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xfb5d130032967513
           ivs       = 0xae024ac

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xab7be63f
  crc       = 0xb8347e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xfb5d130032967513
           ivs       = 0xae024ac

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  69:9b:8e:08:a3:61
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x18a2c4d1
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x18a2c4d1
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x18a2c4d1
  crc       = 0x9dae15
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x9d\\xde\\xf4\\xbf\\x9f\\x99-n"r\\xfd\x0e\\xf00\n*'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x18a2c4d1
  crc       = 0x1b8c4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '>t\x01Eؠ\x0f\x12-"\\xd4/\\xb5\\xd3\\xed\\xf3'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x18a2c4d1
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd ecd180f3b43f9f4ac33d1117884b03f1
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb66a6b075b7cadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x18a2c4d1
  crc       = 0xaa8122
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebf\\xa6\\xb0u\\xb7\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x18a2c4d1
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x18a2c4d1
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x18a2c4d1
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x18a2c4d1
  crc       = 0xc38bdb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x5c9e466adae6ff70
           ivs       = 0xed2f08e0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x18a2c4d1
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x18a2c4d1
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x18a2c4d1
  crc       = 0x897233
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xbb1b97cb4372e633
           ediv      = 0x8a21
           skdm      = 0xd5ea789f4c30116f
           ivm       = 0xfe6590eb

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c8:28:19:48:0d:8b
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0x8efe7e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = ')$\\x87\\xd6~\\xf0\t\n\\x94s\\xd2\\xf7\\xc2a\\x93N'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0x1a1daa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xba\\xfa\\xddF\\x83Z\t\\xdf]\\xc1"\\xc8\x05\x17\x14c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd b16abf5dd4b71824632f40d71aad5d50
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 60ebce76b075673bdda9122fed548993
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0x515efa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '`\\xeb\\xcev\\xb0ug;ݩ\x12/\\xedT\\x89\\x93'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0x2e8137
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x30123aa0bf0f930c
           ivs       = 0x44262e0b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0x2e8137
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x30123aa0bf0f930c
           ivs       = 0x44262e0b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5573ce68
  crc       = 0x2e8137
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x30123aa0bf0f930c
           ivs       = 0x44262e0b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  8c:46:76:43:65:22
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0x2f9fa4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '5"\\x86\\xceT\\xfdV,\\xb8\\x9e^.\\xf1\\xf6t\\xbb'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0xeb3ef8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '/\x90\\x8d_Y\\x9d\\xec\x03\\x96\x0f;\\x88\\xb1\\xc4j'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 69686eb952af474d77142c022260ca8b
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0xcd8f1f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0x844319
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x443230ad5e69212f
           ivs       = 0x265da655

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0x844319
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x443230ad5e69212f
           ivs       = 0x265da655

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0x3bc330
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xd9c497c8128e99c
           ediv      = 0x8438
           skdm      = 0xffa12d144bfa92d4
           ivm       = 0xc8ed9f38

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0x844319
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x443230ad5e69212f
           ivs       = 0x265da655

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3c62d238
  crc       = 0x844319
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x443230ad5e69212f
           ivs       = 0x265da655

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  b5:0e:7b:3a:97:1e
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x32d08daa
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x32d08daa
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x32d08daa
  crc       = 0xc23207
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa7\rGj%\\xd5\t}HA\\xa9\\Gw!\x0b'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x32d08daa
  crc       = 0x8efe70
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb1t\x06\\x888]\\xc5\\xe7\\xfa8\\xbe\x19\\xefJ\\xb4\\xd4'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x32d08daa
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 02d72e145a2ab3e6582ac03587831b7a
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x32d08daa
  crc       = 0xcd8f1f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x32d08daa
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x32d08daa
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x32d08daa
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x32d08daa
  crc       = 0x44f5ef
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x24ad8673fe5726e7
           ivs       = 0xa8b17478

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x32d08daa
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x32d08daa
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x32d08daa
  crc       = 0x44f5ef
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x24ad8673fe5726e7
           ivs       = 0xa8b17478

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f5:79:33:d6:43:96
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0xea5acb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb0F\x02\\xbc\\xb6+M\\xf3\\xb3\\xeaG@\x14=\\xe71'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0x2466c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa6\x1b\\xc0\x1d\\x9fpvK\\xcciDԥf{o'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 1be2ac38b0f47e5746c91dc8e5d38951
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0xfa0a13
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0x3e26b1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x59a816d5c9a2b4c0
           ivs       = 0x7620d3df

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfaa62a9a
  crc       = 0x3e26b1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x59a816d5c9a2b4c0
           ivs       = 0x7620d3df

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  70:9d:8b:34:ec:59
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0xbc2523
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1e\\x95\\xe6\x16\\x9d\\xf8\\xff\\xf6\uef05\x1fk\\xa4\x05\\xc9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0x118197
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x02\\xd3\\xfd\x11(f\u07fbB\\xa2\\x85\\x88\\xc5Ю\x02'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 811d91d06ad7d6d91bbb21a3860a27af
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cd4b61eb6694bb53c5cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0x86d38a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6\\xcdKa\\xebf\\x94\\xbbS\\xc5\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0xee6777
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf920679852db2f70
           ivs       = 0x9b12c0a3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0x243fe6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x8b1a6b74511e3cdc
           ediv      = 0x9f5
           skdm      = 0x4971deb4eed0f2e9
           ivm       = 0x8accc6c6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0xee6777
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf920679852db2f70
           ivs       = 0x9b12c0a3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb5ab3ca6
  crc       = 0xee6777
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf920679852db2f70
           ivs       = 0x9b12c0a3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  4a:d7:e9:af:b8:47
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa940007b
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa940007b
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa940007b
  crc       = 0xdc9747
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'b\\xb8\\x82\\xcaׅ\x0b\x16\x01\\xaa\\xdak\\xb3\uf023'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa940007b
  crc       = 0xa7c8a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '-\\x8f!.\\x84\\x96hy\\xe3b\\x98sՉр'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa940007b
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3ed9f7ed6edf1a3cf338ef467e38531e
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cda6b075b7cadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa940007b
  crc       = 0x93e803
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6ͦ\\xb0u\\xb7\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa940007b
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa940007b
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xa940007b
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa940007b
  crc       = 0x738707
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x1d40cbd7dc4f8c99
           ivs       = 0xec244625

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa940007b
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa940007b
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa940007b
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  76:85:5b:25:f3:2d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0xc7a895
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb4d\\xb0\\xf3\\xb4@Iy\\xfbh\\xd5\\xdd\x08Dј'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0x814967
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '+\\xe4r\x16\\x8e\\x85\\xbf\\xfd\\xc9\x10ȴ\x11\\xe2\\xfc\\x88'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd bb4e8b7eaa4140130877f259fa77cc47
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb66a6b075b794bb53c5e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0xe69319
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebf\\xa6\\xb0u\\xb7\\x94\\xbbS\\xc5\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0x12e5b0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe54c82548c3aed0b
           ivs       = 0xf3dd47d3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cd
dec_pkt 09d2
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x386d96ec
  crc       = 0x12e5b0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe54c82548c3aed0b
           ivs       = 0xf3dd47d3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  83:38:2e:1e:82:02
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0x497bc9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "!\x0e\x00\\xc4|\\xb6'\\xc3\\\\xaef\x15\\x90\x0bx\\x84"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0xf47732
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1a\\xbc-\x10\\xbb|\\x91\x13ڊ\\xb8D\\xd1;\x03\\x83'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3698ed756890542062caa60219ad999f
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b753d8ba5bcadda9627177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0xe938f6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7Sغ[\\xcaݩbqw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0x2f8a25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9a83af1f45fc954e
           ivs       = 0x578cf8b9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cd
dec_pkt 09d2
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0x99ec3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x42e1057831457e80
           ediv      = 0xc50c
           skdm      = 0x61ba3557660e6791
           ivm       = 0x81f88db3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0x2f8a25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9a83af1f45fc954e
           ivs       = 0x578cf8b9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfa0616ee
  crc       = 0x2f8a25
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9a83af1f45fc954e
           ivs       = 0x578cf8b9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  f2:94:46:0d:83:dd
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xc85a2ab3
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xc85a2ab3
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc85a2ab3
  crc       = 0x9eee45
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'LD]\\xd8\\xf2\\xd7\\xfa\\xdfGTpk\\xd63l\x18'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc85a2ab3
  crc       = 0xc0f30d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa9U\\xaciN\\xa0\x04F\\xe8L\\xfal<s\\xf8N'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xc85a2ab3
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c83e33f66dbfaec09c4bc376344a2492
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 88d7ca91e2b5722430f723d9ccfd4836
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xc85a2ab3
  crc       = 0xe0faa3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x88\\xd7ʑ\\xe2\\xb5r$0\\xf7#\\xd9\\xcc\\xfdH6'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xc85a2ab3
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xc85a2ab3
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xc85a2ab3
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc85a2ab3
  crc       = 0x483eee
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x6d07b9f9f1c2ecc9
           ivs       = 0xe2cc0b4b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc85a2ab3
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xc85a2ab3
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc85a2ab3
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cd
dec_pkt 09d2
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a5:bf:3b:3f:08:45
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0xa5ebe9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc3 uJm\\xa8\\\\xcc$\\x8b\\xbdpb\\xce\x19\\xbd'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0xe58f0a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8b\\x90\x02\\x84\\xf5\\x8e\\xc0\x00\\x8f\\xa1%}O\x01 \\xa8'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 9fe9ba59a674edd6f0c3e89c44810307
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0xcd8f1f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0xa55288
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa4f7b425d6a0368b
           ivs       = 0x7b719265

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c1
dec_pkt 09de
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5e18e7cf
  crc       = 0xa55288
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa4f7b425d6a0368b
           ivs       = 0x7b719265

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  25:ec:42:09:3d:ed
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0x105834
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xad\\xb3=\\xea\\x99\\xd5v\\xe0\r\\xa8\x1fmߠ2j'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0x1ff60e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\x1cI\\xc0\\xe1Yú;\\x8d'\x0b\\xd84ld\x7f"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 13c224b8cb23a013a960c5074678bbc4
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 87ad3bd3c0d69dedef4e957074a74abc
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0x9f5c08
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x87\\xad;\\xd3\\xc0֝\\xed\\xefN\\x95pt\\xa7J\\xbc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0xfe2e17
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x1dfa468ab142da84
           ivs       = 0x92d909c9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c1
dec_pkt 09de
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0xb7f50a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x6b991a903121c1e7
           ediv      = 0xb176
           skdm      = 0xef3b1a060bb51149
           ivm       = 0x24946245

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0xfe2e17
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x1dfa468ab142da84
           ivs       = 0x92d909c9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbc0d5c43
  crc       = 0xfe2e17
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x1dfa468ab142da84
           ivs       = 0x92d909c9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  52:22:82:b6:f4:4d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xaa7b3203
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xaa7b3203
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xaa7b3203
  crc       = 0x881ab
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x99\\xcb?0\\xaez\\xe8\x07\x1d肧Q\\x8c\rV'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xaa7b3203
  crc       = 0x638274
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'x\x18K\\xf2\x14\\x8d\\x98aa\\xc6u\\xbc\\xa9\\xf8\\xea\\xb8'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xaa7b3203
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 0e0ff5dc2435a5b1192f724946d42b62
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd c0d69ded60ebce76ba53255edda9122f
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xaa7b3203
  crc       = 0xba149f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xc0֝\\xed`\\xeb\\xcev\\xbaS%^ݩ\x12/'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xaa7b3203
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xaa7b3203
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xaa7b3203
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xaa7b3203
  crc       = 0x313e39
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xfe46e584b1308a23
           ivs       = 0x1e02cf8b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xaa7b3203
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xaa7b3203
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xaa7b3203
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c1
dec_pkt 09de
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  58:ea:ea:e4:73:8e
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0x5e6393
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\rv\\xa2~,\x1e\x15rp\\xda\t\\x98v\x0e|$'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0x71c855
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xadkaHI\\xa8\\xa0]ɮ\\xdc\x0eު\\x8a\\xc1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 05d4138761be51edd90b91b205c0302d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0xb4e024
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0xdcc220
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd8553ec7fa7ea57
           ivs       = 0x8c7d3df9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c0
dec_pkt 09df
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf617283c
  crc       = 0xdcc220
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd8553ec7fa7ea57
           ivs       = 0x8c7d3df9

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  24:92:8c:a4:64:2b
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0xe1b67b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xed\\xb5=\\xf6P\\xf8\\xf2j<\x1d\\xb5\\x85\\x99`X\\x95'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0xd76d66
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8e\\xe1\\xa6\\xe1\x1fX\\xb4\\xea\\x853E\\xdfe\x1f\t\\xa0'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd d7d75ccca99558b10353c4db6be68353
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 96c2d6cd4b61eb6694bb53c5cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0xb15686
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x96\\xc2\\xd6\\xcdKa\\xebf\\x94\\xbbS\\xc5\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0xda3a19
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa4aef6ce0fcd971d
           ivs       = 0x1274455c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c0
dec_pkt 09df
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0x1018b1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xc534a387d152b6e8
           ediv      = 0x14a9
           skdm      = 0x316d5f42faf3880a
           ivm       = 0xc3c14517

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0xda3a19
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa4aef6ce0fcd971d
           ivs       = 0x1274455c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x77382609
  crc       = 0xda3a19
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa4aef6ce0fcd971d
           ivs       = 0x1274455c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  8c:af:44:59:d9:3f
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4900fd71
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4900fd71
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4900fd71
  crc       = 0x97f3e8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'A^\\x9cR\\xdb\\xdeI\nmY~\\xb0T@\x08\\x94'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4900fd71
  crc       = 0x5e9508
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x92\\x9aN\x1b\\xe0ؗL\\xdfu~\x1c\\x81\\x96c\\xf4'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4900fd71
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 01d64925dea09f10a683958af7c79754
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad93b2dc9d1a2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4900fd71
  crc       = 0x23252a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93\\xb2ܝ\x1a/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4900fd71
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4900fd71
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4900fd71
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4900fd71
  crc       = 0xeef6cc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc10ef47d37342318
           ivs       = 0xfaa7adc

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4900fd71
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4900fd71
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f987
dec_pkt 487b
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4900fd71
  crc       = 0x732f0f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_RSP
###[ LL_PAUSE_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c0
dec_pkt 09df
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
Hypothesis 3: 8 states.
-----------------Pre Start-----------------
Master Address:  b0:04:04:4f:79:cd
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0x8fd1e3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "R'k\\x88r:\\xb4FSpy\\xfa\\x8a\\x99\\xba\\xe0"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0x162734
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\x03\x0b\\xa1'䋅\\xba\\xaf\x19\x0f\\xe0^n\\xd3d"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3c977fa0d825b17904d07f4711fd6778
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd ca510a2be52885152359ee264996bb4b
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0x3c3858
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xcaQ\n+\\xe5(\\x85\x15#Y\\xee&I\\x96\\xbbK'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0x51d313
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x5e59928c75f7520e
           ivs       = 0x297af234

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0xaebfd2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x1b9ffe77cc85c4c9
           ediv      = 0xfda5
           skdm      = 0x5ae9c6032f1e7844
           ivm       = 0xc4c70470

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0x51d313
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x5e59928c75f7520e
           ivs       = 0x297af234

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd4a3c570
  crc       = 0x51d313
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x5e59928c75f7520e
           ivs       = 0x297af234

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  dd:87:bf:ee:cb:c5
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0x96897e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x98ੇ\\xcdMǳ\x01\\xe4\r\\xa3\x1a\\xbe\\xe2\x16'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0x72daa6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xe1n\x05\x05@\\x8e\x03\\xd7w\x02Yz\\xbf\x05OX'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c9cf1d75909a0d6e10177d6fac195536
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd b075673bd8bab31ded5489933955e2e2
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0xbe3343
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xb0ug;غ\\xb3\x1d\\xedT\\x89\\x939U\\xe2\\xe2'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0x3bfbd0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa5679142c633b793
           ivs       = 0x56df29ef

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0xf23a44
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb98450bbff55d48f
           ediv      = 0xb8d4
           skdm      = 0x13b466c5e7f68725
           ivm       = 0x5ad903de

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0x3bfbd0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa5679142c633b793
           ivs       = 0x56df29ef

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf559d3b1
  crc       = 0x3bfbd0
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xa5679142c633b793
           ivs       = 0x56df29ef

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  8f:7c:be:86:c4:3f
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0x2a2f20
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd7%\\xb7\\xf9ݫ\x11\x10\n\\xa1\\xc0#wo_\\xeb'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0xff4650
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc2\x11\x19\\xd7\x04\\xfc<\\ײq\\xc4\t\x14\\xf6O'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 8bf993fea99448363b6e41557c214ce3
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd eb8bd762f6c56bb51d32f7db0d99fbe9
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0x4fa246
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xeb\\x8b\\xd7b\\xf6\\xc5k\\xb5\x1d2\\xf7\\xdb\r\\x99\\xfb\\xe9'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0x6da6e3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9bcb32bb4b386038
           ivs       = 0x817a1f92

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0xfaf2c7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xef6e6d60f9b88400
           ediv      = 0x16e4
           skdm      = 0x611a17d8d2d1645e
           ivm       = 0x7ba1d47f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0x6da6e3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9bcb32bb4b386038
           ivs       = 0x817a1f92

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xbe4cb66d
  crc       = 0x6da6e3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x9bcb32bb4b386038
           ivs       = 0x817a1f92

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  17:c6:3e:32:4e:98
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0xe5a92b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd9w\\xa0T\\xf5\\x91F\\x90\x0bB\\xa6\\x9c\\xf2\\xf6.\\xb5'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0xcd78af
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1d\\xdcW\\xbe\\xc8Z]BYv}\x1a\\xe8\\x98\x14\x17'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 351892bd44451854c25949d886b376ee
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0x79f98b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xb491f5b60cf6aa7
           ivs       = 0xfc0ff944

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0xa3a015
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x4f65fcc7f705e7e2
           ediv      = 0x92d1
           skdm      = 0x5fbbf8f959fc6a71
           ivm       = 0x9aac6933

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0xa3a015
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x4f65fcc7f705e7e2
           ediv      = 0x92d1
           skdm      = 0x5fbbf8f959fc6a71
           ivm       = 0x9aac6933

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0x79f98b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xb491f5b60cf6aa7
           ivs       = 0xfc0ff944

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xe663ca41
  crc       = 0x79f98b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xb491f5b60cf6aa7
           ivs       = 0xfc0ff944

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  26:5e:32:66:d4:3d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa327f93d
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa327f93d
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa327f93d
  crc       = 0xd879bb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '?\x06\x19W\x1a{yC\\xe3J\\xb8\x12g[\\x99\x1d'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa327f93d
  crc       = 0x58375f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '˷{\\xe0\\xba\\xc0\\xbd|L\\xe0Š}\\x86QB'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa327f93d
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 721656df8a7b1368a6a1838299b686f7
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd b67294925b394a49ff4896f37c24cbfd
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa327f93d
  crc       = 0x9e75a3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xb6r\\x94\\x92[9JI\\xffH\\x96\\xf3|$\\xcb\\xfd'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa327f93d
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa327f93d
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xa327f93d
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa327f93d
  crc       = 0x2f5fd8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x7e8c8bd6a6509b57
           ivs       = 0x4d0b1f20

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa327f93d
  crc       = 0x2f5fd8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x7e8c8bd6a6509b57
           ivs       = 0x4d0b1f20

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa327f93d
  crc       = 0x2f5fd8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x7e8c8bd6a6509b57
           ivs       = 0x4d0b1f20

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  59:82:13:b1:d7:df
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0xcea246
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'u\\xb9\x1a\\x85\\xa75M*\\xbc\\xdf\\xc9c\x047$T'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0x52db04
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '`\\xe9/V\\x9c\\xcbSN\\xc2\\xe5\x07\\x85\\x961:\x0f'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3cb98d6be9cd16a949d1eb5da0d9900f
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb66a6b075b794bb53c5cadda962
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0xb2cfd1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebf\\xa6\\xb0u\\xb7\\x94\\xbbS\\xc5\\xcaݩb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0x1048ac
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x5579164977f0e029
           ivs       = 0xd89a47c0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f988
dec_pkt 4874
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0xf2f89f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x47784206581ba79d
           ediv      = 0x3e0a
           skdm      = 0x14c989886b890cfd
           ivm       = 0xfcb5f23f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0x1048ac
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x5579164977f0e029
           ivs       = 0xd89a47c0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xfb84fb76
  crc       = 0x1048ac
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x5579164977f0e029
           ivs       = 0xd89a47c0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a8:b6:ce:43:ee:94
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x2096ec88
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x2096ec88
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x2096ec88
  crc       = 0xc80117
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x07\\xa9\\xd0?%֟J \\xf5\\xa4Ļ\\x88F\\xe9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x2096ec88
  crc       = 0x5d4dc7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 't\\xb0D\\xac\\x95\x02\x0f\\xfdF\\xbb\x7fA\\xbfB\\xa9\\xf5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x2096ec88
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 4e55da9a03f9b28aa2d193b05664fab7
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 87ad3bd360ebce76ba53255edda9122f
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x2096ec88
  crc       = 0x478654
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\x87\\xad;\\xd3`\\xeb\\xcev\\xbaS%^ݩ\x12/'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x2096ec88
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x2096ec88
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x2096ec88
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x2096ec88
  crc       = 0x6e843f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x34acfd756e023573
           ivs       = 0x8914eaf8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x2096ec88
  crc       = 0x6e843f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x34acfd756e023573
           ivs       = 0x8914eaf8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x2096ec88
  crc       = 0x6e843f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x34acfd756e023573
           ivs       = 0x8914eaf8

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  af:59:23:0e:16:a6
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf8b468d5
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf8b468d5
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf8b468d5
  crc       = 0x93a84a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x03\\xce\\xff\\xce#{\x12\\x925\\xd3iS\x02Y\\xa59'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf8b468d5
  crc       = 0x47c62d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa6\\xd5hG0\x12\\xe5\x0b\\x80\\xc5\\xe9\\x94\x02m"m'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf8b468d5
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e8ba72c9ca3873a0be39736c72873d68
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 284729ac94a314568c64b99b46b2dc4d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf8b468d5
  crc       = 0x92c1b9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '(G)\\xac\\x94\\xa3\x14V\\x8cd\\xb9\\x9bF\\xb2\\xdcM'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf8b468d5
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf8b468d5
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xf8b468d5
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf8b468d5
  crc       = 0x2877d1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xd9312a1f2e0e4135
           ediv      = 0xfcef
           skdm      = 0xd2b823e46dc15560
           ivm       = 0x3a75a9f5

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf8b468d5
  crc       = 0x4a3270
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x65499e4d3d5d482b
           ivs       = 0x81e98a54

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  80:29:34:b8:90:87
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0xb12942
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '7\\xc7\\xc7V\\x86\\xa0_\x131m\\xd1+P\x0e\\x95\\xf8'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0x9d3b28
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc4\\xda\x01\\xdf"\x0bv\\x94ȅ\\xf0D\\xc1z\\x83\\xd2'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e5f469a20105461d96d184bb9089d6f7
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd59ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0x18c19
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcdY\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0x20b588
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x8b4f8e5f7e31c5a5
           ediv      = 0x3a72
           skdm      = 0xc5f21883c5c50e1f
           ivm       = 0xcfb31729

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0x20b588
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x8b4f8e5f7e31c5a5
           ediv      = 0x3a72
           skdm      = 0xc5f21883c5c50e1f
           ivm       = 0xcfb31729

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0xfd5712
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4b7f954577cf4253
           ivs       = 0xe065f537

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7df6f864
  crc       = 0xfd5712
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4b7f954577cf4253
           ivs       = 0xe065f537

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a2:50:49:a6:93:91
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x47d760f5
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x47d760f5
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x47d760f5
  crc       = 0x19a48d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'b\\xe9T\x16r\\xed\x06\\x98:\\x91\\x8aM\x00\\xc7\x07['

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x47d760f5
  crc       = 0xbcb358
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '錰\\xd8\\xfeL\\x94W\\xcc\\xd3\\xf5\\xa3\\xbb\n3\\x89'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x47d760f5
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd ff4111cc112ea0e70d49c15818461c46
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd c46be548e2b5722498fb916cccfd4836
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x47d760f5
  crc       = 0x99e131
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xc4k\\xe5H\\xe2\\xb5r$\\x98\\xfb\\x91l\\xcc\\xfdH6'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x47d760f5
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x47d760f5
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x47d760f5
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x47d760f5
  crc       = 0xf59f53
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x88ef8cbc537a4c03
           ediv      = 0xef39
           skdm      = 0x3f3b0b82eef03a0e
           ivm       = 0x416993d3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x47d760f5
  crc       = 0x7fc304
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x3e64dccf0aa71a95
           ivs       = 0xfdd8544f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x47d760f5
  crc       = 0x7fc304
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x3e64dccf0aa71a95
           ivs       = 0xfdd8544f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  b6:c3:86:c1:28:c1
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x7e9e2694
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x7e9e2694
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7e9e2694
  crc       = 0xcb09ae
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xad\\xe5p\x1f\\xef\\xa9C\\xf5\\xba\x1f\\xaeH\\xa83\\x9c\x12'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7e9e2694
  crc       = 0xa9005c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd5)˦T\x1d\\xa4\\xf5.\\xaa\x04\x192\\xa4\\xb8F'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x7e9e2694
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c66b3db54af20a63052f8093020f8a14
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 1ea5b0e58f52d87227cbdda1c872776a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x7e9e2694
  crc       = 0x528734
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = "\x1e\\xa5\\xb0\\xe5\\x8fR\\xd8r'\\xcbݡ\\xc8rwj"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7e9e2694
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x7e9e2694
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x7e9e2694
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7e9e2694
  crc       = 0x7a460b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xbb87fead7af30e81
           ediv      = 0x23f2
           skdm      = 0x626b64dca7f5b6e3
           ivm       = 0x1007e3e3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa2
dec_pkt 7ada
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  9b:fb:94:6b:59:57
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xd5510754
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xd5510754
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd5510754
  crc       = 0xf7a422
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'z\\xac\\xd6o"g~A0\\x96\x12\\xe7\\x86\\xc5!\\xff'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xd5510754
  crc       = 0x6625d5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf9\\xdf\x159\\xeam\\x99\\xd9\x17\t}s\\xbd\\xd3\\xed\x02'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xd5510754
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd b3cd5ab9c4c168b36fb27b5ccd9dec7d
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 7ef15aa95cbc56ae41e67efc92b91ff9
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xd5510754
  crc       = 0x42bbee
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '~\\xf1Z\\xa9\\\\xbcV\\xaeA\\xe6~\\xfc\\x92\\xb9\x1f\\xf9'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xd5510754
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xd5510754
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xd5510754
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd5510754
  crc       = 0xbba098
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xefcdfe075224de7c
           ivs       = 0x4bec9d7a

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xd5510754
  crc       = 0xbba098
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xefcdfe075224de7c
           ivs       = 0x4bec9d7a

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  88:3e:3c:af:e2:c1
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0x25f823
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xba#\\x9a\x02\\x92ΎV\x02\\x8e\\xb9:\\x94\\x94\\x99\\xa9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0xc5e583
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'l^\x10\r_ϝ\\x9a\\x96\\x85t\\xb2\u0380\\x8d\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 3b5993aeb2762d997e2f11f921e6d78f
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd59ee4e0d94bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0xf02866
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcdY\\xeeN\r\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0xdefcf5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe08c6cca20d6ac3a
           ivs       = 0x140136e3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0xa382a4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x947a7a868ded673e
           ediv      = 0xb0d8
           skdm      = 0xf577f4faf1d80a0e
           ivm       = 0x78ebf72e

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0xdefcf5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe08c6cca20d6ac3a
           ivs       = 0x140136e3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xa37e3cc8
  crc       = 0xdefcf5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe08c6cca20d6ac3a
           ivs       = 0x140136e3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  0a:eb:1c:48:80:24
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x298a640d
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x298a640d
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x298a640d
  crc       = 0xbbb3c8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'X\\x8a\\x85\\x9ej\\xfd\\xa3n\\xf4#P\x1b\\xb1\x16\\xfa\\xe0'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x298a640d
  crc       = 0x5479cc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'C\\x9c\\x9fvr\\xc1=\x12\\xee\\xe7$.(\\x8f\x15x'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x298a640d
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 8146483fce9d9752032fa599c0c1fc05
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x298a640d
  crc       = 0x409600
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x298a640d
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x298a640d
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x298a640d
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x298a640d
  crc       = 0xd8746a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x5d511847e62e1736
           ivs       = 0xa6e4fec6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x298a640d
  crc       = 0xd8746a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x5d511847e62e1736
           ivs       = 0xa6e4fec6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x298a640d
  crc       = 0xd8746a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x5d511847e62e1736
           ivs       = 0xa6e4fec6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  54:9f:bb:00:2c:85
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xb4931482
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xb4931482
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb4931482
  crc       = 0xfe1079
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x957L\\xd8\\xe0O\\xfc\x02\\xe7\\xe8\x02:\\xb4z\\xe0\\xe9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb4931482
  crc       = 0x2ae0b2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '.\x188-\x15\\xe1Ц0\x17=R(-\\xbd#'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xb4931482
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c40aaa005a5b27bc533cfc1517f81aea
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xb4931482
  crc       = 0xfa0a13
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb4931482
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb4931482
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xb4931482
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb4931482
  crc       = 0x29b51c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xcf19a377d431fc5f
           ivs       = 0x7adc2776

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  27:3d:b4:6d:60:37
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xb1546c87
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xb1546c87
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb1546c87
  crc       = 0xa13917
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x12Ԃ_4\\xd9\\xc0Zg\\xffܮ\\x9b\\xb1[\x1e'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb1546c87
  crc       = 0xf2c57d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb2ŃКf\\xf4Zdre\\xfe\\xa01\\xb5S'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xb1546c87
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 7badb87299c313e32cebc2874c5912f9
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 1ea5b0e58f52d87290e5eed4c872776a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xb1546c87
  crc       = 0x4cf577
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x1e\\xa5\\xb0\\xe5\\x8fR\\xd8r\\x90\\xe5\\xee\\xd4\\xc8rwj'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb1546c87
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb1546c87
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xb1546c87
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb1546c87
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa4
dec_pkt 7adc
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb1546c87
  crc       = 0x3552ec
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xcb9f16601606772f
           ivs       = 0x7abef888

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  0a:ee:81:dc:42:d6
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0x606d91
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "#\\xf6\\xa6\\xd0'\\xbe'X\\xc7\\xc7\x11\\x8a\\xccve\\xfb"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0x4932a7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8adFe\\xfd\\xc0\\xf6̮\\xd8k\\x93`\\xfa.\\x89'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 8087532bc00642954d8ccf94497fcd46
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 53d8ba5b2a6cdda9e5ee54317177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0xa0d7e3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Sغ[*lݩ\\xe5\\xeeT1qw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa4
dec_pkt 7adc
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0xfde619
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb8f8708058297522
           ediv      = 0x9ddc
           skdm      = 0x7a86634773a806a3
           ivm       = 0x52caa0bd

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0xe95fdb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe06cd6560f3b5a45
           ivs       = 0x9aed697c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x43a8d832
  crc       = 0xe95fdb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xe06cd6560f3b5a45
           ivs       = 0x9aed697c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  30:b4:35:e9:a5:42
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x5b18d590
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x5b18d590
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5b18d590
  crc       = 0xb7f0ff
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd8\\xf2l\\xf8f\x0c\\xbbQ2i\\xc6<Uꝴ'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5b18d590
  crc       = 0xee5a05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\\xd0J\\xb1\\xe3樜\\xcc'\\xd6\\xd4\\xfbӼ\\xc6J"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x5b18d590
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 7033bbc23c9c87b212dee4960e6e5312
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f96c2d6cd59ee4e0d94bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x5b18d590
  crc       = 0x684b2b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/\\x96\\xc2\\xd6\\xcdY\\xeeN\r\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5b18d590
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x5b18d590
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x5b18d590
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5b18d590
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa4
dec_pkt 7adc
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5b18d590
  crc       = 0xd982a9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xb86c60243413ff4d
           ivs       = 0x2b8c5f03

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5b18d590
  crc       = 0xd982a9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xb86c60243413ff4d
           ivs       = 0x2b8c5f03

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  69:c4:8a:38:c5:44
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xde148c39
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xde148c39
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xde148c39
  crc       = 0x2ed590
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xbf\\xf1\\xfa\\x82\\xdbr\\xcdQ\\xd4,CL_\\x8eu\\xbf'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xde148c39
  crc       = 0xe38287
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x14\\x991\\xbb\x0f\x0e?\x11\\xf0H\x03\\xb9*\x03\\x85`'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xde148c39
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e1312648ca53108eb533621d38bb2353
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 7ef15aa9bf78ad5441e67efc23733ffa
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xde148c39
  crc       = 0x959fbe
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '~\\xf1Z\\xa9\\xbfx\\xadTA\\xe6~\\xfc#s?\\xfa'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xde148c39
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xde148c39
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xde148c39
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xde148c39
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa4
dec_pkt 7adc
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  55:62:c2:f3:7e:ca
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x5244f657
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x5244f657
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5244f657
  crc       = 0xf35980
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '1\x1bԽd\\x9a/P%\x1d\\xecV\\xd1!\\xdcm'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x5244f657
  crc       = 0xb42181
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xdd\x0e\x12\\x8a\\xd5\\xf9\\x9c"G\\x97\\xfc\\x9c:%\\xbe\\xd5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x5244f657
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd cd25d87a3ffa3e50877765b8a088acd5
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb6653d8ba5bcadda9627177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x5244f657
  crc       = 0xf701b9
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebfSغ[\\xcaݩbqw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x5244f657
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x5244f657
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x5244f657
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5244f657
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa7
dec_pkt 7adf
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x5244f657
  crc       = 0x336f5d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xdb632f94f6164918
           ivs       = 0x560795c5

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  14:15:dc:1c:69:9b
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0xda7d36
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xf4\\xaeTC\\xd9\x1a\\xd2\\xd1u\x1f\\x9c\\xcd;R"\\xc9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0xb17c76
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\\xe2\x03\\xcd\\xe1\\xc9!\\xe1k\\xe1\\xe4\\xf2'\\?\\x81R"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 129caf46d51bcac7c5b95bf60c0f5660
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 53d8ba5b2a6cdda9e5ee54317177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0xa0d7e3
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Sغ[*lݩ\\xe5\\xeeT1qw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa7
dec_pkt 7adf
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0x98a535
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x9ffae832719a0369
           ediv      = 0x8642
           skdm      = 0x4ad880c84b7c2d9
           ivm       = 0x474c77e2

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0xef13e4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x212aed53805abd26
           ivs       = 0xa4070b63

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xb83b4808
  crc       = 0xef13e4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x212aed53805abd26
           ivs       = 0xa4070b63

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  85:d1:54:b4:04:79
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xefce26b0
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xefce26b0
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xefce26b0
  crc       = 0xf31092
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xa9\\xe9\x1a \\x9a2\x02\x19\\xc1\x03\\xf5\\x91\\x80\x01\x0e['

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xefce26b0
  crc       = 0xdbe09d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'i\\xadV3{\x08\\x8aX\x07J\\xe9ԏq(('

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xefce26b0
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 4d7cf9a8c1468a77b542aeef5758699c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b753d8ba5bcadda9627177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xefce26b0
  crc       = 0xdebdfa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7Sغ[\\xcaݩbqw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xefce26b0
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xefce26b0
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xefce26b0
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xefce26b0
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa7
dec_pkt 7adf
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xefce26b0
  crc       = 0xc11799
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd3d39341de663f23
           ivs       = 0xbb9cb98a

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xefce26b0
  crc       = 0xc11799
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xd3d39341de663f23
           ivs       = 0xbb9cb98a

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  75:c2:1d:48:9d:bd
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x7585f61b
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x7585f61b
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7585f61b
  crc       = 0xb5742d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\u061c\\xddA\\xaf\x0f\\xa5\\xba\\x87\\x92\\xb3\\xbe\\x81\\xdb\x07 '

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x7585f61b
  crc       = 0x349585
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'yEp\\xa9\\xb9\\x90\\xabE\\x85Cc7\\xe6\x11\\x90\x12'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x7585f61b
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd d3e460e87b4ad9ee10e73a920175eff9
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 095b77aec0d69dedef4e957074a74abc
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x7585f61b
  crc       = 0x7ad76b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\t[w\\xae\\xc0֝\\xed\\xefN\\x95pt\\xa7J\\xbc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x7585f61b
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x7585f61b
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x7585f61b
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x7585f61b
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa7
dec_pkt 7adf
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  0f:16:3f:93:9a:f0
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x27069d51
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x27069d51
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x27069d51
  crc       = 0x21f075
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xb5\\xf04\\xa1\\xf6\\xbcIAOh0E}\\xa5˖'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x27069d51
  crc       = 0x449819
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xdc\x15=\\xae\\x8fS?\\xdf\\xc1\\xf9\x1b\\xda\x13\\xde\\xef\\x9a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x27069d51
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd eebf4f176e6c934cd19481d1060cb468
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb66a6b075b7cadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x27069d51
  crc       = 0x9d042e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebf\\xa6\\xb0u\\xb7\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x27069d51
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x27069d51
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x27069d51
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x27069d51
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afab
dec_pkt 7ad3
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x27069d51
  crc       = 0x2a0507
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf135035f347663f1
           ivs       = 0x7c2704e2

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c6:2c:31:3a:a8:08
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0x690ec6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd0l\n\x01,\\xc6C\x023\\x8bM\\x97w2/\\xc2'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0x184af6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'j\\xa2䜆1!\\xb7RSq\\xe36\\xfeH1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd ce9055af1f0ef630e24227e9d9a105ab
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2b85ad9396c2d6cd2f77a78294bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0xb4e024
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '+\\x85\\xad\\x93\\x96\\xc2\\xd6\\xcd/w\\xa7\\x82\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afab
dec_pkt 7ad3
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8408
dec_pkt fc0c
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0x1201f4
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xee134966d8941252
           ediv      = 0xc24d
           skdm      = 0x606355b7836b4c77
           ivm       = 0x411511b5

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0xfc7484
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x6c3cefbe12fe1a6a
           ivs       = 0x4b2003d1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1cea5697
  crc       = 0xfc7484
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x6c3cefbe12fe1a6a
           ivs       = 0x4b2003d1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  d2:19:86:94:ea:d9
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xe6c9ecd2
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xe6c9ecd2
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe6c9ecd2
  crc       = 0xb96bfc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'C\x9e5\\xdcC̖\\xd6Cn\\x9b\\x8f\\x85i\\xda'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xe6c9ecd2
  crc       = 0xbd6d85
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'v\x19\\xdf\x01\x1f^)\\x9a\\xad\\x80\x13\\xd1\x13+\\xe2\\xa4'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xe6c9ecd2
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 97e58aa4837bbbfd93b7427580389d61
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f96c2d6cd59ee4e0d94bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xe6c9ecd2
  crc       = 0x5fce27
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/\\x96\\xc2\\xd6\\xcdY\\xeeN\r\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe6c9ecd2
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xe6c9ecd2
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xe6c9ecd2
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xe6c9ecd2
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afab
dec_pkt 7ad3
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xe6c9ecd2
  crc       = 0xe96f6c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc4902fddb836770b
           ivs       = 0x5da2d859

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 8409
dec_pkt fc0d
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xe6c9ecd2
  crc       = 0xe96f6c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xc4902fddb836770b
           ivs       = 0x5da2d859

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f989
dec_pkt 4875
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  92:3e:61:be:9b:6c
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xae695932
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xae695932
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xae695932
  crc       = 0x195944
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xdd3xF\n\\x9c)\\xebO\\x8d\x06\\xc1\x1a"\\xbf\\xdf'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xae695932
  crc       = 0x9230b2
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '@o\\xaf\\x86\x10f\\xaa\\xc7\\xe5{jR\\xc9\t\\x85!'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xae695932
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 316748c7088420c997be364f80941b6b
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f96c2d6cd59ee4e0d94bb53c5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xae695932
  crc       = 0x684b2b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/\\x96\\xc2\\xd6\\xcdY\\xeeN\r\\x94\\xbbS\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xae695932
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xae695932
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xae695932
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_PAUSE_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xae695932
  crc       = 0xb39b0e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_PAUSE_ENC_REQ
###[ LL_PAUSE_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afab
dec_pkt 7ad3
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  9b:60:cc:38:0c:3e
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0xe834fc
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '~?@y\\xf5t\\xdb\\xc0z?ijߒ˘'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0x505bde
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'Y\\xfcr#Qup\\x80\x0fR\\xb38\\x84\\xaf\\x94\\xd7'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd e5193a2b436241884d198afe1a83bdc1
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd be568ec2ac95a3b4dd8f6441ed47b2a4
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0xb01dca
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xbeV\\x8e¬\\x95\\xa3\\xb4ݏdA\\xedG\\xb2\\xa4'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0x58b42d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x89391ab6c678f203
           ivs       = 0x8d79d62c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0x50d713
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x851e27d88eb80168
           ediv      = 0x7657
           skdm      = 0xf632f0bddd8b465c
           ivm       = 0x2d575e11

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0x50d713
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x851e27d88eb80168
           ediv      = 0x7657
           skdm      = 0xf632f0bddd8b465c
           ivm       = 0x2d575e11

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x6f5f6a0e
  crc       = 0x58b42d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x89391ab6c678f203
           ivs       = 0x8d79d62c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  14:6d:e6:d8:c5:c5
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0x37f8c7
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd5\x17\\x9e\\xca\\xf9U\x0f\\x82\\xd7\x1e\\xcb]\x10\\x84\x12\x1d'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0x5f63ef
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc4\\xf9s\\xa8Wa\x1d6\\xa7Н\\x82\\xd0XNg'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 76b4318de980551eea6d581d60c54d29
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0xfa0a13
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0xd0ec90
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x3de8030ec731a915
           ivs       = 0x98468dd0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0xe56008
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x84bc87a83eeba4df
           ediv      = 0xf17d
           skdm      = 0x2ef838be7687ea14
           ivm       = 0xec133461

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0xe56008
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x84bc87a83eeba4df
           ediv      = 0xf17d
           skdm      = 0x2ef838be7687ea14
           ivm       = 0xec133461

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0xe56008
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x84bc87a83eeba4df
           ediv      = 0xf17d
           skdm      = 0x2ef838be7687ea14
           ivm       = 0xec133461

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0xd0ec90
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x3de8030ec731a915
           ivs       = 0x98468dd0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf4cb5679
  crc       = 0xd0ec90
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x3de8030ec731a915
           ivs       = 0x98468dd0

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  67:52:8d:2c:19:7a
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0x8e5e51
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x8dO\x05\\xc9:\\x88Qy\\xe0K\\x8f`\t/\x13@'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0x61d896
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xc9z\\xcc\x012\x19\\x84\\xbc\n\\xc1\\xac\\xb6\\xc4V\\xfd\\xc5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 2179d0735fa34ba4c202af99f4db0042
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a6b075b753d8ba5bcadda9627177aa9c
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0xe938f6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa6\\xb0u\\xb7Sغ[\\xcaݩbqw\\xaa\\x9c'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0xcba649
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x54198fd78bf31b90
           ivs       = 0x84e2be68

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0xcb5d79
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xa008216bc320b443
           ediv      = 0x593c
           skdm      = 0x1cd2dbf98587ac79
           ivm       = 0x976f1b1c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0xcb5d79
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xa008216bc320b443
           ediv      = 0x593c
           skdm      = 0x1cd2dbf98587ac79
           ivm       = 0x976f1b1c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0xcba649
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x54198fd78bf31b90
           ivs       = 0x84e2be68

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xf287fc82
  crc       = 0xcba649
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x54198fd78bf31b90
           ivs       = 0x84e2be68

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  68:ba:8b:cd:4c:b0
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4ed380c1
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4ed380c1
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4ed380c1
  crc       = 0x994add
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '<0;\t\\x92\\x8fv6Oo\\x89\\x85\\xb4]=\\xaf'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4ed380c1
  crc       = 0x5f1ff1
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '=\\xd6\\xf6.\\xf1uL\\x9f\\xe8\\xd6\\xdc\\xc1\\x937\\xfb\x0f'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4ed380c1
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 4ac95bfe3b6b200cb30134e3152cc4f7
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 1ea5b0e58f52d87290e5eed4c872776a
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4ed380c1
  crc       = 0x7b707b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\x1e\\xa5\\xb0\\xe5\\x8fR\\xd8r\\x90\\xe5\\xee\\xd4\\xc8rwj'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4ed380c1
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4ed380c1
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4ed380c1
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4ed380c1
  crc       = 0xb04c08
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x66b69bef3a4161a7
           ivs       = 0xd74f7a35

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4ed380c1
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4ed380c1
  crc       = 0xb7b688
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xbaf054f3b5002557
           ediv      = 0xed59
           skdm      = 0x9bd2be2138e768d2
           ivm       = 0xb42fc556

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4ed380c1
  crc       = 0xb7b688
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xbaf054f3b5002557
           ediv      = 0xed59
           skdm      = 0x9bd2be2138e768d2
           ivm       = 0xb42fc556

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69c8
dec_pkt 09d7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  b9:ec:6e:7e:88:dc
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0x5c9642
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x19\\xc3g彧\\x8d5[\\xc5k\\xf3\\x91\x1b+\\xe9'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0xb1b76a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\u0379\\xa1Y\\xd6֡\\xc2/zK{E\\x94tn'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 337a2e000ea2d14180f1d77ff3441dea
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 53d8ba5b15b6ee547177aa9cde9d2ae1
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0x260561
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Sغ[\x15\\xb6\\xeeTqw\\xaa\\x9cޝ*\\xe1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0x10aecf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xcfb534efb7c21edc
           ivs       = 0x9763e835

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0xa34b04
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x3ad9101161cead5c
           ediv      = 0xe65
           skdm      = 0xf689bd47d7b5924d
           ivm       = 0xe3b98c2

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0x10aecf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xcfb534efb7c21edc
           ivs       = 0x9763e835

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4e5e07a1
  crc       = 0x10aecf
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xcfb534efb7c21edc
           ivs       = 0x9763e835

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  56:e8:a6:25:a1:2b
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0x6bd8bd
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'Kr8\\xd4J0\\x9b\\xab\\x94\\xd8Ƚ\\x89\\xcd\\\\x9b'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0x7fcacb
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'hg\\xde\\xe7*6\\xb8\\xbb\\xb3\\x8b÷ȪFZ'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 2de562bb6e77fa4edc1dc132ad60e82c
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd d8bab31d6cddd90e3955e2e29f2a71f5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0x8f926a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'غ\\xb3\x1dl\\xdd\\xd9\x0e9U\\xe2\\xe2\\x9f*q\\xf5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0xdd7ffa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf348aa40bcf7aad
           ivs       = 0x972f942b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0x6fde
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x81e40539e9ff7b82
           ediv      = 0xd2c1
           skdm      = 0x1ac6e117c94afa6e
           ivm       = 0xf16da615

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0xdd7ffa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf348aa40bcf7aad
           ivs       = 0x972f942b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0x6fde
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x81e40539e9ff7b82
           ediv      = 0xd2c1
           skdm      = 0x1ac6e117c94afa6e
           ivm       = 0xf16da615

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0xdd7ffa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf348aa40bcf7aad
           ivs       = 0x972f942b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x3ad646b3
  crc       = 0xdd7ffa
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xf348aa40bcf7aad
           ivs       = 0x972f942b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  be:0f:af:a6:72:8d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0x610949
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "&\\xe6\\xb3\\|o'\\x9d\x11/\\xc3b\x7f@J\\xe8"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0x3815c6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '1D\\xa1\\xe9\\xab\\xd4\r9\x19^\\xbdҨu\\x90\x1a'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 8a50c2b59e1d13d69003068a1f678bdc
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0xcd8f1f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0x7e591a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x33c3d0d4bfb0d782
           ivs       = 0xfd429bc6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0x9ffc51
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xc7ce25ab518db492
           ediv      = 0x1bb8
           skdm      = 0xd7f201df9117f0fd
           ivm       = 0x74c969f6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0x7e591a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x33c3d0d4bfb0d782
           ivs       = 0xfd429bc6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0x7e591a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x33c3d0d4bfb0d782
           ivs       = 0xfd429bc6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xaafb26d6
  crc       = 0x7e591a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x33c3d0d4bfb0d782
           ivs       = 0xfd429bc6

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  6d:f3:a3:3c:15:f1
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x85aeda6a
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x85aeda6a
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x85aeda6a
  crc       = 0x923854
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'H\\xaf\\xa4\n5\\xa4܀\\xad\\xb9\\x9eo\\xa5\\xf8+X'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x85aeda6a
  crc       = 0x47fbb6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '&\\xd6o=\\x86?i\\xcfbt+\\x83(+\\x8f\\x85'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x85aeda6a
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c25adf72a4ece39e4ff0b9cc91e6c6eb
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb66a6b075b7cadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x85aeda6a
  crc       = 0xaa8122
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebf\\xa6\\xb0u\\xb7\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x85aeda6a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x85aeda6a
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x85aeda6a
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x85aeda6a
  crc       = 0x71ecb8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x89df15b0a6438d18
           ivs       = 0xf5c2ee9d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x85aeda6a
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x85aeda6a
  crc       = 0xc4b118
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x7a9d043c42d56c2f
           ediv      = 0x20ad
           skdm      = 0x7726fc41f4df3df
           ivm       = 0x4d3e7f77

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x85aeda6a
  crc       = 0x71ecb8
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x89df15b0a6438d18
           ivs       = 0xf5c2ee9d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cf
dec_pkt 09d0
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  1d:fd:ee:8a:f0:82
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0x5bbe9a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 's\\x8fv\\xf7\x1e9\\x9f9\\xd7q\x11;\x07\\xb9 \\xa1'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0xc94cec
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1e\x15]B\\x93\\xf5\\xa9\x08\\xffw,\\xe1\\x8bD)z'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd c4fc9ea5900ded02a06f0041d20633c5
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 4b61eb66a6b075b7cadda962e5ee5431
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0xaa8122
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Ka\\xebf\\xa6\\xb0u\\xb7\\xcaݩb\\xe5\\xeeT1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0xa91b24
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x76da90f6c5bccac6
           ivs       = 0xb612a98b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0x6aad34
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb8eb6f4e9ebcbd21
           ediv      = 0xea15
           skdm      = 0x6c8293ef36cc2262
           ivm       = 0x3448a2a3

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1383d8aa
  crc       = 0xa91b24
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x76da90f6c5bccac6
           ivs       = 0xb612a98b

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  42:21:ad:83:b0:ee
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0x53bf7d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'E"\\xdeyv\\x8c.\\xed\\xb4\\xc5d\\xffYj\\x8a\\xd3'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0xbf212a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'N,\\xc1\\xddU_?K+m\\x97\\xde\\xf7\\xb3\\xa2\\xfb'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd fc57ead77586a81fb669eb6b7ccb248b
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad9359ee4e0d2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0x77130c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93Y\\xeeN\r/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0xcad50c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xdeea03d379fdc806
           ivs       = 0xd1cbf242

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0xd4b5ce
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb9e3d70f3bf74dfb
           ediv      = 0x2ac1
           skdm      = 0x8a019b48dc2a2142
           ivm       = 0x4e7f1c6f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0xd4b5ce
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xb9e3d70f3bf74dfb
           ediv      = 0x2ac1
           skdm      = 0x8a019b48dc2a2142
           ivm       = 0x4e7f1c6f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0xcad50c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xdeea03d379fdc806
           ivs       = 0xd1cbf242

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4118029a
  crc       = 0xcad50c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0xdeea03d379fdc806
           ivs       = 0xd1cbf242

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  c6:96:51:a9:44:3d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0x17a673
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd7\\xe7\x0c\\xd6䜜\x08Au\\xa2\\xa5]\\xeb\\xe3\x02'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0xa02301
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x92\x14\x1c\\x93\\x84N\x17\\xc7ل\x15aߛ$\\xb7'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd ebf845f1dbfbcbe38114aac7af853820
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2fb2dc9d1a59ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0xcd8f1f
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/\\xb2ܝ\x1aY\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0x6a7e49
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x8ab6dc46d34e2976
           ivs       = 0x3345f1c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0xebb0ec
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x8380ff45938869da
           ediv      = 0xcdbd
           skdm      = 0x3600cf9a19193c8c
           ivm       = 0x8f3b2e3c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0x6a7e49
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x8ab6dc46d34e2976
           ivs       = 0x3345f1c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x4039b830
  crc       = 0x6a7e49
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x8ab6dc46d34e2976
           ivs       = 0x3345f1c

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  a4:64:78:c5:03:3f
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0x1c4810c2
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0x1c4810c2
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1c4810c2
  crc       = 0xe7dc5e
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "y\x00Bn|DҸk\\xceU\\xd6y\\x88\\xfd'"

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0x1c4810c2
  crc       = 0xc8e352
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "\x06Bn[B\\xf6\\xfc\x1a\\xb7\\xde/\\xe18\\x98p'"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0x1c4810c2
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd f11bd3990b90c0cb8bcd48301ddc94d2
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 510a5b2f2b85ad93b2dc9d1a2f77a782
calculate_STK
###[ BT4LE ]### 
  access_addr= 0x1c4810c2
  crc       = 0x23252a
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'Q\n[/+\\x85\\xad\\x93\\xb2ܝ\x1a/w\\xa7\\x82'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1c4810c2
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x1c4810c2
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0x1c4810c2
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1c4810c2
  crc       = 0x28545
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x111ac5a5911a3487
           ivs       = 0x393c1c53

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0x1c4810c2
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1c4810c2
  crc       = 0xf0a032
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x707e67ff008d9bc5
           ediv      = 0x8e35
           skdm      = 0xcb43270aeab820be
           ivm       = 0xab651328

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0x1c4810c2
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69ce
dec_pkt 09d1
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  2b:08:00:72:f3:73
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0x8ef880
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0x87bc24
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x91\\xaf\\xa2\\xfb@\\x91\x7f\x10\\xe5\\xf6\\xb4\\xd9?`3\\xff'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0x8a83b6
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = "!\\xb6$=\\xa6=\\xa0h\x0c\\x97'ٍ\x16\\xf0\\x8d"

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 25adb0c0758de88cfd6bf1818f0ce8a6
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 6cddd90eb6ee6c073955e2e29f2a71f5
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0xce69ce
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = 'l\\xdd\\xd9\x0e\\xb6\\xeel\x079U\\xe2\\xe2\\x9f*q\\xf5'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0x21743d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 0
     NESN      = 1
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0x95610d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x6b712ceaf697b5dc
           ivs       = 0xafdd752

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0xe57fae
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xf8d59b8aec98308b
           ediv      = 0x46e0
           skdm      = 0xa95524ee0665bacc
           ivm       = 0xf7a4337d

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cd
dec_pkt 09d2
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xdb27539e
  crc       = 0x95610d
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x6b712ceaf697b5dc
           ivs       = 0xafdd752

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  7b:21:00:e8:7c:10
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0x61c719
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\x83#\\x93\x10\\xa0\\xae\\xe5(\\xc0Tyi{\\x842\x0e'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0xc7c508
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\\xd9\x15\\xfb\\x91g^P\\\\xb2FQ\x1c\x00\\xc8@\\xbc'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 6231866a3cc09a1efd37296c4b60db20
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd a214b65e510a5b2f64b93b3559ee4e0d
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0xe7940c
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '\\xa2\x14\\xb6^Q\n[/d\\xb9;5Y\\xeeN\r'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0x490d91
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x91b9e68a86c99d3a
           ivs       = 0xf23010ef

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0x453d34
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xc4b22862daf3d055
           ediv      = 0xccea
           skdm      = 0xefcedaaf70a47c28
           ivm       = 0xd394e0df

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cd
dec_pkt 09d2
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08b
dec_pkt 32c6
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0x453d34
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0xc4b22862daf3d055
           ediv      = 0xccea
           skdm      = 0xefcedaaf70a47c28
           ivm       = 0xd394e0df

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f2
dec_pkt e691
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0x490d91
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x91b9e68a86c99d3a
           ivs       = 0xf23010ef

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_UNKNOWN_RSP / Raw
iv 0000000000000000
raw_pkt 07bf
dec_pkt e8ab
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_UNKNOWN_RSP|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xcb1ba86e
  crc       = 0x490d91
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x91b9e68a86c99d3a
           ivs       = 0xf23010ef

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 7f53
dec_pkt e29e
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  3d:bb:81:cc:40:8d
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_SLAVE_FEATURE_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_FEATURE_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_LENGTH_RSP
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_VERSION_IND
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0x691963
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 1
###[ Pairing Request ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 45
              max_key_size= 16
              initiator_key_distribution= 15
              responder_key_distribution= 15

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Request
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Pairing_Response
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0x4ea891
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 11
###[ L2CAP header ]### 
        len       = 7
        cid       = 6
###[ SM header ]### 
           sm_command= 2
###[ Pairing Response ]### 
              iocap     = NoInputNoOutput
              oob       = Not Present
              authentication= 1
              max_key_size= 16
              initiator_key_distribution= 3
              responder_key_distribution= 3

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Pairing_Response
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0x87cb02
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = 'EX#C\\x84\x0fct\\xdf\\xec:S\\xa0Qm\\'

TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Confirm
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0x74703b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 3
###[ Pairing Confirm ]### 
              confirm   = '\x1a!\\xc1\x01\\xa5"\\xa0\\xddWV}\ti\\x93|8'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Confirm|SM_Hdr
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0xff0fb5
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = ''

mrnd 2db605715643ed3f2685f08a250796af
TX ---> BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
RX <--- BTLE / BTLE_DATA / L2CAP_Hdr / SM_Hdr / SM_Random
srnd 2a6cdda915b6ee54bb3b55cade9d2ae1
calculate_STK
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0xb889b
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = start
     len       = 21
###[ L2CAP header ]### 
        len       = 17
        cid       = 6
###[ SM header ]### 
           sm_command= 4
###[ Pairing Random ]### 
              random    = '*lݩ\x15\\xb6\\xeeT\\xbb;U\\xcaޝ*\\xe1'

RX <--- BTLE|BTLE_DATA|L2CAP_Hdr|SM_Hdr|SM_Random
-----------------Pre End-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0xf33307
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_REQ / Raw / LL_START_ENC_REQ
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0x6a7939
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 1
     SN        = 1
     NESN      = 0
     LLID      = control
     len       = 7
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_REQ
###[ LL_START_ENC_REQ ]### 
###[ Raw ]### 
              load      = '\\xa2\\xe4\\xbc)\\xf8f'
###[ LL_START_ENC_REQ ]### 

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_START_ENC_REQ|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0xea8c87
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4633ac0f8052561b
           ivs       = 0xd58351d1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt afa5
dec_pkt 7add
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 840b
dec_pkt fc0f
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_REQ
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0xae3f22
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 23
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_REQ
###[ LL_ENC_REQ ]### 
           rand      = 0x86e99ff0de5f5b33
           ediv      = 0xc0ba
           skdm      = 0x39524aa427ba3ad1
           ivm       = 0xdd17097f

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f98e
dec_pkt 4872
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_START_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0xb3ee05
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 1
###[ BTLE_CTRL ]### 
        opcode    = LL_START_ENC_RSP
###[ LL_START_ENC_RSP ]### 

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt 69cd
dec_pkt 09d2
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0xea8c87
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4633ac0f8052561b
           ivs       = 0xd58351d1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / Raw
iv 0000000000000000
raw_pkt f08a
dec_pkt 32c7
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|Raw
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_ENC_RSP
###[ BT4LE ]### 
  access_addr= 0xc3eb6713
  crc       = 0xea8c87
###[ BTLE data header ]### 
     RFU       = 0
     MD        = 0
     SN        = 0
     NESN      = 0
     LLID      = control
     len       = 13
###[ BTLE_CTRL ]### 
        opcode    = LL_ENC_RSP
###[ LL_ENC_RSP ]### 
           skds      = 0x4633ac0f8052561b
           ivs       = 0xd58351d1

TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_MIN_USED_CHANNELS_IND / Raw
RX <--- BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND / Raw
iv 0000000000000000
raw_pkt 02f5
dec_pkt e696
MIC Wrong
--------decrypted packet---------
###[ BT4LE ]### 
  access_addr= 0x8e89bed6
  crc       = 0xaaaaaa

RX <--- BTLE|BTLE_CTRL|BTLE_DATA|LL_TERMINATE_IND|Raw
-----------------Post Start-----------------
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
-----------------Post End-----------------
-----------------Pre Start-----------------
Master Address:  09:9c:07:6f:49:47
Advertiser Address:  00:E0:12:34:56:78
BTLE_ADV_IND          PDU_type=0  
BTLE_ADV_DIRECT_IND   PDU_type=1  
BTLE_ADV_NONCONN_IND  PDU_type=2  
BTLE_SCAN_REQ         PDU_type=3  
BTLE_SCAN_RSP         PDU_type=4  
BTLE_CONNECT_REQ      PDU_type=5  
BTLE_ADV_SCAN_IND     PDU_type=6  
LL_CONNECTION_UPDATE_IND  opcode=0    
LL_CHANNEL_MAP_IND    opcode=1    
LL_TERMINATE_IND      opcode=2    
LL_ENC_REQ            opcode=3    
LL_ENC_RSP            opcode=4    
LL_START_ENC_REQ      opcode=5    
LL_START_ENC_RSP      opcode=6    
LL_UNKNOWN_RSP        opcode=7    
LL_FEATURE_REQ        opcode=8    
LL_FEATURE_RSP        opcode=9    
LL_PAUSE_ENC_REQ      opcode=10   
LL_PAUSE_ENC_RSP      opcode=11   
LL_VERSION_IND        opcode=12   
LL_REJECT_IND         opcode=13   
LL_SLAVE_FEATURE_REQ  opcode=14   
LL_CONNECTION_PARAM_REQ  opcode=15   
LL_CONNECTION_PARAM_RSP  opcode=16   
LL_REJECT_EXT_IND     opcode=17   
LL_PING_REQ           opcode=18   
LL_PING_RSP           opcode=19   
LL_LENGTH_REQ         opcode=20   
LL_LENGTH_RSP         opcode=21   
LL_PHY_REQ            opcode=22   
LL_PHY_RSP            opcode=23   
LL_PHY_UPDATE_IND     opcode=24   
LL_MIN_USED_CHANNELS_IND  opcode=25   
LL_20                 opcode=32   
ATT_Error_Response    opcode=1    
ATT_Exchange_MTU_Request  opcode=2    
ATT_Exchange_MTU_Response  opcode=3    
ATT_Find_Information_Request  opcode=4    
ATT_Find_Information_Response  opcode=5    
ATT_Find_By_Type_Value_Request  opcode=6    
ATT_Find_By_Type_Value_Response  opcode=7    
ATT_Read_By_Type_Request_128bit  opcode=8    
ATT_Read_By_Type_Request  opcode=8    
ATT_Read_By_Type_Response  opcode=9    
ATT_Read_Request      opcode=10   
ATT_Read_Response     opcode=11   
ATT_Read_Blob_Request  opcode=12   
ATT_Read_Blob_Response  opcode=13   
ATT_Read_Multiple_Request  opcode=14   
ATT_Read_Multiple_Response  opcode=15   
ATT_Read_By_Group_Type_Request  opcode=16   
ATT_Read_By_Group_Type_Response  opcode=17   
ATT_Write_Request     opcode=18   
ATT_Write_Response    opcode=19   
ATT_Prepare_Write_Request  opcode=22   
ATT_Prepare_Write_Response  opcode=23   
ATT_Execute_Write_Request  opcode=24   
ATT_Execute_Write_Response  opcode=25   
ATT_Read_Multiple_Variable_Request  opcode=32   
ATT_Read_Multiple_Variable_Response  opcode=33   
ATT_Write_Command     opcode=82   
ATT_Handle_Value_Notification  opcode=27   
ATT_Handle_Value_Indication  opcode=29   
ATT_Handle_Value_Confirmation  opcode=30   
ATT_Multiple_Handle_Value_Notification  opcode=35   
ATT_Signed_Write_Command  opcode=210  
L2CAP_CmdRej          code=1      
L2CAP_ConnReq         code=2      
L2CAP_ConnResp        code=3      
L2CAP_ConfReq         code=4      
L2CAP_ConfResp        code=5      
L2CAP_DisconnReq      code=6      
L2CAP_DisconnResp     code=7      
L2CAP_EchoReq         code=8      
L2CAP_EchoResp        code=9      
L2CAP_InfoReq         code=10     
L2CAP_InfoResp        code=11     
L2CAP_Create_Channel_Request  code=12     
L2CAP_Create_Channel_Response  code=13     
L2CAP_Move_Channel_Request  code=14     
L2CAP_Move_Channel_Response  code=15     
L2CAP_Move_Channel_Confirmation_Request  code=16     
L2CAP_Move_Channel_Confirmation_Response  code=17     
L2CAP_Connection_Parameter_Update_Request  code=18     
L2CAP_Connection_Parameter_Update_Response  code=19     
L2CAP_LE_Credit_Based_Connection_Request  code=20     
L2CAP_LE_Credit_Based_Connection_Response  code=21     
L2CAP_LE_Flow_Control_Credit_IND  code=22     
L2CAP_Credit_Based_Connection_Request  code=23     
L2CAP_Credit_Based_Connection_Response  code=24     
L2CAP_Credit_Based_Reconfigure_Request  code=25     
L2CAP_Credit_Based_Reconfigure_Response  code=26     
SM_Pairing_Request    sm_command=1
SM_Pairing_Response   sm_command=2
SM_Confirm            sm_command=3
SM_Random             sm_command=4
SM_Failed             sm_command=5
SM_Encryption_Information  sm_command=6
SM_Master_Identification  sm_command=7
SM_Identity_Information  sm_command=8
SM_Identity_Address_Information  sm_command=9
SM_Signing_Information  sm_command=10
SM_Security_Request   sm_command=11
SM_Public_Key         sm_command=12
SM_DHKey_Check        sm_command=13
SM_Keypress_Notification  sm_command=14
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
Error: The device is not ready. Please reset the device
NRF52 Dongle closed
Dongle connection reset complete
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
Error: The device is not ready. Please reset the device
NRF52 Dongle closed
Dongle connection reset complete
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
Error: The device is not ready. Please reset the device
NRF52 Dongle closed
Dongle connection reset complete
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
TX ---> BTLE / BTLE_DATA / BTLE_CTRL / LL_TERMINATE_IND
TX ---> BTLE / BTLE_ADV / BTLE_SCAN_REQ
RX <--- BTLE / BTLE_ADV / BTLE_SCAN_RSP
TX ---> BTLE / BTLE_ADV / BTLE_CONNECT_REQ
Error: The device is not ready. Please reset the device
NRF52 Dongle closed
Dongle connection reset complete
Traceback (most recent call last):
  File "/home/yangting/Documents/Ble_Test/srcs/ble_learning.py", line 99, in <module>
    learned_model = run_KV(alphabet, ble_sul, eq_oracle, automaton_type='mealy', logger_handle=logger_handle, max_learning_rounds=500,cache_and_non_det_check=False,print_level=3)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yangting/Documents/Ble_Test/libs/aalpy/learning_algs/deterministic/KV.py", line 132, in run_KV
    hypothesis = classification_tree.update_hypothesis()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yangting/Documents/Ble_Test/libs/aalpy/learning_algs/deterministic/ClassificationTree.py", line 206, in update_hypothesis
    state.output_fun[input_element] = self.sul.query(state.prefix + (input_element,))[-1]
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yangting/Documents/Ble_Test/../Ble_Test/srcs/State_Machine/Bluetooth_SUL.py", line 441, in query
    self.pre()
  File "/home/yangting/Documents/Ble_Test/../Ble_Test/srcs/State_Machine/Bluetooth_SUL.py", line 314, in pre
    raise ConnectionError()
Fail_Exception.Fail_Exception.ConnectionError
